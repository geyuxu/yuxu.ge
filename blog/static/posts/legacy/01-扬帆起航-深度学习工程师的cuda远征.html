<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¬å¸†èµ·èˆªï¼šæ·±åº¦å­¦ä¹ å·¥ç¨‹å¸ˆçš„cudaè¿œå¾ | Yuxu Ge</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        :root {
            --black: #111;
            --dark-grey: #444;
            --off-white: #f4f4f4;
            --vermilion: #C41E3A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--black);
            background-color: var(--off-white);
        }

        a {
            color: var(--vermilion);
            text-decoration: none;
        }

        a:hover {
            opacity: 0.75;
        }

        .layout {
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 320px;
            height: 100vh;
            background: var(--black);
            color: var(--off-white);
            padding: 3rem 2rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .sidebar-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .avatar {
            display: block;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid var(--vermilion);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .avatar:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .name-block {
            margin-bottom: 0.5rem;
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--off-white);
        }

        .title-role {
            font-size: 0.9rem;
            color: #888;
            margin-top: 0.25rem;
            font-weight: 400;
        }

        .contact-block {
            margin-top: 2.5rem;
            width: 100%;
        }

        .social-links {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .social-links a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 160px;
            color: var(--off-white);
            opacity: 0.7;
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .social-links a:hover {
            color: var(--vermilion);
            opacity: 1;
            background: rgba(255, 255, 255, 0.05);
        }

        .social-links svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .social-links .orcid-link {
            font-size: 0.68rem;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .sidebar-footer {
            text-align: center;
            font-size: 0.75rem;
            color: #555;
        }

        /* Content */
        .content {
            margin-left: 320px;
            padding: 3rem 4rem;
            max-width: calc(100vw - 320px - 8rem);
        }

        .back-link {
            display: inline-block;
            font-size: 0.85rem;
            margin-bottom: 2rem;
            color: var(--dark-grey);
        }

        .back-link:hover {
            color: var(--vermilion);
        }

        /* Article */
        article h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.3;
            color: var(--black);
        }

        article h2 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--black);
        }

        article h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 1.5rem 0 0.75rem;
            color: var(--black);
        }

        article p {
            margin-bottom: 1rem;
            color: var(--dark-grey);
        }

        article ul,
        article ol {
            margin: 1rem 0 1rem 1.5rem;
            color: var(--dark-grey);
        }

        article li {
            margin-bottom: 0.5rem;
        }

        article strong {
            color: var(--black);
        }

        article code {
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
            background: #e8e8e8;
            padding: 0.15em 0.4em;
            border-radius: 3px;
        }

        article pre {
            margin: 1rem 0;
            border-radius: 6px;
            overflow-x: auto;
            background: #2d2d2d;
            padding: 1rem;
        }

        article pre code {
            background: none;
            padding: 0;
            font-size: 0.75em;
            white-space: pre !important;
            counter-reset: line;
            display: block;
            color: #ccc;
        }

        article pre code .line {
            counter-increment: line;
        }

        article pre code .line::before {
            content: counter(line);
            display: inline-block;
            width: 2.5em;
            margin-right: 1em;
            text-align: right;
            color: #666;
            user-select: none;
        }

        .code-toolbar {
            display: flex;
            justify-content: flex-start;
            padding: 0.35rem 0.5rem;
            background: #3a3a3a;
            border-radius: 6px 6px 0 0;
        }

        .code-toolbar+pre {
            margin-top: 0;
            border-radius: 0 0 6px 6px;
        }

        .copy-btn {
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
            background: #555;
            color: #fff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-btn:hover,
        .copy-btn:active {
            background: #777;
        }

        .copy-btn.copied {
            background: #2a2;
        }

        article blockquote {
            border-left: 3px solid var(--vermilion);
            padding-left: 1rem;
            margin: 1rem 0;
            color: #666;
            font-style: italic;
        }

        article hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 2rem 0;
        }

        article table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        article th,
        article td {
            border: 1px solid #ddd;
            padding: 0.5rem 0.75rem;
            text-align: left;
        }

        article th {
            background: #e8e8e8;
            font-weight: 600;
        }

        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem 0;
            border-radius: 6px;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: #888;
        }

        .error {
            color: var(--vermilion);
        }

        /* Language Selector */
        .lang-selector {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 0.75rem 1rem;
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .lang-selector-label {
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .lang-selector-label svg {
            width: 16px;
            height: 16px;
        }

        .lang-select {
            padding: 0.4rem 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            min-width: 140px;
        }

        .lang-select:focus {
            outline: none;
            border-color: var(--vermilion);
        }

        .lang-status {
            font-size: 0.8rem;
            color: #888;
            margin-left: auto;
        }

        .lang-status.translating {
            color: var(--vermilion);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .lang-status.translating::before {
            content: '';
            width: 14px;
            height: 14px;
            border: 2px solid #f0f0f0;
            border-top-color: var(--vermilion);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .lang-status.cached {
            color: #4CAF50;
        }

        .lang-original-btn {
            padding: 0.35rem 0.6rem;
            font-size: 0.75rem;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            color: #666;
            transition: all 0.2s;
        }

        .lang-original-btn:hover {
            background: #e0e0e0;
            color: #333;
        }

        @media (max-width: 600px) {
            .lang-selector {
                flex-wrap: wrap;
            }
            .lang-status {
                width: 100%;
                margin-left: 0;
                margin-top: 0.5rem;
            }
        }

        /* KaTeX math styles */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0;
        }

        .katex {
            font-size: 1.1em;
        }

        /* Jupyter Notebook Styles */
        .notebook-container {
            margin-top: 1rem;
        }

        .notebook-download {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 1.5rem;
            background: var(--black);
            color: var(--off-white);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .notebook-download:hover {
            opacity: 0.8;
            color: var(--off-white);
        }

        .notebook-download svg {
            width: 16px;
            height: 16px;
        }

        .nb-cell {
            margin-bottom: 1.5rem;
        }

        .nb-cell-code .nb-source {
            background: #2d2d2d;
            border-radius: 6px;
            overflow-x: auto;
        }

        .nb-cell-code .nb-source pre {
            margin: 0;
            padding: 1rem;
            color: #ccc;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.85em;
        }

        .nb-cell-code .nb-source code {
            background: none;
            padding: 0;
        }

        .nb-output {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
        }

        .nb-output pre {
            margin: 0;
            padding: 0;
            background: transparent;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.85em;
            color: #222;
        }

        .nb-output img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0.5rem 0;
        }

        .nb-output table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .nb-output th,
        .nb-output td {
            border: 1px solid #ddd;
            padding: 0.5rem;
            text-align: left;
        }

        .nb-output th {
            background: #e8e8e8;
            font-weight: 600;
        }

        .nb-cell-markdown {
            padding: 0;
        }

        .nb-cell-markdown h1:first-child {
            margin-top: 0;
        }

        /* Document Download Button */
        .doc-download {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 1.5rem;
            background: var(--black);
            color: var(--off-white);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .doc-download:hover {
            opacity: 0.8;
            color: var(--off-white);
        }

        .doc-download svg {
            width: 16px;
            height: 16px;
        }

        /* PDF Viewer */
        .pdf-container {
            margin-top: 1rem;
        }

        .pdf-viewer {
            width: 100%;
            height: 80vh;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f5f5f5;
        }

        /* Text File Display */
        .text-container {
            margin-top: 1rem;
        }

        .text-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 1.5rem;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--dark-grey);
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Word Document Display */
        .word-container {
            margin-top: 1rem;
        }

        .word-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 2rem;
            line-height: 1.8;
            color: var(--dark-grey);
        }

        .word-content p {
            margin-bottom: 1rem;
        }

        .word-content h1,
        .word-content h2,
        .word-content h3 {
            color: var(--black);
            margin: 1.5rem 0 1rem;
        }

        .word-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .word-content th,
        .word-content td {
            border: 1px solid #ddd;
            padding: 0.5rem;
        }

        .word-content img {
            max-width: 100%;
            height: auto;
        }

        /* Excel Display */
        .excel-container {
            margin-top: 1rem;
        }

        .excel-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .excel-tab {
            padding: 0.5rem 1rem;
            background: #e8e8e8;
            border: none;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .excel-tab.active {
            background: #4CAF50;
            color: white;
        }

        .excel-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow-x: auto;
            max-height: 70vh;
            overflow-y: auto;
        }

        .excel-content table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .excel-content th,
        .excel-content td {
            border: 1px solid #ddd;
            padding: 0.4rem 0.6rem;
            text-align: left;
            white-space: nowrap;
        }

        .excel-content th {
            background: #f5f5f5;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .excel-content tr:nth-child(even) {
            background: #fafafa;
        }

        /* PowerPoint Display */
        .ppt-container {
            margin-top: 1rem;
        }

        .ppt-viewer {
            width: 100%;
            height: 80vh;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f5f5f5;
        }

        /* CSV Display (uses excel styles) */
        .csv-container {
            margin-top: 1rem;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                padding: 2rem 1.5rem 1rem;
            }

            .social-links {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }

            .social-links a,
            .social-links .orcid-link {
                width: auto;
                padding: 0.5rem;
                font-size: 0;
                gap: 0;
            }

            .social-links svg {
                width: 24px;
                height: 24px;
            }

            .social-links .hide-mobile {
                display: none;
            }

            .sidebar-footer {
                margin-top: 1rem;
            }

            .content {
                margin-left: 0;
                padding: 2rem 1rem;
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                padding: 1.5rem 1rem 1rem;
            }

            .avatar {
                width: 80px;
                height: 80px;
            }

            h1 {
                font-size: 1.4rem;
            }

            article h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>

    <div class="layout">
        <aside class="sidebar" id="sidebar-content"></aside>
        <script src="/components/sidebar.js?v=20260128"></script>

        <main class="content">
            <a href="/blog/" class="back-link">â† Back to Blog</a>

            <!-- Language Selector -->
            <div class="lang-selector" id="lang-selector" style="display: none;">
                <span class="lang-selector-label">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
                    </svg>
                    Language
                </span>
                <select class="lang-select" id="lang-select">
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                    <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                    <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃªs</option>
                    <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                    <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                </select>
                <button class="lang-original-btn" id="lang-original-btn" style="display: none;">Show Original</button>
                <span class="lang-status" id="lang-status"></span>
            </div>

            <article>
<hr>
<h2>date: 2025-05-07
tags: [ai]
legacy: true</h2>
<h1>æ‰¬å¸†èµ·èˆªï¼šæ·±åº¦å­¦ä¹ å·¥ç¨‹å¸ˆçš„cudaè¿œå¾</h1>
<ul>
<li><strong>C/C++ ç¼–ç¨‹åŸºç¡€ï¼š</strong> CUDAä»¥ C/C++ è¯­è¨€ä¸ºåŸºç¡€è¿›è¡Œæ‰©å±•ï¼Œå› æ­¤éœ€è¦ç†Ÿç»ƒæŒæ¡C/C++è¯­æ³•å’Œç¼–ç¨‹ã€‚åŒ…æ‹¬æŒ‡é’ˆå’Œå†…å­˜ç®¡ç†ç­‰çŸ¥è¯†ï¼Œä»¥ä¾¿ç†è§£CUDAä¸­çš„å†…å­˜æ“ä½œå’Œæ•°æ®ä¼ é€’ã€‚</li>
<li><strong>å¹¶è¡Œè®¡ç®—æ¦‚å¿µï¼š</strong> äº†è§£åŸºæœ¬çš„å¹¶è¡Œç¼–ç¨‹æ¨¡å‹å’Œå¤šçº¿ç¨‹æ¦‚å¿µï¼Œç†è§£ä¸²è¡Œ vs. å¹¶è¡Œæ‰§è¡Œçš„å·®å¼‚ã€‚è¿™æœ‰åŠ©äºç†è§£å¦‚ä½•å°†è®¡ç®—æ‹†åˆ†ç»™æˆåƒä¸Šä¸‡çš„GPUçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚</li>
<li><strong>è®¡ç®—æœºä½“ç³»ç»“æ„åŸºç¡€ï¼š</strong> å…·å¤‡è®¡ç®—æœºç¡¬ä»¶æ¶æ„å¸¸è¯†ï¼Œå°¤å…¶æ˜¯GPUæ¶æ„ã€‚äº†è§£CPUä¸GPUåœ¨æ ¸å¿ƒæ•°é‡ã€å†…å­˜å±‚æ¬¡ç­‰æ–¹é¢çš„å·®å¼‚ï¼Œä»¥åŠGPUçš„æµå¤„ç†å™¨(SM)ç»“æ„ç­‰ã€‚è¿™äº›çŸ¥è¯†æœ‰åŠ©äºæ—¥åè¿›è¡ŒCUDAç¨‹åºä¼˜åŒ–ï¼ˆä¾‹å¦‚è€ƒè™‘å¯„å­˜å™¨æ•°é‡ã€å†…å­˜å»¶è¿Ÿç­‰ï¼‰ã€‚</li>
<li><strong>æ•°å­¦åŸºç¡€ï¼š</strong> ç†Ÿæ‚‰çº¿æ€§ä»£æ•°ï¼ˆçŸ©é˜µã€å‘é‡è¿ç®—ï¼‰å’Œå¾®ç§¯åˆ†çš„åŸºæœ¬æ¦‚å¿µã€‚å¾ˆå¤šGPUåŠ é€Ÿçš„ç®—æ³•æœ¬è´¨ä¸Šæ˜¯çŸ©é˜µè¿ç®—å’Œå¾®åˆ†è®¡ç®—ï¼Œæ‰å®çš„æ•°å­¦åŸºç¡€æœ‰åŠ©äºç†è§£æ·±åº¦å­¦ä¹ ä¸­çš„CUDAå®ç°åŸç†ã€‚</li>
<li><strong>GPUåŸºç¡€è®¤çŸ¥ï¼š äº†è§£ä¸€äº›GPUç›¸å…³çš„åŸºç¡€ï¼Œä¾‹å¦‚GPUä¸Šçš„æ˜¾å­˜</strong>  (Device Memory)ä¸ä¸»æœºå†…å­˜(Host Memory)åŒºåˆ«ï¼Œæ•°æ®åœ¨äºŒè€…é—´çš„ä¼ è¾“æœºåˆ¶ï¼Œä»¥åŠGPUè®¡ç®—èƒ½åŠ›ï¼ˆCompute Capabilityï¼‰ç­‰ã€‚å¯¹GPUç¡¬ä»¶å·¥ä½œåŸç†çš„åŸºæœ¬è®¤è¯†å¯ä»¥å¸®åŠ©æ›´å¿«æŒæ¡CUDAç¼–ç¨‹ã€‚</li>
</ul>
<p>å‡†å¤‡å¥½ä¸Šè¿°çŸ¥è¯†åï¼Œå°±å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„å­¦ä¹ è·¯çº¿ï¼Œä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œé€æ­¥æ·±å…¥å­¦ä¹ CUDAç¼–ç¨‹ã€‚</p>
<h2>å­¦ä¹ é˜¶æ®µåˆ’åˆ†</h2>
<p>å­¦ä¹ CUDAå¯åˆ†ä¸ºåŸºç¡€ã€è¿›é˜¶å’Œæ·±åº¦å­¦ä¹ ç›¸å…³ä¸‰ä¸ªé˜¶æ®µã€‚åŸºç¡€é˜¶æ®µæ³¨é‡CUDAæ ¸å¿ƒç¼–ç¨‹æ¨¡å‹çš„ç†è§£ï¼Œè¿›é˜¶é˜¶æ®µå…³æ³¨æ€§èƒ½ä¼˜åŒ–å’Œå¹¶å‘æŠ€å·§ï¼Œæœ€åç»“åˆæ·±åº¦å­¦ä¹ åœºæ™¯å­¦ä¹ GPUåŠ é€Ÿçš„ç‰¹æ®ŠæŠ€å·§å’Œåº“çš„ä½¿ç”¨ã€‚</p>
<h3>åŸºç¡€é˜¶æ®µ</h3>
<p>åŸºç¡€é˜¶æ®µçš„ç›®æ ‡æ˜¯æŒæ¡CUDAå¹¶è¡Œç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µå’ŒåŸºæœ¬ç”¨æ³•ï¼ŒåŒ…æ‹¬çº¿ç¨‹ç»„ç»‡æ¨¡å‹ã€å†…å­˜æ¨¡å‹ä»¥åŠæ ¸å‡½æ•°çš„ç¼–å†™å’Œæ‰§è¡Œæµç¨‹ç­‰ã€‚</p>
<ul>
<li><strong>çº¿ç¨‹ã€çº¿ç¨‹å—ã€ç½‘æ ¼æ¨¡å‹ï¼šCUDAé‡‡ç”¨å±‚æ¬¡åŒ–çš„å¹¶è¡Œæ¨¡å‹ã€‚æœ€åŸºæœ¬çš„æ‰§è¡Œå•å…ƒæ˜¯çº¿ç¨‹ (Thread)</strong> ï¼Œè®¸å¤šçº¿ç¨‹ç»„æˆ <strong>çº¿ç¨‹å— (Block)</strong> ï¼Œå¤šä¸ªçº¿ç¨‹å—ç»„æˆ <strong>ç½‘æ ¼ (Grid)</strong> ã€‚</li>
</ul>
<p><img src="/blog/images/legacy/image-20250508141207388.png" alt=""></p>
<p>è¿™ç§ç»„ç»‡æ–¹å¼è®©GPUå¯ä»¥ç®¡ç†æˆåƒä¸Šä¸‡çš„çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚æ¯ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œæ—¶å¯ä»¥é€šè¿‡å†…ç½®å˜é‡ï¼ˆå¦‚<code>threadIdx</code>, <code>blockIdx</code>, <code>blockDim</code>, <code>gridDim</code>ï¼‰è·å–è‡ªå·±åœ¨ç½‘æ ¼ä¸­çš„ç´¢å¼•ï¼Œä»è€Œå¤„ç†æ•°æ®ä¸­çš„ä¸åŒç‰‡æ®µã€‚çº¿ç¨‹å—å†…çš„çº¿ç¨‹å¯ä»¥å…±äº«æ•°æ®å¹¶è¿›è¡ŒåŒæ­¥ï¼Œè€Œä¸åŒå—ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œè¿™æ ·çš„è®¾è®¡åˆ©äºå¤§è§„æ¨¡å¹¶è¡Œå’Œå¯æ‰©å±•æ€§ã€‚</p>
<blockquote><code>#include&lt;stdio.h&gt;</code><br>
<code>__global__ void cuda_hello(){</code><br>
<code>    printf(&quot;Hello world from GPU\tthreadIdx(x:%u,y:%u,z:%u)\tblockIdx(x:%u,y:%u,z:%u)\tblockDim(x:%u,y:%u,z:%u)\tgridDim(x:%u,y:%u,z:%u)\n&quot;</code><br>
<code>        ,threadIdx.x,threadIdx.y,threadIdx.z</code><br>
<code>        ,blockIdx.x,blockIdx.y,blockIdx.z</code><br>
<code>        ,blockIdx.x,blockIdx.y,blockIdx.z</code><br>
<code>        ,gridDim.x,gridDim.y,gridDim.z);</code><br>
<code>}</code><br>
<code></code><br>
<code>int main(){</code><br>
<code>    cuda_hello&lt;&lt;&lt;2,2&gt;&gt;&gt;();</code><br>
<code>    cudaDeviceSynchronize();</code><br>
<code>    return 0;</code><br>
<code>}</code></blockquote><p><em>Output:</em></p>
<blockquote><code>Hello world from GPU    threadIdx(x:0,y:0,z:0)  blockIdx(x:0,y:0,z:0)   blockDim(x:0,y:0,z:0)   gridDim(x:2,y:1,z:1)</code><br>
<code>Hello world from GPU    threadIdx(x:1,y:0,z:0)  blockIdx(x:0,y:0,z:0)   blockDim(x:0,y:0,z:0)   gridDim(x:2,y:1,z:1)      </code><br>
<code>Hello world from GPU    threadIdx(x:0,y:0,z:0)  blockIdx(x:1,y:0,z:0)   blockDim(x:1,y:0,z:0)   gridDim(x:2,y:1,z:1)      </code><br>
<code>Hello world from GPU    threadIdx(x:1,y:0,z:0)  blockIdx(x:1,y:0,z:0)   blockDim(x:1,y:0,z:0)   gridDim(x:2,y:1,z:1) </code></blockquote><ul>
<li><strong>CUDA å†…å­˜ç±»å‹ä¸å±‚æ¬¡ç»“æ„ï¼šCUDAè®¾å¤‡ä¸Šå­˜åœ¨å¤šå±‚æ¬¡å†…å­˜ï¼ŒåŒ…æ‹¬å…¨å±€å†…å­˜ (Global Memory)</strong> ã€<strong>å…±äº«å†…å­˜ (Shared Memory)</strong> ã€ <strong>å±€éƒ¨å†…å­˜ (Local Memory)</strong> å’Œ <strong>å¯„å­˜å™¨ (Register)</strong> ç­‰ã€‚å®ƒä»¬åœ¨å®¹é‡å’Œé€Ÿåº¦ä¸Šæ­¤æ¶ˆå½¼é•¿â€”â€”å†…å­˜å®¹é‡è¶Šå¤§åˆ™å»¶è¿Ÿè¶Šé«˜ï¼Œå¯„å­˜å™¨æœ€å¿«ä½†æ•°é‡æœ€å°‘ï¼Œå…±äº«å†…å­˜æ¬¡ä¹‹ï¼Œå…¨å±€å†…å­˜æœ€å¤§ä½†æœ€æ…¢ã€‚å¼€å‘è€…éœ€è¦äº†è§£å„ç±»å†…å­˜çš„ä½œç”¨åŸŸå’Œç‰¹æ€§ï¼šå…¨å±€å†…å­˜å¯è¢«æ‰€æœ‰çº¿ç¨‹è®¿é—®ï¼ˆGPUä¸Šçš„æ˜¾å­˜ï¼Œéœ€é€šè¿‡PCIeä»ä¸»æœºæ‹·è´æ•°æ®è¿‡æ¥ï¼‰ï¼›å…±äº«å†…å­˜æ˜¯æ¯ä¸ªçº¿ç¨‹å—å†…å…±äº«çš„é«˜é€Ÿç¼“å­˜ï¼Œå¯ç”¨æ¥æé«˜å—å†…æ•°æ®é‡ç”¨å’Œå‡å°‘å¯¹å…¨å±€å†…å­˜çš„è®¿é—®ï¼›å±€éƒ¨å†…å­˜æ˜¯çº¿ç¨‹ç§æœ‰çš„å†…å­˜ï¼ˆå½“å¯„å­˜å™¨ä¸å¤Ÿç”¨æ—¶æº¢å‡ºåˆ°æ˜¾å­˜çš„ç©ºé—´ï¼‰ï¼›å¯„å­˜å™¨åˆ™ç”±å•ä¸ªçº¿ç¨‹ç‹¬å ï¼Œé€Ÿåº¦æœ€å¿«ä½†æ•°é‡æœ‰é™ã€‚ç†è§£å¹¶åˆç†åˆ©ç”¨è¿™äº›å­˜å‚¨å¯¹äºç¼–å†™é«˜æ€§èƒ½CUDAä»£ç è‡³å…³é‡è¦â€”â€”æ¯”å¦‚å°†é‡å¤ä½¿ç”¨çš„æ•°æ®æ”¾å…¥å…±äº«å†…å­˜ä»¥å‡å°‘å…¨å±€å†…å­˜è®¿é—®æ¬¡æ•°ç­‰ã€‚</li>
<li><strong>CUDA æ ¸å‡½æ•°ç¼–å†™ä¸è°ƒç”¨ï¼šCUDAç¨‹åºç”±åœ¨CPUä¸Šè¿è¡Œçš„ä¸»æœºä»£ç å’Œåœ¨GPUä¸Šå¹¶è¡Œè¿è¡Œçš„è®¾å¤‡ä»£ç ä¸¤éƒ¨åˆ†ç»„æˆã€‚è®¾å¤‡ä¸Šçš„å¹¶è¡Œä»£ç è¢«ç§°ä¸ºæ ¸å‡½æ•° (Kernel)</strong> ã€‚ç¼–å†™æ ¸å‡½æ•°æ—¶éœ€è¦ä½¿ç”¨<code>__global__</code>ä¿®é¥°ï¼Œè¡¨ç¤ºè¿™æ˜¯GPUä¸Šæ‰§è¡Œçš„å‡½æ•°ã€‚ä¸»æœºä»£ç é€šè¿‡ç‰¹æ®Šçš„è¯­æ³•è°ƒç”¨æ ¸å‡½æ•°ï¼Œä¾‹å¦‚ï¼š<code>kernel&lt;&lt;&lt;gridDim, blockDim&gt;&gt;&gt;(args...);</code>ï¼Œå…¶ä¸­<code>gridDim</code>å’Œ<code>blockDim</code>æŒ‡å®šå¯åŠ¨å¤šå°‘çº¿ç¨‹å—ä»¥åŠæ¯ä¸ªå—ä¸­å¤šå°‘çº¿ç¨‹ã€‚CUDAè¿è¡Œæ—¶ä¼šå°†æŒ‡å®šæ•°é‡çš„çº¿ç¨‹å—éƒ¨ç½²åˆ°GPUçš„æµå¼å¤šå¤„ç†å™¨(SM)ä¸Šæ‰§è¡Œã€‚æ ¸å‡½æ•°å†…éƒ¨é€šè¿‡å‰è¿°çš„ç´¢å¼•å˜é‡æ¥è®©æ¯ä¸ªçº¿ç¨‹å¤„ç†ä¸åŒçš„æ•°æ®å…ƒç´ ã€‚æ­¤å¤–ï¼Œåœ¨æ ¸å‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨è¯¸å¦‚<code>__syncthreads()</code>çš„åŒæ­¥åŸè¯­ä½¿ä¸€ä¸ªçº¿ç¨‹å—å†…çš„çº¿ç¨‹è¾¾åˆ°åŒæ­¥Barrierï¼Œä»¥ç¡®ä¿å…±äº«å†…å­˜ä¸­æ•°æ®çš„ä¸€è‡´æ€§ã€‚åœ¨åŸºç¡€é˜¶æ®µï¼Œæˆ‘ä»¬ä½œä¸ºåˆå­¦è€…åº”ç»ƒä¹ å¦‚ä½•æ­£ç¡®åˆ†é…GPUå†…å­˜ (<code>cudaMalloc</code>)ã€å°†æ•°æ®ä»ä¸»æœºä¼ è¾“åˆ°è®¾å¤‡ (<code>cudaMemcpy</code>)ï¼Œå¯åŠ¨æ ¸å‡½æ•°è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œç„¶åå°†ç»“æœæ‹·å›ä¸»æœº (<code>cudaMemcpy</code>)å¹¶é‡Šæ”¾å†…å­˜ã€‚è¿™äº›æ­¥éª¤æ„æˆäº†CUDAç¨‹åºçš„åŸºæœ¬æ‰§è¡Œæµç¨‹ã€‚é€šè¿‡å®ç°ç®€å•ç¤ºä¾‹ï¼ˆå¦‚å‘é‡åŠ æ³•ã€çŸ©é˜µç›¸åŠ ç­‰ï¼‰å¯ä»¥ç†Ÿæ‚‰è¿™ä¸€æµç¨‹ï¼Œå¹¶éªŒè¯GPUå¹¶è¡ŒåŠ é€Ÿçš„æ•ˆæœã€‚</li>
</ul>
<h3>è¿›é˜¶é˜¶æ®µ</h3>
<p>è¿›é˜¶é˜¶æ®µä¾§é‡æ·±å…¥CUDAçš„é«˜çº§ç‰¹æ€§å’Œä¼˜åŒ–æŠ€å·§ï¼Œä»¥å……åˆ†å‘æŒ¥GPUæ€§èƒ½ã€‚å­¦å®Œè¿™ä¸€é˜¶æ®µï¼Œæˆ‘ä»¬åº”èƒ½å¤Ÿç¼–å†™æ›´é«˜æ•ˆçš„CUDAä»£ç ï¼Œå¹¶åˆ©ç”¨å¼‚æ­¥å¹¶å‘ç­‰æœºåˆ¶æå‡ç¨‹åºååã€‚</p>
<ul>
<li><strong>å¼‚æ­¥å¹¶å‘ä¸æµ (Stream)ï¼šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒCUDAçš„ä¸»æœºä»£ç ä¸GPUæ‰§è¡Œæ˜¯åŒæ­¥çš„ï¼Œä¸”GPUæŒ‰ç…§æäº¤é¡ºåºä¾æ¬¡æ‰§è¡Œæ ¸å‡½æ•°å’Œæ•°æ®ä¼ è¾“ã€‚è¿™æ„å‘³ç€ä¸»æœºä¼šç­‰å¾…GPUå®Œæˆä»»åŠ¡åå†ç»§ç»­ï¼Œä»¥åŠGPUä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªæ ¸å‡½æ•°ã€‚ä¸ºäº†æ›´å¥½åœ°åˆ©ç”¨GPUè®¡ç®—èµ„æºå’Œéšè—æ•°æ®ä¼ è¾“å»¶è¿Ÿï¼ŒCUDAæä¾›äº†æµ (Stream)</strong> æ¦‚å¿µã€‚æµæ˜¯CUDAä¸­çš„æŒ‡ä»¤æµï¼ŒGPUå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªæµä¸­çš„æ“ä½œï¼Œå®ç°å¹¶å‘æ‰§è¡Œã€‚é»˜è®¤çš„æµï¼ˆ0å·æµï¼‰æ˜¯éšå¼å­˜åœ¨çš„ã€ä¸”æ˜¯é¡ºåºåŒæ­¥çš„ï¼›å¦‚æœåˆ›å»ºæ˜¾å¼æµå¹¶å°†æ ¸å‡½æ•°å’Œå†…å­˜æ‹·è´åˆ†é…åˆ°ä¸åŒæµä¸­ï¼ŒCUDAå°±å¯ä»¥<strong>å¼‚æ­¥</strong>åœ°å¹¶è¡Œæ‰§è¡Œå®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªæµä¸­è®©GPUè®¡ç®—å½“å‰æ‰¹æ¬¡æ•°æ®çš„æ ¸å‡½æ•°ï¼ŒåŒæ—¶åœ¨å¦ä¸€ä¸ªæµä¸­å°†ä¸‹ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®ä»CPUä¼ è¾“åˆ°GPUï¼Œä»è€Œé‡å é€šä¿¡å’Œè®¡ç®—ã€‚è¿™ç§å¼‚æ­¥å¹¶å‘èƒ½å¤Ÿæ˜¾è‘—æé«˜æ•´ä½“ååã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒæµä¹‹é—´é»˜è®¤æ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œå¼€å‘è€…å¯é€šè¿‡<strong>äº‹ä»¶ (Event)</strong> æ¥åè°ƒæµé—´åŒæ­¥ã€‚äº‹ä»¶å¯ä»¥è®°å½•æŸä¸€æµä¸­çš„é˜¶æ®µå®Œæˆæ—¶é—´ï¼Œå¹¶ç”¨äºè®©å¦ä¸€ä¸ªæµç­‰å¾…è¯¥äº‹ä»¶ï¼Œæˆ–æµ‹é‡ä¸¤äº‹ä»¶é—´ç»è¿‡çš„æ—¶é—´ã€‚æŒæ¡æµå’Œäº‹ä»¶åï¼Œå¯è¿›ä¸€æ­¥å­¦ä¹ ä½¿ç”¨<code>cudaMemcpyAsync</code>è¿›è¡Œå¼‚æ­¥æ•°æ®ä¼ è¾“ã€ä»¥åŠåˆ©ç”¨<strong>æµä¼˜å…ˆè®¾å¤‡è®¾ç½®</strong>æé«˜å¹¶å‘åº¦ç­‰é«˜çº§æŠ€å·§ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼šGPUæ€§èƒ½ä¼˜åŒ–æ˜¯CUDAè¿›é˜¶çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚åœ¨ç¼–å†™æ­£ç¡®çš„CUDAä»£ç ä¹‹åï¼Œå¾€å¾€éœ€è¦è€ƒè™‘å†…å­˜è®¿é—®æ¨¡å¼</strong>å’Œ<strong>çº¿ç¨‹è°ƒåº¦æ•ˆç‡</strong>æ¥æå‡æ€§èƒ½ã€‚é¦–å…ˆæ˜¯<strong>åˆå¹¶å†…å­˜è®¿é—® (Memory Coalescing)</strong>ï¼šå½“ä¸€ä¸ªwarpï¼ˆçº¿ç¨‹æŸï¼Œé€šå¸¸ä¸º32ä¸ªå¹¶è¡Œçº¿ç¨‹ï¼‰ä¸­çš„æ‰€æœ‰çº¿ç¨‹è®¿é—®è¿ç»­åœ°å€çš„ä¸€å—å…¨å±€å†…å­˜æ—¶ï¼ŒGPUç¡¬ä»¶ä¼šå°†è¿™äº›è®¿é—®åˆå¹¶ä¸ºå°½å¯èƒ½å°‘çš„å†…å­˜äº‹åŠ¡ï¼Œä»è€Œé«˜æ•ˆåˆ©ç”¨å†…å­˜å¸¦å®½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿ç»­ä¸”å¯¹é½çš„è®¿å­˜å¯è®©ä¸€ä¸ªwarpçš„è®¿é—®åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­å®Œæˆï¼Œå¦åˆ™è‹¥è®¿é—®åˆ†æ•£ä¸è¿ç»­ï¼Œå°±ä¼šåˆ†è£‚æˆå¤šæ¬¡å†…å­˜è®¿é—®ï¼Œæ•ˆç‡é™ä½ã€‚è¿™è¦æ±‚æˆ‘ä»¬åœ¨è®¾è®¡æ•°æ®ç»“æ„å’Œè®¿é—®æ¨¡å¼æ—¶å°½é‡è®©ç›¸é‚»çº¿ç¨‹è®¿é—®ç›¸é‚»æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¤„ç†äºŒç»´æ•°ç»„æ—¶å¯ä»¥æŒ‰è¡Œåˆ’åˆ†ç»™çº¿ç¨‹ï¼Œè¿™æ ·çº¿ç¨‹IDè¿ç»­æ—¶è®¿é—®çš„å†…å­˜åœ°å€ä¹Ÿæ˜¯è¿ç»­çš„ã€‚å…¶æ¬¡æ˜¯<strong>å…±äº«å†…å­˜é“¶è¡Œå†²çª (Bank Conflict)</strong>ï¼šå…±äº«å†…å­˜è¢«åˆ’åˆ†ä¸ºè‹¥å¹²<strong>å†…å­˜é“¶è¡Œ</strong>ä»¥å®ç°å¹¶è¡Œè®¿é—®ã€‚å¦‚æœåŒä¸€æ—¶é—´ä¸€ä¸ªwarpä¸­å¤šä¸ªçº¿ç¨‹è®¿é—®ä½äºåŒä¸€å†…å­˜é“¶è¡Œçš„ä¸åŒåœ°å€ï¼Œå°±ä¼šå‘ç”Ÿé“¶è¡Œå†²çªï¼Œå¯¼è‡´è¿™äº›è®¿é—®è¢«æ‹†åˆ†æˆå¤šæ‰¹æ¬¡ä¸²è¡Œæ‰§è¡Œï¼Œé™ä½ååã€‚ä¸ºé¿å…bankå†²çªï¼Œåº”äº†è§£æ•°æ®åœ¨å…±äº«å†…å­˜ä¸­çš„å¸ƒå±€æ–¹å¼ï¼Œä¾‹å¦‚åœ¨è®¿é—®æ¨¡å¼ä¸å‹å¥½æ—¶é€šè¿‡<strong>å¡«å…… (Padding)</strong> æ•°ç»„å…ƒç´ æ¥æ”¹å˜ä¸åŒçº¿ç¨‹è®¿é—®åœ°å€çš„åˆ†å¸ƒï¼Œä»è€Œå‡å°‘å†²çªã€‚é™¤äº†å†…å­˜ä¼˜åŒ–ï¼ŒCUDAä¼˜åŒ–è¿˜åŒ…æ‹¬å‡å°‘<strong>warpåˆ†æ­§</strong>ï¼ˆç¡®ä¿ä¸€ä¸ªwarpå†…çš„çº¿ç¨‹å°½é‡æ‰§è¡Œç›¸åŒçš„åˆ†æ”¯è·¯å¾„ï¼‰ã€æé«˜<strong>è®¡ç®—/å†…å­˜è®¿é—®æ¯”</strong>ï¼ˆç”¨æ›´å¤šè®¡ç®—æ¢å–æ›´å°‘çš„æ•°æ®è®¿é—®ï¼‰ï¼Œä»¥åŠåˆç†é…ç½®çº¿ç¨‹å—å¤§å°ä»¥æé«˜<strong>ç¡¬ä»¶å ç”¨ç‡ (Occupancy)</strong> ç­‰ç­‰ã€‚è¿›é˜¶é˜¶æ®µè¿˜å¯ä»¥å­¦ä¹ ä½¿ç”¨NVIDIAæä¾›çš„åˆ†æå·¥å…·ï¼ˆå¦‚ <strong>Nsight Compute/Systems</strong> æˆ– <code>nvprof</code> ç­‰ï¼‰æ¥åˆ†æç¨‹åºç“¶é¢ˆï¼Œä»è€ŒæŒ‡å¯¼ä¼˜åŒ–ç­–ç•¥ã€‚</li>
</ul>
<h3>æ·±åº¦å­¦ä¹ ç›¸å…³</h3>
<p>åœ¨æŒæ¡CUDAé€šç”¨ç¼–ç¨‹åï¼Œæœ€åä¸€ä¸ªé˜¶æ®µå…³æ³¨å°†æ‰€å­¦åº”ç”¨äº<strong>æ·±åº¦å­¦ä¹ </strong>é¢†åŸŸçš„ç‰¹æ®ŠæŠ€å·§å’Œåº“ã€‚æ·±åº¦å­¦ä¹ çš„è®­ç»ƒå’Œæ¨ç†æ¶‰åŠå¤§é‡çº¿æ€§ä»£æ•°è¿ç®—ï¼ŒCUDAä¸ºæ­¤æä¾›äº†ä¸“é—¨çš„ä¼˜åŒ–æ‰‹æ®µå’Œåº“æ”¯æŒã€‚</p>
<ul>
<li><strong>GPUä¸Šçš„çŸ©é˜µä¹˜æ³•ä¸åŸºç¡€ç®—å­ï¼šçŸ©é˜µä¹˜æ³•ï¼ˆGEMMï¼ŒGeneral Matrix Multiplyï¼‰æ˜¯æ·±åº¦å­¦ä¹ å’Œç§‘å­¦è®¡ç®—ä¸­æœ€å¸¸è§çš„è®¡ç®—ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ç¥ç»ç½‘ç»œå±‚ï¼ˆå¦‚å…¨è¿æ¥å±‚ã€å·ç§¯å±‚ç»è¿‡å±•å¼€åçš„è®¡ç®—ï¼‰çš„æ ¸å¿ƒã€‚GPUéå¸¸æ“…é•¿æ‰§è¡ŒçŸ©é˜µä¹˜æ³•ç­‰å¯å¹¶è¡ŒåŒ–çš„å¯†é›†è®¡ç®—ï¼Œåœ¨GPUä¸Šæ‰§è¡Œå¤§çŸ©é˜µä¹˜æ³•å¯ä»¥æ˜¾è‘—åŠ é€Ÿè®¡ç®—ï¼Œå› æ­¤è¿™æ˜¯ç†è§£CUDAå¹¶è¡ŒåŠ é€Ÿçš„ç†æƒ³æ¡ˆä¾‹ã€‚å­¦ä¹ è€…å¯å°è¯•ç¼–å†™CUDAæ ¸å‡½æ•°å®ç°çŸ©é˜µç›¸ä¹˜ï¼Œé€šè¿‡ä¼˜åŒ–çº¿ç¨‹å—åˆ’åˆ†å’Œä½¿ç”¨å…±äº«å†…å­˜å®ç°tileä¼˜åŒ–</strong>æ¥æå‡æ€§èƒ½ï¼Œå¹¶ä¸CPUå®ç°æˆ–åº“å®ç°è¿›è¡Œå¯¹æ¯”ã€‚é™¤äº†çŸ©é˜µä¹˜æ³•ï¼Œè¿˜æœ‰è¯¸å¦‚å‘é‡ç‚¹ç§¯ã€çŸ©é˜µè½¬ç½®ã€çŸ©é˜µå½’çº¦ï¼ˆå¦‚æ±‚å’Œã€æœ€å¤§å€¼ï¼‰ç­‰åŸºç¡€ç®—å­ï¼Œåœ¨æ·±åº¦å­¦ä¹ ä¸­ä¹Ÿé¢‘ç¹å‡ºç°ã€‚è¿™äº›ç®—å­éƒ½å¯ä»¥é€šè¿‡CUDAå¹¶è¡Œå®ç°æ¥åŠ é€Ÿã€‚ä¾‹å¦‚ï¼Œå®ç°å¤§å‹å‘é‡ç‚¹ç§¯æ—¶ï¼Œå¯è®©æ¯ä¸ªçº¿ç¨‹å¤„ç†éƒ¨åˆ†ä¹˜åŠ ï¼Œç„¶åä½¿ç”¨å¹¶è¡Œå½’çº¦å¾—åˆ°ç»“æœã€‚</li>
<li><strong>å·ç§¯è¿ç®—ä¸CUDAå®ç°ï¼šå·ç§¯æ˜¯æ·±åº¦å­¦ä¹ ä¸­ç‰¹åˆ«æ˜¯CNNä¸­çš„å…³é”®æ“ä½œã€‚ç›´æ¥å®ç°äºŒç»´å·ç§¯æ¶‰åŠåµŒå¥—å¾ªç¯ï¼Œè®¡ç®—é‡å·¨å¤§ï¼Œé€‚åˆGPUåŠ é€Ÿã€‚CUDAåŠ é€Ÿå·ç§¯æœ‰å¤šç§æ–¹æ³•ï¼Œä¾‹å¦‚åˆ©ç”¨Im2col+GEMM</strong>çš„æ–¹å¼å°†å·ç§¯è½¬åŒ–ä¸ºçŸ©é˜µä¹˜æ³•ï¼Œæˆ–è€…ç›´æ¥ç¼–å†™å·ç§¯æ ¸å‡½æ•°è®©æ¯ä¸ªçº¿ç¨‹è®¡ç®—è¾“å‡ºç‰¹å¾å›¾çš„ä¸€ä¸ªåƒç´ ï¼ˆéœ€è¦åˆç†ä½¿ç”¨å…±äº«å†…å­˜æ¥å¤ç”¨å·ç§¯æ ¸æƒé‡å’Œè¾“å…¥æ•°æ®å—ï¼‰ã€‚ç†è§£å·ç§¯åœ¨GPUä¸Šçš„å®ç°æœ‰åŠ©äºè®¤è¯†æ·±åº¦å­¦ä¹ æ¡†æ¶çš„åº•å±‚åŸç†ã€‚å½“ç„¶ï¼Œè‡ªå·±ä»é›¶å®ç°é«˜æ•ˆå·ç§¯éå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå¥½åœ¨NVIDIAæä¾›äº†ä¸“ä¸šçš„åº“æ¥å®ç°ã€‚</li>
<li><strong>CUDAæ·±åº¦å­¦ä¹ åº“ï¼ˆcuBLAS ä¸ cuDNNï¼‰ï¼šNVIDIAä¸ºåŠ é€Ÿæ·±åº¦å­¦ä¹ æä¾›äº†æˆç†Ÿçš„åº“ã€‚å…¶ä¸­cuBLAS</strong>æ˜¯CUDAçš„åŸºæœ¬çº¿æ€§ä»£æ•°åº“ï¼Œå®ç°äº†åœ¨GPUä¸Šçš„BLASå‡½æ•°æ¥å£ï¼ˆå¦‚çŸ©é˜µä¹˜æ³•ã€å‘é‡è¿ç®—ç­‰ï¼‰ã€‚åˆ©ç”¨cuBLASï¼Œå¼€å‘è€…æ— éœ€æ‰‹å†™çŸ©é˜µè¿ç®—å†…æ ¸ï¼Œå°±èƒ½ç›´æ¥è°ƒç”¨é«˜åº¦ä¼˜åŒ–çš„çŸ©é˜µä¹˜æ³•ç­‰å‡½æ•°ã€‚éœ€è¦æ³¨æ„cuBLASä½¿ç”¨çš„æ˜¯åˆ—ä¸»åºå­˜å‚¨ï¼ˆColumn-majorï¼Œéµå¾ªFortranå’ŒBLASçº¦å®šï¼‰ï¼Œä¸Cè¯­è¨€çš„è¡Œä¸»åºä¸åŒï¼Œè¿™åœ¨è°ƒç”¨æ—¶éœ€è¦æ³¨æ„çŸ©é˜µè½¬ç½®æˆ–å¸ƒå±€å‚æ•°çš„è®¾å®šã€‚<strong>cuDNN</strong>ï¼ˆCUDA Deep Neural Network libraryï¼‰åˆ™æ˜¯NVIDIAæä¾›çš„æ·±åº¦ç¥ç»ç½‘ç»œåŠ é€Ÿåº“ï¼Œæä¾›äº†å·ç§¯ã€æ± åŒ–ã€æ¿€æ´»ã€RNNç­‰æ·±åº¦å­¦ä¹ å¸¸ç”¨æ“ä½œçš„GPUé«˜æ•ˆå®ç°ã€‚æ·±åº¦å­¦ä¹ ç ”ç©¶äººå‘˜å’Œæ¡†æ¶å¼€å‘è€…é«˜åº¦ä¾èµ–cuDNNæ¥è·å¾—GPUçš„é«˜æ€§èƒ½ï¼ŒåŒæ—¶é¿å…è‡ªå·±å¤„ç†åº•å±‚ä¼˜åŒ–ã€‚ä¸»æµæ¡†æ¶ä¸­ï¼Œå‰å‘åå‘çš„å¤§éƒ¨åˆ†å¼ é‡è¿ç®—éƒ½ä¼šè°ƒç”¨cuDNNå’ŒcuBLASç­‰åº“ï¼Œè¿™ä½¿å¾—æ¡†æ¶å¼€å‘è€…èƒ½å°†ç²¾åŠ›é›†ä¸­åœ¨æ¨¡å‹æ„å»ºä¸Šï¼Œè€Œå°†æ€§èƒ½ä¼˜åŒ–äº¤ç»™åº•å±‚åº“å»åšã€‚åœ¨å­¦ä¹ CUDAçš„è¿‡ç¨‹ä¸­ï¼Œäº†è§£å¹¶å­¦ä¼šè°ƒç”¨è¿™äº›åº“å¯ä»¥è®©ä½ äº‹åŠåŠŸå€ã€‚ä¾‹å¦‚ï¼Œå°è¯•ç”¨cuBLASå®ç°çŸ©é˜µä¹˜æ³•ï¼Œæˆ–ç”¨cuDNNå®ç°å·ç§¯ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ æ’­ï¼Œå¹¶ä¸è‡ªå·±å†™çš„æ ¸å‡½æ•°æ€§èƒ½å¯¹æ¯”ï¼Œä»å®è·µä¸­ä½“ä¼šä¸“ä¸šåº“çš„ä¼˜åŒ–ç¨‹åº¦ã€‚</li>
<li><strong>TensorRTï¼šå®Œæˆæ¨¡å‹è®­ç»ƒåï¼Œéƒ¨ç½²é˜¶æ®µéœ€è¦è¿›ä¸€æ­¥å‹æ¦¨æ¨ç†æ€§èƒ½ã€‚TensorRTæ˜¯NVIDIAæä¾›çš„æ·±åº¦å­¦ä¹ æ¨¡å‹æ¨ç†ä¼˜åŒ–æ¡†æ¶</strong>ã€‚å®ƒå¯ä»¥æ¥æ”¶è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œï¼ˆé€šè¿‡ONNXç­‰æ ¼å¼å¯¼å…¥ï¼‰ï¼Œå¹¶å¯¹æ¨¡å‹è¿›è¡Œä¸€ç³»åˆ—ä¼˜åŒ–ï¼ˆå¦‚FP16/INT8ç²¾åº¦é™ä½ä»¥æ¢å–é€Ÿåº¦ï¼Œèåˆç›¸é‚»ç®—å­ï¼Œè‡ªåŠ¨é€‰æ‹©æœ€å¿«çš„å†…æ ¸å®ç°ï¼Œå†…å­˜å¤ç”¨å’Œå¼‚æ­¥æ‰§è¡Œç­‰ï¼‰ã€‚TensorRTåˆ©ç”¨äº†CUDAçš„å„ç§é«˜çº§ç‰¹æ€§ï¼ˆæµã€å¤šæ ¸å¹¶è¡Œã€å¼ é‡æ ¸å¿ƒæŒ‡ä»¤ç­‰ï¼‰æ¥ç”Ÿæˆé’ˆå¯¹ç‰¹å®šGPUç¡¬ä»¶é«˜åº¦ä¼˜åŒ–çš„æ¨ç†å¼•æ“ã€‚é€šè¿‡å­¦ä¹ CUDAç¼–ç¨‹ï¼Œå¼€å‘è€…æ›´å®¹æ˜“ç†è§£TensorRTå®ç°çš„å„ç§åŠ é€Ÿç­–ç•¥ï¼Œä¾‹å¦‚å‰è¿°çš„åˆå¹¶å†…å­˜è®¿é—®ã€ç®—å­èåˆä»¥åŠå¤šæµå¹¶è¡Œæ‰§è¡Œç­‰ï¼Œè¿™äº›éƒ½æ˜¯TensorRTç”¨æ¥æå‡æ¨ç†é€Ÿåº¦çš„æŠ€æœ¯åŸºç¡€ã€‚è™½ç„¶ä½¿ç”¨TensorRTä¸éœ€è¦æ‰‹å†™CUDAä»£ç ï¼Œä½†ä½œä¸ºCUDAå­¦ä¹ çš„å»¶ä¼¸ï¼Œäº†è§£TensorRTçš„åŸç†ä¼šè®©ä½ å¯¹GPUåŠ é€Ÿæ·±åº¦å­¦ä¹ çš„å…¨è²Œæœ‰æ›´æ·±å…¥çš„è®¤è¯†ã€‚å¯¹äºæœ‰å®æ—¶æ€§èƒ½è¦æ±‚çš„æ·±åº¦å­¦ä¹ é¡¹ç›®ï¼ŒæŒæ¡TensorRTçš„ä½¿ç”¨èƒ½å¤Ÿå¤§å¹…é™ä½å»¶è¿Ÿå¹¶æé«˜ååé‡ã€‚</li>
</ul>
<h2>å®è·µ</h2>
<p>ç†è®ºç»“åˆå®è·µæ˜¯æŒæ¡CUDAçš„æœ€ä½³é€”å¾„ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ¨èçš„ç»ƒä¹ é¡¹ç›®å’Œå®è·µæ¡ˆä¾‹ï¼Œå¸®åŠ©å·©å›ºæ‰€å­¦çŸ¥è¯†å¹¶ç§¯ç´¯å®æˆ˜ç»éªŒï¼š</p>
<ul>
<li><strong>CUDAç¤ºä¾‹ç¨‹åºç»ƒä¹ ï¼š</strong> ä»å®˜æ–¹ç¤ºä¾‹æˆ–æ•™ç¨‹å…¥æ‰‹ï¼Œè¿è¡Œå¹¶åˆ†æç®€å•çš„CUDAç¨‹åºã€‚ä¾‹å¦‚<em>NVIDIA CUDA Samples</em>ä¸­ç»å…¸çš„â€œå‘é‡åŠ æ³• (vectorAdd)â€å’Œâ€œçŸ©é˜µä¹˜æ³• (matrixMul)â€ç¤ºä¾‹ã€‚é€šè¿‡å®è·µè¿™äº›å…¥é—¨æ¡ˆä¾‹ï¼ŒæŒæ¡CUDAç¨‹åºçš„åŸºæœ¬ç»“æ„ï¼šå†…å­˜åˆ†é…/æ•°æ®ä¼ è¾“/æ ¸å‡½æ•°è°ƒç”¨/ç»“æœéªŒè¯ã€‚å°è¯•ä¿®æ”¹çº¿ç¨‹å—å¤§å°ç­‰å‚æ•°è§‚å¯Ÿå¯¹ç»“æœå’Œæ€§èƒ½çš„å½±å“ã€‚</li>
<li><strong>çŸ©é˜µä¹˜æ³•ä¼˜åŒ–å¯¹æ¯”ï¼šå®ç°ä¸€ä¸ªæ‰‹å†™çŸ©é˜µä¹˜æ³•</strong> çš„CUDAæ ¸å‡½æ•°ï¼Œç”¨äºç›¸ä¹˜ä¸¤ä¸ªå¤§çŸ©é˜µï¼Œè®¡æ—¶å¹¶åˆ†ææ€§èƒ½ã€‚ç„¶åè°ƒç”¨cuBLASåº“çš„çŸ©é˜µä¹˜æ³•ï¼ˆå¦‚<code>cublasSgemm</code>ï¼‰è¿›è¡Œç›¸åŒè®¡ç®—ï¼Œå°†ç»“æœå’Œæ€§èƒ½è¿›è¡Œæ¯”è¾ƒã€‚é€šè¿‡å¯¹æ¯”å®éªŒï¼Œä½“ä¼šæ‰‹å·¥ä¼˜åŒ–ï¼ˆå¦‚ä½¿ç”¨å…±äº«å†…å­˜åš<strong>tiling</strong>ã€å¾ªç¯å±•å¼€ã€å‡å°‘å…¨å±€å†…å­˜è®¿é—®ç­‰ï¼‰å¯¹æ€§èƒ½çš„å½±å“ï¼Œä»¥åŠåº“å‡½æ•°æ˜¯å¦‚ä½•å……åˆ†åˆ©ç”¨GPUå¸¦å®½å’Œè®¡ç®—èƒ½åŠ›çš„ã€‚è¿™ä¸ªç»ƒä¹ èƒ½å¸®åŠ©ç†è§£GPUä¸ŠçŸ©é˜µè¿ç®—çš„ä¼˜åŒ–è¦ç‚¹ï¼Œä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ åŠ é€Ÿçš„åŸºç¡€ã€‚</li>
<li>**CUDAä¼˜åŒ–å®æˆ˜é¡¹ç›®ï¼š**é€‰æ‹©ä¸€ä¸ªè®¡ç®—å¯†é›†å‹çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç”¨CUDAè¿›è¡ŒåŠ é€Ÿå®ç°ã€‚ä¾‹å¦‚ï¼š<ul>
<li>å®ç°å¤§è§„æ¨¡å‘é‡ç‚¹ç§¯æˆ–çŸ©é˜µ<strong>å½’çº¦</strong>ï¼ˆå¦‚è®¡ç®—å‘é‡èŒƒæ•°ã€æ‰€æœ‰å…ƒç´ ä¹‹å’Œï¼‰å¹¶ä¼˜åŒ–å…¶å¹¶è¡Œæ€§èƒ½ï¼Œå¯¹æ¯”CPUå•çº¿ç¨‹å®ç°çš„é€Ÿåº¦ã€‚</li>
<li>ç¼–å†™CUDAæ ¸å‡½æ•°å®ç°ç®€åŒ–çš„<strong>å·ç§¯ç¥ç»ç½‘ç»œå‰å‘ä¼ æ’­</strong>ï¼šå¦‚å®ç°ä¸€ä¸ªå°å‹å·ç§¯å±‚+ReLUçš„è®¡ç®—ï¼Œå°†è¾“å…¥å›¾åƒæ˜ å°„åˆ°è¾“å‡ºç‰¹å¾å›¾ã€‚å¯å…ˆç”¨ç›´æ¥å·ç§¯å®ç°ï¼Œå†å°è¯•ä¼˜åŒ–ï¼ˆå¦‚ä½¿ç”¨shared memoryç¼“å­˜tileï¼Œæˆ–è€…ç”¨Im2col+çŸ©é˜µä¹˜å®ç°ï¼‰å¹¶æ¯”è¾ƒæ€§èƒ½æå‡ã€‚</li>
<li>å°†ä¸€ä¸ªç°æœ‰çš„æœºå™¨å­¦ä¹ Pythonä»£ç ï¼ˆå¦‚NumPyå®ç°çš„ç®—æ³•ï¼‰æ”¹å†™ä¸ºCUDA C/C++å®ç°ï¼Œæˆ–é€šè¿‡<strong>Python Cæ‰©å±•</strong>è°ƒç”¨CUDAï¼Œå®ç°æ˜¾è‘—çš„åŠ é€Ÿã€‚æ¯”å¦‚ç”¨CUDAåŠ é€ŸK-Meansèšç±»ä¸­çš„è·ç¦»è®¡ç®—ï¼Œæˆ–åŠ é€Ÿé€»è¾‘å›å½’è®­ç»ƒä¸­çš„æ‰¹é‡æ¢¯åº¦è®¡ç®—ç­‰ã€‚</li>
</ul>
</li>
<li><strong>æ·±åº¦å­¦ä¹ æ¡†æ¶è‡ªå®šä¹‰ç®—å­ï¼š</strong> å¯¹äºå·²ç»æŒæ¡CUDAåŸºç¡€çš„å¼€å‘è€…ï¼Œå¯æŒ‘æˆ˜ç¼–å†™æ·±åº¦å­¦ä¹ æ¡†æ¶çš„è‡ªå®šä¹‰GPUç®—å­ã€‚ä¾‹å¦‚åœ¨PyTorchä¸­ç”¨CUDAæ‰©å±•å®ç°ä¸€ä¸ªæ–°çš„ç®—å­ï¼ˆå¦‚è‡ªå®šä¹‰æ¿€æ´»å‡½æ•°çš„å‰å‘å’Œåå‘ï¼ŒNMSéæå¤§å€¼æŠ‘åˆ¶ç®—æ³•ç­‰ï¼‰ã€‚è¿™éœ€è¦ç»“åˆæ¡†æ¶æä¾›çš„æ¥å£ï¼Œç”¨CUDAä»£ç æ“ä½œå¼ é‡æ•°æ®ã€‚é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œæ—¢èƒ½ç†Ÿæ‚‰æ¡†æ¶ä¸CUDAçš„ç»“åˆï¼Œä¹Ÿèƒ½å°†å­¦åˆ°çš„ä¼˜åŒ–æŠ€å·§åº”ç”¨åˆ°å®é™…æ·±åº¦å­¦ä¹ ä»»åŠ¡ä¸­ã€‚</li>
<li><strong>é˜…è¯»å¼€æºGPUä»£ç ï¼šæŒ‘é€‰ä¸€äº›ä¼˜ç§€çš„å¼€æºé¡¹ç›®æˆ–åº“ï¼Œé˜…è¯»å…¶CUDAç›¸å…³æºç ä»¥å­¦ä¹ é«˜æ‰‹çš„ç¼–ç¨‹æŠ€å·§ã€‚ä¾‹å¦‚NVIDIAå¼€æºçš„CUTLASS</strong> åº“æ˜¯ç”¨äºæ„å»ºé«˜æ€§èƒ½çŸ©é˜µä¹˜æ³•å†…æ ¸çš„æ¨¡æ¿åº“ï¼Œå…¶ä¸­åŒ…å«äº†å¼ é‡æ ¸å¿ƒåˆ©ç”¨ã€å¯„å­˜å™¨æ‹¦æˆªTileç­‰é«˜çº§ä¼˜åŒ–æŠ€å·§ã€‚å†å¦‚ä¸€äº›ç»å…¸æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆCaffeã€Darknetç­‰ï¼‰ä¸­ä¹Ÿæœ‰CUDAå†…æ ¸ä»£ç å®ç°çš„å±‚ï¼Œé˜…è¯»è¿™äº›ä»£ç æœ‰åŠ©äºç†è§£å®é™…å·¥ç¨‹ä¸­å¦‚ä½•ç»„ç»‡CUDAè®¡ç®—ã€‚é˜…è¯»å’Œåˆ†æä»–äººä»£ç å¯ä»¥å·©å›ºæ‰€å­¦æ¦‚å¿µï¼Œå¹¶å­¦åˆ°å®ç”¨çš„ç¼–ç¨‹èŒƒå¼ã€‚</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šå®è·µï¼Œåˆå­¦è€…å¯ä»¥é€æ­¥å°†ç†è®ºè½¬åŒ–ä¸ºæŠ€èƒ½ã€‚åœ¨å®è·µä¸­é‡åˆ°çš„é—®é¢˜ï¼ˆå¦‚å†…å­˜è¶Šç•Œã€ä¸åŒGPUæŒ‡ä»¤ç»“æœä¸ä¸€è‡´ç­‰ï¼‰ä¹Ÿéƒ½æ˜¯å®è´µçš„å­¦ä¹ æœºä¼šï¼Œå› ä¸ºå®ƒä»¬ä¿ƒä½¿ä½ æ·±å…¥äº†è§£CUDAçš„å·¥ä½œåŸç†ã€‚åœ¨åå¤è°ƒè¯•å’Œä¼˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒCUDAç¼–ç¨‹èƒ½åŠ›ä¼šå¾—åˆ°æ˜¾è‘—æå‡ã€‚</p>
<h2>å­¦ä¹ èµ„æ–™</h2>
<p><strong>å®˜æ–¹æ–‡æ¡£ä¸æ•™ç¨‹ï¼š</strong> é¦–å…ˆæ˜¯ NVIDIA å®˜æ–¹æä¾›çš„æ–‡æ¡£å’Œæ•™ç¨‹ï¼ŒåŒ…æ‹¬ã€ŠCUDA C ç¼–ç¨‹æŒ‡å—ã€‹å’Œã€ŠCUDA æœ€ä½³å®è·µæŒ‡å—ã€‹ç­‰ã€‚è¿™äº›æƒå¨æ–‡æ¡£è¯¦ç»†æè¿°äº†CUDAçš„ç¼–ç¨‹æ¨¡å‹å’Œå„é¡¹ç‰¹æ€§ï¼Œå¹¶æä¾›äº†ä¼˜åŒ–æŒ‡å—ã€‚NVIDIAå¼€å‘è€…å®˜ç½‘çš„ <a href="https://developer.nvidia.cn/cuda-zone">CUDAä¸“åŒº</a> æä¾›äº†ä¸°å¯Œçš„å…¥é—¨èµ„æºï¼ˆè§†é¢‘ã€ç¤ºä¾‹ä»£ç ã€ç ”è®¨ä¼šç­‰ä»¥åŠç¼–ç¨‹æŒ‡å—å’ŒAPIå‚è€ƒã€‚é€šè¿‡é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œèƒ½å…¨é¢ç³»ç»Ÿåœ°äº†è§£CUDAæ¶æ„å’Œç¼–ç¨‹æ¥å£ç»†èŠ‚ã€‚</p>
<p><strong>åœ¨çº¿è¯¾ç¨‹ï¼š</strong> é€‰æ‹©é€‚åˆçš„çº¿ä¸Šè¯¾ç¨‹èƒ½å¤Ÿç³»ç»Ÿæ€§åœ°å­¦ä¹ CUDAå¹¶è¡Œç¼–ç¨‹æ¦‚å¿µã€‚ä¾‹å¦‚Udacityçš„CUDAå¹¶è¡Œç¼–ç¨‹å…¥é—¨è¯¾ç¨‹ï¼ˆè®²æˆGPUå¹¶è¡ŒåŸºç¡€ï¼Œæœ‰å…è´¹è¯¾ç¨‹ææ–™ï¼‰ï¼ŒCourseraä¸Šçš„Heterogeneous Parallel Programmingï¼ˆè®²æˆCUDA C/C++ç¼–ç¨‹å’Œä¼˜åŒ–ï¼Œç”±GPUè®¡ç®—é¢†åŸŸä¸“å®¶ä¸»è®²ï¼‰ï¼Œä»¥åŠNVIDIAæ·±åº¦å­¦ä¹ å­¦é™¢ï¼ˆDLIï¼‰çš„ç›¸å…³åŸ¹è®­è¯¾ç¨‹ã€‚è¿™äº›è¯¾ç¨‹é€šå¸¸åŒ…å«è§†é¢‘è®²è§£ã€ç¤ºä¾‹ä»£ç å’Œç¼–ç¨‹ä½œä¸šï¼Œæœ‰åŠ©äºé€æ­¥æŒæ¡ä»åŸºç¡€åˆ°é«˜çº§çš„æŠ€èƒ½ã€‚</p>
<p><strong>ä¹¦ç±èµ„æ–™ï¼š</strong> ç»å…¸çš„ä¹¦ç±æœ‰ã€Š<em>CUDA By Example</em>ã€‹ï¼ˆä¸­æ–‡è¯‘åã€ŠCUDAå®ä¾‹è¯¦è§£ã€‹ï¼‰å’Œã€Š<em>Programming Massively Parallel Processors</em>ã€‹ï¼ˆã€ŠGPUé«˜æ€§èƒ½ç¼–ç¨‹ï¼šå¤§é‡å¹¶è¡Œå¤„ç†å™¨ç¼–ç¨‹ã€‹ï¼‰ç­‰ã€‚è¿™äº›ä¹¦ä»åŸç†åˆ°å®è·µè¯¦ç»†ä»‹ç»äº†CUDAç¼–ç¨‹ï¼Œæ¶µç›–åŸºç¡€çŸ¥è¯†ã€å®ä¾‹è®²è§£å’Œä¼˜åŒ–æŠ€å·§ï¼Œéå¸¸é€‚åˆä½œä¸ºæ·±å…¥å­¦ä¹ çš„å‚è€ƒã€‚å¯¹äºåé‡ç®—æ³•å’Œåº”ç”¨çš„è¯»è€…ï¼Œã€ŠCUDAä¼˜åŒ–æŠ€å·§ä¸å¹¶è¡Œç®—æ³•å®è·µã€‹ã€ŠGPUå¹¶è¡Œç®—æ³•è®¾è®¡æ¨¡å¼ã€‹ä¹‹ç±»çš„ä¹¦ç±ä¹Ÿå€¼å¾—ä¸€é˜…ã€‚</p>
<p><strong>æŠ€æœ¯åšå®¢ä¸ç¤¾åŒºï¼š</strong> åˆ©ç”¨ç¤¾åŒºèµ„æºè·å–ä»–äººç»éªŒå’Œæœ€æ–°èµ„è®¯ã€‚ä¾‹å¦‚NVIDIAå®˜æ–¹åšå®¢ç»å¸¸å‘å¸ƒCUDAä¼˜åŒ–æŠ€å·§ã€æ¡ˆä¾‹åˆ†æï¼ˆåŒ…æ‹¬<a href="https://developer.nvidia.com/zh-cn/blog/how-access-global-memory-efficiently-cuda-c-kernels">ä¸­æ–‡æŠ€æœ¯åšå®¢</a>ç­‰ï¼‰ï¼Œå¼€å‘è€…è®ºå›å¯ä»¥æé—®äº¤æµã€‚ä¸­æ–‡ç¤¾åŒºä¸­ï¼ŒCSDNã€çŸ¥ä¹ä¸Šæœ‰å¤§é‡CUDAæ•™ç¨‹å’Œè¸©å‘åˆ†äº«ï¼Œå¯ä»¥æœç´¢å…³é”®è¯æŸ¥æ‰¾å¯¹åº”ä¸»é¢˜çš„æ–‡ç« ï¼ˆå¦‚â€œCUDA å†…å­˜ä¼˜åŒ–â€ã€â€œå…±äº«å†…å­˜ bank conflictå®ä¾‹â€ç­‰ï¼‰ã€‚Stack Overflowç­‰è‹±æ–‡è®ºå›åŒæ ·æ±‡é›†äº†å¾ˆå¤šé—®é¢˜è§£ç­”ã€‚ä¸»åŠ¨å‚ä¸ç¤¾åŒºè®¨è®ºèƒ½å¸®åŠ©è§£å†³å®é™…é—®é¢˜ã€æ‹“å®½è§†é‡ã€‚</p>
<p><strong>å¼€æºä»£ç ä¸é¡¹ç›®ï¼š</strong> åœ¨GitHubä¸ŠæŸ¥æ‰¾å…³é”®è¯â€œCUDAâ€ä¼šå‡ºç°è®¸å¤šå¼€æºé¡¹ç›®å’Œä»£ç ç‰‡æ®µã€‚ä¾‹å¦‚ä¸€äº›æœºå™¨å­¦ä¹ åŠ é€Ÿåº“ã€GPUç‰ˆç®—æ³•å®ç°ç­‰ã€‚å¯ä»¥å‚è€ƒè¿™äº›å¼€æºé¡¹ç›®çš„ä»£ç æ¥å­¦ä¹ CUDAçš„å®é™…ç”¨æ³•ã€‚ä¾‹å¦‚GitHubä¸Šçš„kokkosé¡¹ç›®å±•ç¤ºäº†è·¨å¹³å°çš„å¹¶è¡Œå®ç°ï¼ŒCUDA Samplesä»“åº“åˆ™æ±‡é›†äº†å„ç±»ç»å…¸çš„CUDAç¤ºä¾‹ç¨‹åºã€‚é€šè¿‡é˜…è¯»å’Œè¿è¡Œè¿™äº›ä»£ç ï¼Œå¯ä»¥åŠ æ·±å¯¹CUDA APIå’Œä¼˜åŒ–æ‰‹æ®µçš„ç†è§£ã€‚</p>

    </article>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js"></script>
<script>
Prism.highlightAll();
document.querySelectorAll('article pre').forEach(pre => {
    const code = pre.querySelector('code');
    if (!code) return;
    const toolbar = document.createElement('div');
    toolbar.className = 'code-toolbar';
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.onclick = () => {
        navigator.clipboard.writeText(code.textContent).then(() => {
            btn.textContent = 'Copied!';
            btn.classList.add('copied');
            setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
        });
    };
    toolbar.appendChild(btn);
    pre.parentNode.insertBefore(toolbar, pre);
});
</script>
</body>
</html>