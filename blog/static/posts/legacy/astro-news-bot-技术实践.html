<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astro-News-Botï¼šæ„å»º AI é©±åŠ¨çš„è‡ªåŠ¨åŒ–æ–°é—»èšåˆä¸å‘å¸ƒç³»ç»Ÿ | Yuxu Ge</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        :root {
            --black: #111;
            --dark-grey: #444;
            --off-white: #f4f4f4;
            --vermilion: #C41E3A;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--black);
            background-color: var(--off-white);
        }

        a { color: var(--vermilion); text-decoration: none; }
        a:hover { opacity: 0.75; }

        .layout { min-height: 100vh; }

        /* Sidebar */
        .sidebar {
            position: fixed; top: 0; left: 0;
            width: 320px; height: 100vh;
            background: var(--black); color: var(--off-white);
            padding: 3rem 2rem;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .sidebar-top { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .avatar { display: block; width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--vermilion); margin-bottom: 1.5rem; overflow: hidden; transition: transform 0.2s ease; }
        .avatar:hover { opacity: 1; transform: scale(1.05); }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }
        .name-block { margin-bottom: 0.5rem; }
        h1 { font-size: 1.8rem; font-weight: 700; letter-spacing: 1px; color: var(--off-white); }
        .title-role { font-size: 0.9rem; color: #888; margin-top: 0.25rem; font-weight: 400; }
        .contact-block { margin-top: 2.5rem; width: 100%; }
        .social-links { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; }
        .social-links a { display: flex; align-items: center; gap: 0.75rem; width: 160px; color: var(--off-white); opacity: 0.7; padding: 0.5rem 0.75rem; border-radius: 4px; font-size: 0.9rem; transition: all 0.2s; }
        .social-links a:hover { color: var(--vermilion); opacity: 1; background: rgba(255,255,255,0.05); }
        .social-links svg { width: 20px; height: 20px; flex-shrink: 0; }
        .social-links .orcid-link { font-size: 0.68rem; gap: 0.5rem; white-space: nowrap; }
        .sidebar-footer { text-align: center; font-size: 0.75rem; color: #555; }

        /* Content */
        .content { margin-left: 320px; padding: 3rem 4rem; max-width: 900px; }
        .back-link { display: inline-block; font-size: 0.85rem; margin-bottom: 2rem; color: var(--dark-grey); }
        .back-link:hover { color: var(--vermilion); }

        /* Article */
        article h1 { font-size: 2rem; font-weight: 700; margin-bottom: 1.5rem; line-height: 1.3; color: var(--black); }
        article h2 { font-size: 1.4rem; font-weight: 600; margin: 2rem 0 1rem; color: var(--black); }
        article h3 { font-size: 1.1rem; font-weight: 600; margin: 1.5rem 0 0.75rem; color: var(--black); }
        article p { margin-bottom: 1rem; color: var(--dark-grey); }
        article ul, article ol { margin: 1rem 0 1rem 1.5rem; color: var(--dark-grey); }
        article li { margin-bottom: 0.5rem; }
        article strong { color: var(--black); }
        article code { font-family: "SF Mono", Monaco, monospace; font-size: 0.9em; background: #e8e8e8; padding: 0.15em 0.4em; border-radius: 3px; }
        article pre { margin: 1rem 0; border-radius: 6px; overflow-x: auto; background: #2d2d2d; padding: 1rem; }
        article pre code { background: none; padding: 0; font-size: 0.75em; white-space: pre !important; counter-reset: line; display: block; color: #ccc; }
        article pre code .line { counter-increment: line; }
        article pre code .line::before { content: counter(line); display: inline-block; width: 2.5em; margin-right: 1em; text-align: right; color: #666; user-select: none; }
        .code-toolbar { display: flex; justify-content: flex-start; padding: 0.35rem 0.5rem; background: #3a3a3a; border-radius: 6px 6px 0 0; }
        .code-toolbar + pre { margin-top: 0; border-radius: 0 0 6px 6px; }
        .copy-btn { padding: 0.2rem 0.5rem; font-size: 0.7rem; background: #555; color: #fff; border: none; border-radius: 3px; cursor: pointer; transition: all 0.2s; }
        .copy-btn:hover, .copy-btn:active { background: #777; }
        .copy-btn.copied { background: #2a2; }
        article blockquote { border-left: 3px solid var(--vermilion); padding-left: 1rem; margin: 1rem 0; color: #666; font-style: italic; }
        article hr { border: none; border-top: 1px solid #ddd; margin: 2rem 0; }
        article table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem; }
        article th, article td { border: 1px solid #ddd; padding: 0.5rem 0.75rem; text-align: left; }
        article th { background: #e8e8e8; font-weight: 600; }
        article img { max-width: 100%; height: auto; display: block; margin: 1.5rem 0; border-radius: 6px; }

        .loading { text-align: center; padding: 3rem; color: #888; }
        .error { color: var(--vermilion); }

        /* KaTeX math styles */
        .katex-display { overflow-x: auto; overflow-y: hidden; padding: 0.5rem 0; }
        .katex { font-size: 1.1em; }

        /* Responsive */
        @media (max-width: 900px) {
            .sidebar { position: relative; width: 100%; height: auto; padding: 2rem 1.5rem 1rem; }
            .social-links { flex-direction: row; flex-wrap: wrap; justify-content: center; }
            .social-links a, .social-links .orcid-link { width: auto; padding: 0.5rem; font-size: 0; gap: 0; }
            .social-links svg { width: 24px; height: 24px; }
            .social-links .hide-mobile { display: none; }
            .sidebar-footer { margin-top: 1rem; }
            .content { margin-left: 0; padding: 2rem 1rem; }
        }
        @media (max-width: 480px) {
            .sidebar { padding: 1.5rem 1rem 1rem; }
            .avatar { width: 80px; height: 80px; }
            h1 { font-size: 1.4rem; }
            article h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

<div class="layout">
    <aside class="sidebar" id="sidebar-content"></aside>
    <script src="/components/sidebar.js"></script>

    <main class="content">
        <a href="/blog/" class="back-link">â† Back to Blog</a>
        <article>
<hr>
<h2>date: 2024-01-01
tags: [ai]
legacy: true</h2>
<h1>Astro-News-Botï¼šæ„å»º AI é©±åŠ¨çš„è‡ªåŠ¨åŒ–æ–°é—»èšåˆä¸å‘å¸ƒç³»ç»Ÿ</h1>
<p>åœ¨æ¶æ„è®¾è®¡ä¹‹åˆï¼Œæˆ‘éµå¾ªäº†å‡ ä¸ªæ ¸å¿ƒåŸåˆ™ï¼š</p>
<ol>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šæ¯ä¸ªåŠŸèƒ½ï¼ˆæŠ“å–ã€å»é‡ã€AI å¤„ç†ã€å‘å¸ƒï¼‰éƒ½æ˜¯ç‹¬ç«‹æ¨¡å—ï¼Œæ˜“äºç»´æŠ¤å’Œæ›¿æ¢</li>
<li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šæ•´ä¸ªæµç¨‹æ— éœ€äººå·¥å¹²é¢„ï¼Œå®ç°&quot;ä¸€æ¬¡è®¾ç½®ï¼Œæ°¸è¿œè¿è¡Œ&quot;</li>
<li><strong>å¹‚ç­‰æ€§</strong>ï¼šé‡å¤è¿è¡Œä»»åŠ¡ä¸äº§ç”Ÿå‰¯ä½œç”¨</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ–¹ä¾¿å¢åŠ æ–°çš„æ–°é—»æºæˆ–å¤„ç†æ­¥éª¤</li>
</ol>
<h3>æŠ€æœ¯æ¶æ„</h3>
<p>åŸºäºè¿™äº›åŸåˆ™ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ªçº¿æ€§çš„æ•°æ®å¤„ç†ç®¡é“ï¼š</p>
<pre><code><span class="line">RSSæº â†’ æŠ“å–å™¨ â†’ å‘é‡å»é‡ â†’ AIæ‘˜è¦ â†’ Markdownç”Ÿæˆ â†’ Gitå‘å¸ƒ â†’ åšå®¢éƒ¨ç½²</span></code></pre>
<p>æ ¸å¿ƒæ¨¡å—ç»“æ„ï¼š</p>
<pre><code><span class="line">astro-news-bot/</span>
<span class="line">â”œâ”€â”€ news_bot/</span>
<span class="line">â”‚   â”œâ”€â”€ fetcher.py      # æ–°é—»è·å–</span>
<span class="line">â”‚   â”œâ”€â”€ dedup.py        # å‘é‡å»é‡</span>
<span class="line">â”‚   â”œâ”€â”€ summarizer.py   # AI æ‘˜è¦</span>
<span class="line">â”‚   â”œâ”€â”€ writer.py       # Markdown ç”Ÿæˆ</span>
<span class="line">â”‚   â”œâ”€â”€ selector.py     # æ–°é—»ç­›é€‰</span>
<span class="line">â”‚   â”œâ”€â”€ publisher.py    # Git å‘å¸ƒ</span>
<span class="line">â”‚   â””â”€â”€ job.py          # å·¥ä½œæµè°ƒåº¦</span>
<span class="line">â”œâ”€â”€ config.json         # é…ç½®æ–‡ä»¶</span>
<span class="line">â”œâ”€â”€ requirements.txt    # ä¾èµ–åŒ…</span>
<span class="line">â””â”€â”€ run_daily_news.sh  # æ‰§è¡Œè„šæœ¬</span></code></pre>
<h3>æ•°æ®æµç¨‹è®¾è®¡</h3>
<ol>
<li><strong>æ–°é—»è·å–</strong> â†’ å¤šæºæŠ“å– â†’ <code>raw_{date}.json</code></li>
<li><strong>å‘é‡å»é‡</strong> â†’ è¯­ä¹‰ç›¸ä¼¼åº¦è¿‡æ»¤ â†’ <code>dedup_{date}.json</code>  </li>
<li><strong>AI æ‘˜è¦</strong> â†’ GPT-4o ç”Ÿæˆä¸­æ–‡æ‘˜è¦ â†’ <code>summary_{date}.json</code></li>
<li><strong>Markdown ç”Ÿæˆ</strong> â†’ æŒ‰ç±»åˆ«ç»„ç»‡ â†’ <code>news_{date}.md</code></li>
<li><strong>Git å‘å¸ƒ</strong> â†’ æ¨é€åˆ°åšå®¢ä»“åº“ â†’ è§¦å‘è‡ªåŠ¨éƒ¨ç½²</li>
</ol>
<h2>æ ¸å¿ƒæŠ€æœ¯å®ç°</h2>
<h3>1. å‘é‡å»é‡ï¼šå‘Šåˆ«ç®€å•çš„æ ‡é¢˜åŒ¹é…</h3>
<p>é¡¹ç›®åˆæœŸï¼Œæˆ‘ä½¿ç”¨æ–‡ç« æ ‡é¢˜æˆ– URL è¿›è¡Œå»é‡ï¼Œä½†å¾ˆå¿«å‘ç°é—®é¢˜ï¼š</p>
<ul>
<li>ä¸åŒæ–°é—»æºå¯¹åŒä¸€äº‹ä»¶çš„æŠ¥é“æ ‡é¢˜ä¸åŒ</li>
<li>URL å¯èƒ½å› åŒ…å«è¿½è¸ªå‚æ•°è€Œä¸åŒ</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆæ˜¯<strong>åŸºäºè¯­ä¹‰çš„å‘é‡å»é‡</strong>ï¼š</p>
<pre><code class="language-python"><span class="line"># dedup.py æ ¸å¿ƒå®ç°</span>
<span class="line">from sentence_transformers import SentenceTransformer</span>
<span class="line">import numpy as np</span>
<span class="line">from sklearn.metrics.pairwise import cosine_similarity</span>
<span class="line"></span>
<span class="line">class NewsDeduplicator:</span>
<span class="line">    def __init__(self, similarity_threshold=0.85):</span>
<span class="line">        self.model = SentenceTransformer(&#39;all-MiniLM-L6-v2&#39;)</span>
<span class="line">        self.threshold = similarity_threshold</span>
<span class="line">        </span>
<span class="line">    def deduplicate(self, articles):</span>
<span class="line">        if not articles:</span>
<span class="line">            return []</span>
<span class="line">            </span>
<span class="line">        # æå–æ ‡é¢˜æ–‡æœ¬</span>
<span class="line">        titles = [article[&#39;title&#39;] for article in articles]</span>
<span class="line">        </span>
<span class="line">        # ç”Ÿæˆå‘é‡åµŒå…¥</span>
<span class="line">        embeddings = self.model.encode(titles)</span>
<span class="line">        </span>
<span class="line">        # è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µ</span>
<span class="line">        similarity_matrix = cosine_similarity(embeddings)</span>
<span class="line">        </span>
<span class="line">        # å»é‡é€»è¾‘</span>
<span class="line">        to_keep = []</span>
<span class="line">        for i, article in enumerate(articles):</span>
<span class="line">            is_duplicate = False</span>
<span class="line">            for j in to_keep:</span>
<span class="line">                if similarity_matrix[i][j] &gt; self.threshold:</span>
<span class="line">                    is_duplicate = True</span>
<span class="line">                    break</span>
<span class="line">            if not is_duplicate:</span>
<span class="line">                to_keep.append(i)</span>
<span class="line">                </span>
<span class="line">        return [articles[i] for i in to_keep]</span></code></pre>
<p>è¿™ç§æ–¹æ³•èƒ½æœ‰æ•ˆè¯†åˆ«&quot;æ¢äº†ä¸ªè¯´æ³•ä½†å†…å®¹ä¸€æ ·&quot;çš„æ–‡ç« ï¼Œè¿œæ¯”å…³é”®è¯åŒ¹é…ç²¾å‡†ã€‚</p>
<h3>2. AI æ‘˜è¦ä¸åˆ†ç±»ï¼šPrompt Engineering çš„è‰ºæœ¯</h3>
<p>AI æ‘˜è¦å’Œåˆ†ç±»çš„è´¨é‡ç›´æ¥å†³å®šæœ€ç»ˆäº§å‡ºä»·å€¼ã€‚å…³é”®ä¸æ˜¯é€‰æ‹©å“ªä¸ª LLMï¼Œè€Œæ˜¯å¦‚ä½•è®¾è®¡ <strong>Prompt</strong>ï¼š</p>
<pre><code class="language-python"><span class="line"># summarizer.py æ ¸å¿ƒ Prompt</span>
<span class="line">SUMMARY_PROMPT = &quot;&quot;&quot;</span>
<span class="line">ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç§‘æŠ€æ–°é—»ç¼–è¾‘ï¼Œä¸“é—¨ä¸ºå¼€å‘è€…æ•´ç†æ–°é—»æ‘˜è¦ã€‚</span>
<span class="line"></span>
<span class="line">è¯·ä¸ºä»¥ä¸‹æ–°é—»ç”Ÿæˆï¼š</span>
<span class="line">1. ä¸€æ®µä¸è¶…è¿‡100å­—çš„ä¸­æ–‡æ‘˜è¦ï¼Œæ¦‚æ‹¬æ ¸å¿ƒä¿¡æ¯</span>
<span class="line">2. ä»ä»¥ä¸‹åˆ†ç±»ä¸­é€‰æ‹©æœ€åˆé€‚çš„ä¸€ä¸ªï¼šäººå·¥æ™ºèƒ½ã€ç§»åŠ¨æŠ€æœ¯ã€è‡ªåŠ¨é©¾é©¶ã€äº‘è®¡ç®—ã€èŠ¯ç‰‡æŠ€æœ¯ã€åˆ›ä¸šæŠ•èµ„ã€ç½‘ç»œå®‰å…¨ã€åŒºå—é“¾ã€ç§‘å­¦ç ”ç©¶ã€å…¶ä»–ç§‘æŠ€</span>
<span class="line"></span>
<span class="line">æ–°é—»å†…å®¹ï¼š</span>
<span class="line">æ ‡é¢˜ï¼š{title}</span>
<span class="line">æè¿°ï¼š{description}</span>
<span class="line">æ¥æºï¼š{source}</span>
<span class="line"></span>
<span class="line">è¯·ä»¥JSONæ ¼å¼è¿”å›ï¼š</span>
<span class="line">{{</span>
<span class="line">  &quot;summary&quot;: &quot;æ‘˜è¦å†…å®¹&quot;,</span>
<span class="line">  &quot;category&quot;: &quot;åˆ†ç±»åç§°&quot;,</span>
<span class="line">  &quot;tags&quot;: [&quot;æ ‡ç­¾1&quot;, &quot;æ ‡ç­¾2&quot;, &quot;æ ‡ç­¾3&quot;]</span>
<span class="line">}}</span>
<span class="line">&quot;&quot;&quot;</span>
<span class="line"></span>
<span class="line">class NewsSummarizer:</span>
<span class="line">    def __init__(self):</span>
<span class="line">        self.client = OpenAI()</span>
<span class="line">        </span>
<span class="line">    def process_article(self, article):</span>
<span class="line">        prompt = SUMMARY_PROMPT.format(**article)</span>
<span class="line">        </span>
<span class="line">        response = self.client.chat.completions.create(</span>
<span class="line">            model=&quot;gpt-4o&quot;,</span>
<span class="line">            messages=[{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt}],</span>
<span class="line">            max_tokens=500,</span>
<span class="line">            temperature=0.3</span>
<span class="line">        )</span>
<span class="line">        </span>
<span class="line">        return json.loads(response.choices[0].message.content)</span></code></pre>
<p>é€šè¿‡æ˜ç¡®çš„è§’è‰²ã€è¯¦ç»†æŒ‡ä»¤å’Œè¾“å‡ºæ ¼å¼è¦æ±‚ï¼Œè·å¾—ç¨³å®šé«˜è´¨é‡çš„ AI è¾“å‡ºã€‚</p>
<h3>3. GitOps å‘å¸ƒï¼šç¨³å®šå¯é çš„è‡ªåŠ¨åŒ–éƒ¨ç½²</h3>
<p>ä¸ºä»€ä¹ˆé€‰æ‹© Git è€Œä¸æ˜¯ API æ“ä½œåšå®¢åå°ï¼Ÿ</p>
<ul>
<li><strong>åŸå­æ€§å’Œå¯è¿½æº¯æ€§</strong>ï¼šæ¯æ¬¡å†…å®¹æ›´æ–°éƒ½æ˜¯ä¸€æ¬¡ Git Commitï¼Œå¯ä»¥æ¸…æ™°çœ‹åˆ°å˜æ›´è®°å½•</li>
<li><strong>è§£è€¦å’Œå®‰å…¨</strong>ï¼šæœºå™¨äººåªéœ€è¦ Git ä»“åº“å†™æƒé™ï¼Œæ— éœ€æš´éœ²åšå®¢åå°å‡­è¯</li>
<li><strong>åˆ©ç”¨ç°æœ‰ CI/CD</strong>ï¼šå¤ç”¨ Vercel/Netlify ç­‰å¹³å°çš„ Git-Triggered CI/CD</li>
</ul>
<pre><code class="language-python"><span class="line"># publisher.py æ ¸å¿ƒå®ç°</span>
<span class="line">import subprocess</span>
<span class="line">import os</span>
<span class="line"></span>
<span class="line">class NewsPublisher:</span>
<span class="line">    def __init__(self, blog_repo_path):</span>
<span class="line">        self.repo_path = blog_repo_path</span>
<span class="line">        </span>
<span class="line">    def publish(self, commit_message):</span>
<span class="line">        try:</span>
<span class="line">            # åˆ‡æ¢åˆ°åšå®¢ç›®å½•</span>
<span class="line">            os.chdir(self.repo_path)</span>
<span class="line">            </span>
<span class="line">            # æ‹‰å–æœ€æ–°ä»£ç </span>
<span class="line">            subprocess.run([&#39;git&#39;, &#39;pull&#39;], check=True)</span>
<span class="line">            </span>
<span class="line">            # æ·»åŠ æ–°æ–‡ä»¶</span>
<span class="line">            subprocess.run([&#39;git&#39;, &#39;add&#39;, &#39;.&#39;], check=True)</span>
<span class="line">            </span>
<span class="line">            # æ£€æŸ¥æ˜¯å¦æœ‰å˜æ›´</span>
<span class="line">            result = subprocess.run([&#39;git&#39;, &#39;diff&#39;, &#39;--cached&#39;, &#39;--exit-code&#39;], </span>
<span class="line">                                  capture_output=True)</span>
<span class="line">            if result.returncode == 0:</span>
<span class="line">                print(&quot;No changes to commit&quot;)</span>
<span class="line">                return</span>
<span class="line">                </span>
<span class="line">            # æäº¤å¹¶æ¨é€</span>
<span class="line">            subprocess.run([&#39;git&#39;, &#39;commit&#39;, &#39;-m&#39;, commit_message], check=True)</span>
<span class="line">            subprocess.run([&#39;git&#39;, &#39;push&#39;], check=True)</span>
<span class="line">            </span>
<span class="line">            print(f&quot;Successfully published: {commit_message}&quot;)</span>
<span class="line">            </span>
<span class="line">        except subprocess.CalledProcessError as e:</span>
<span class="line">            print(f&quot;Git operation failed: {e}&quot;)</span></code></pre>
<h2>Astro åšå®¢é…å¥—ä¿®æ”¹</h2>
<p>è¦è®© <code>astro-news-bot</code> ä¸ Astro åšå®¢æ— ç¼é›†æˆï¼Œéœ€è¦å¯¹åšå®¢å·¥ç¨‹åšå°‘é‡ä½†å…³é”®çš„ä¿®æ”¹ï¼š</p>
<h3>1. å®šä¹‰ news å†…å®¹é›†åˆ</h3>
<pre><code class="language-typescript"><span class="line">// src/content/config.ts</span>
<span class="line">import { defineCollection, z } from &#39;astro:content&#39;;</span>
<span class="line">import { glob } from &#39;astro/loaders&#39;;</span>
<span class="line"></span>
<span class="line">const news = defineCollection({</span>
<span class="line">  loader: glob({ base: &#39;./src/content/news&#39;, pattern: &#39;**/*.md&#39; }),</span>
<span class="line">  schema: z.object({</span>
<span class="line">    title: z.string(),</span>
<span class="line">    description: z.string().optional(),</span>
<span class="line">    date: z.string().optional(),</span>
<span class="line">    pubDate: z.string().optional(),</span>
<span class="line">    tags: z.array(z.string()).optional(),</span>
<span class="line">    layout: z.string().optional(),</span>
<span class="line">  }),</span>
<span class="line">});</span>
<span class="line"></span>
<span class="line">export const collections = {</span>
<span class="line">  &#39;news&#39;: news,</span>
<span class="line">  // ... å…¶ä»–é›†åˆ</span>
<span class="line">};</span></code></pre>
<h3>2. åˆ›å»º LatestNews ç»„ä»¶</h3>
<pre><code class="language-astro"><span class="line">---</span>
<span class="line">// src/components/LatestNews.astro</span>
<span class="line">import { getCollection } from &#39;astro:content&#39;;</span>
<span class="line"></span>
<span class="line">const newsEntries = await getCollection(&#39;news&#39;);</span>
<span class="line"></span>
<span class="line">let latestNews = null;</span>
<span class="line">if (newsEntries &amp;&amp; newsEntries.length &gt; 0) {</span>
<span class="line">  latestNews = newsEntries</span>
<span class="line">    .filter(entry =&gt; entry.data &amp;&amp; (entry.data.date || entry.data.pubDate))</span>
<span class="line">    .sort((a, b) =&gt; {</span>
<span class="line">      const dateA = new Date(a.data.date || a.data.pubDate);</span>
<span class="line">      const dateB = new Date(b.data.date || b.data.pubDate);</span>
<span class="line">      return dateB.getTime() - dateA.getTime();</span>
<span class="line">    })</span>
<span class="line">    .slice(0, 1)[0];</span>
<span class="line">}</span>
<span class="line">---</span>
<span class="line"></span>
<span class="line">{latestNews &amp;&amp; (</span>
<span class="line">  &lt;div class=&quot;latest-news&quot;&gt;</span>
<span class="line">    &lt;h3&gt;ğŸ“° æœ€æ–°èµ„è®¯&lt;/h3&gt;</span>
<span class="line">    &lt;div class=&quot;news-item&quot;&gt;</span>
<span class="line">      &lt;h4&gt;{latestNews.data.title}&lt;/h4&gt;</span>
<span class="line">      &lt;p&gt;{latestNews.data.description}&lt;/p&gt;</span>
<span class="line">      &lt;a href={`/news/${latestNews.data.date || latestNews.data.pubDate}`}&gt;</span>
<span class="line">        é˜…è¯»è¯¦æƒ… â†’</span>
<span class="line">      &lt;/a&gt;</span>
<span class="line">    &lt;/div&gt;</span>
<span class="line">  &lt;/div&gt;</span>
<span class="line">)}</span>
<span class="line"></span>
<span class="line">&lt;style&gt;</span>
<span class="line">  .latest-news {</span>
<span class="line">    border: 1px solid #e1e5e9;</span>
<span class="line">    border-radius: 8px;</span>
<span class="line">    padding: 1.5rem;</span>
<span class="line">    margin: 1rem 0;</span>
<span class="line">    background: #f8fafc;</span>
<span class="line">  }</span>
<span class="line">  </span>
<span class="line">  .news-item h4 {</span>
<span class="line">    margin: 0 0 0.5rem 0;</span>
<span class="line">    color: #1a1a1a;</span>
<span class="line">  }</span>
<span class="line">  </span>
<span class="line">  .news-item p {</span>
<span class="line">    color: #666;</span>
<span class="line">    margin: 0 0 1rem 0;</span>
<span class="line">  }</span>
<span class="line">  </span>
<span class="line">  .news-item a {</span>
<span class="line">    color: #2563eb;</span>
<span class="line">    text-decoration: none;</span>
<span class="line">    font-weight: 500;</span>
<span class="line">  }</span>
<span class="line">&lt;/style&gt;</span></code></pre>
<h3>3. ä¿®å¤åŠ¨æ€è·¯ç”±æ¸²æŸ“</h3>
<p>ç”±äº Astro 5.x ç‰ˆæœ¬ä½¿ç”¨ glob loaderï¼Œentry å¯¹è±¡ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦é€‚é…ï¼š</p>
<pre><code class="language-astro"><span class="line">---</span>
<span class="line">// src/pages/news/[date].astro</span>
<span class="line">import { getCollection, getEntry } from &#39;astro:content&#39;;</span>
<span class="line"></span>
<span class="line">export async function getStaticPaths() {</span>
<span class="line">  const newsEntries = await getCollection(&#39;news&#39;);</span>
<span class="line">  </span>
<span class="line">  return newsEntries</span>
<span class="line">    .filter(entry =&gt; entry.data &amp;&amp; (entry.data.date || entry.data.pubDate))</span>
<span class="line">    .map(entry =&gt; ({</span>
<span class="line">      params: { </span>
<span class="line">        date: entry.data.date || entry.data.pubDate </span>
<span class="line">      },</span>
<span class="line">      props: { </span>
<span class="line">        entryId: entry.id,  // ä½¿ç”¨ entry.id è€Œä¸æ˜¯ slug</span>
<span class="line">        dateParam: entry.data.date || entry.data.pubDate</span>
<span class="line">      }</span>
<span class="line">    }));</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">const { entryId } = Astro.props;</span>
<span class="line">const post = await getEntry(&#39;news&#39;, entryId);</span>
<span class="line"></span>
<span class="line">if (!post) {</span>
<span class="line">  throw new Error(`No news entry found for entryId: ${entryId}`);</span>
<span class="line">}</span>
<span class="line">---</span>
<span class="line"></span>
<span class="line">&lt;html&gt;</span>
<span class="line">  &lt;body&gt;</span>
<span class="line">    &lt;main&gt;</span>
<span class="line">      &lt;h1&gt;{post.data.title}&lt;/h1&gt;</span>
<span class="line">      &lt;!-- ä½¿ç”¨é¢„æ¸²æŸ“çš„å†…å®¹ --&gt;</span>
<span class="line">      &lt;div set:html={post.rendered.html}&gt;&lt;/div&gt;</span>
<span class="line">    &lt;/main&gt;</span>
<span class="line">  &lt;/body&gt;</span>
<span class="line">&lt;/html&gt;</span></code></pre>
<p>å…³é”®ä¿®æ”¹ç‚¹ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>entry.id</code> è€Œä¸æ˜¯ <code>entry.slug</code>ï¼ˆglob loader ä¸­ slug ä¸º undefinedï¼‰</li>
<li>ä½¿ç”¨ <code>post.rendered.html</code> è·å–é¢„æ¸²æŸ“å†…å®¹</li>
<li>é€šè¿‡ <code>getEntry</code> åœ¨é¡µé¢æ¸²æŸ“æ—¶è·å–å®Œæ•´ entry å¯¹è±¡</li>
</ul>
<h2>å¤šæ ·åŒ–çš„æ‰§è¡Œæ–¹å¼</h2>
<p>ä¸ºäº†é€‚åº”ä¸åŒçš„éƒ¨ç½²ç¯å¢ƒï¼Œæˆ‘è®¾è®¡äº†å¤šç§æ‰§è¡Œæ–¹å¼ï¼š</p>
<h3>1. ç›´æ¥è¿è¡Œï¼ˆå¼€å‘è°ƒè¯•ï¼‰</h3>
<pre><code class="language-bash"><span class="line"># å®Œæ•´å·¥ä½œæµ</span>
<span class="line">python -m news_bot.job --date $(date +%Y-%m-%d)</span>
<span class="line"></span>
<span class="line"># å¹²è·‘æ¨¡å¼ï¼ˆè·³è¿‡å‘å¸ƒï¼‰</span>
<span class="line">python -m news_bot.job --date 2025-07-25 --dry-run</span></code></pre>
<h3>2. Shell è„šæœ¬æ‰§è¡Œ</h3>
<pre><code class="language-bash"><span class="line">#!/bin/bash</span>
<span class="line"># run_daily_news.sh</span>
<span class="line"></span>
<span class="line">cd &quot;$(dirname &quot;$0&quot;)&quot;</span>
<span class="line">source .env</span>
<span class="line"></span>
<span class="line"># åˆ›å»ºæ—¥å¿—ç›®å½•</span>
<span class="line">mkdir -p ~/logs</span>
<span class="line"></span>
<span class="line"># æ‰§è¡Œæ–°é—»å¤„ç†æµç¨‹</span>
<span class="line">DATE=$(date +%Y-%m-%d)</span>
<span class="line">echo &quot;=== Starting news processing for $DATE ===&quot; &gt;&gt; ~/logs/news_bot.log</span>
<span class="line"></span>
<span class="line">python -m news_bot.job --date $DATE &gt;&gt; ~/logs/news_bot.log 2&gt;&amp;1</span>
<span class="line"></span>
<span class="line">echo &quot;=== Completed at $(date -Iseconds) ===&quot; &gt;&gt; ~/logs/news_bot.log</span></code></pre>
<h3>3. å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼ˆæ¨èï¼‰</h3>
<pre><code class="language-bash"><span class="line"># å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ï¼ˆå®Œå…¨åå°è¿è¡Œï¼‰</span>
<span class="line">./start_daemon.sh start</span>
<span class="line"></span>
<span class="line"># æŸ¥çœ‹è¿è¡ŒçŠ¶æ€  </span>
<span class="line">./start_daemon.sh status</span>
<span class="line"></span>
<span class="line"># æŸ¥çœ‹æ—¥å¿—</span>
<span class="line">./start_daemon.sh logs</span>
<span class="line"></span>
<span class="line"># ä¼˜é›…åœæ­¢</span>
<span class="line">./stop_daemon.sh</span></code></pre>
<h3>4. Cron å®šæ—¶ä»»åŠ¡</h3>
<pre><code class="language-bash"><span class="line"># ç¼–è¾‘ crontab</span>
<span class="line">crontab -e</span>
<span class="line"></span>
<span class="line"># æ¯å¤© 8:05 æ‰§è¡Œ</span>
<span class="line">5 8 * * * /Users/geyuxu/repo/astro-news-bot/run_daily_news.sh</span></code></pre>
<h2>è¿ç»´ç»éªŒä¸æœ€ä½³å®è·µ</h2>
<h3>é…ç½®æ–‡ä»¶ç®¡ç†</h3>
<pre><code class="language-json"><span class="line">{</span>
<span class="line">  &quot;output_config&quot;: {</span>
<span class="line">    &quot;blog_content_dir&quot;: &quot;/Users/geyuxu/repo/blog/geyuxu.com/src/content/news&quot;,</span>
<span class="line">    &quot;filename_format&quot;: &quot;news_{date}.md&quot;,</span>
<span class="line">    &quot;use_blog_dir&quot;: true</span>
<span class="line">  },</span>
<span class="line">  &quot;git_config&quot;: {</span>
<span class="line">    &quot;target_branch&quot;: &quot;gh-pages&quot;,</span>
<span class="line">    &quot;auto_switch_branch&quot;: true,</span>
<span class="line">    &quot;push_to_remote&quot;: true</span>
<span class="line">  },</span>
<span class="line">  &quot;news_config&quot;: {</span>
<span class="line">    &quot;max_articles_per_day&quot;: 6,</span>
<span class="line">    &quot;token_budget_per_day&quot;: 4000,</span>
<span class="line">    &quot;similarity_threshold&quot;: 0.85</span>
<span class="line">  },</span>
<span class="line">  &quot;llm_config&quot;: {</span>
<span class="line">    &quot;model&quot;: &quot;gpt-4o&quot;,</span>
<span class="line">    &quot;max_tokens&quot;: 500,</span>
<span class="line">    &quot;temperature&quot;: 0.3</span>
<span class="line">  },</span>
<span class="line">  &quot;scheduler_config&quot;: {</span>
<span class="line">    &quot;enabled&quot;: true,</span>
<span class="line">    &quot;timezone&quot;: &quot;Asia/Shanghai&quot;,</span>
<span class="line">    &quot;cron_expression&quot;: &quot;0 8 * * *&quot;</span>
<span class="line">  }</span>
<span class="line">}</span></code></pre>
<h3>æˆæœ¬æ§åˆ¶</h3>
<ul>
<li>æ¯æ—¥å¤„ç†çº¦ 6 ç¯‡æ–‡ç« </li>
<li>é¢„è®¡ Token æ¶ˆè€—ï¼š~4000 tokens/å¤©</li>
<li>OpenAI æˆæœ¬ï¼šçº¦ $0.01-0.05/å¤©</li>
</ul>
<h3>æ—¥å¿—ç®¡ç†</h3>
<pre><code class="language-bash"><span class="line"># æŸ¥çœ‹å®æ—¶æ—¥å¿—</span>
<span class="line">tail -f logs/daemon.log</span>
<span class="line"></span>
<span class="line"># æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—</span>
<span class="line">tail -f logs/scheduler.log</span>
<span class="line"></span>
<span class="line"># æŸ¥çœ‹ä»Šå¤©çš„æ‰§è¡Œè®°å½•</span>
<span class="line">grep &quot;$(date +%Y-%m-%d)&quot; ~/logs/news_bot.log</span></code></pre>
<h2>é¡¹ç›®ä»·å€¼ä¸æˆæœ</h2>
<h3>æµ‹è¯•éªŒè¯ç»“æœ</h3>
<p>æœ€æ–°æµ‹è¯•ï¼ˆ2025-07-26ï¼‰ï¼š</p>
<ul>
<li>âœ… <strong>Fetcher</strong>ï¼šè·å– 31 ç¯‡ç§‘æŠ€æ–°é—»ï¼ˆRSS æºï¼‰</li>
<li>âœ… <strong>Deduplicator</strong>ï¼šå‘é‡å»é‡ï¼Œä¿ç•™ 31 ç¯‡å”¯ä¸€æ–‡ç« </li>
<li>âœ… <strong>Summarizer</strong>ï¼šAI æ‘˜è¦ç”Ÿæˆï¼Œä½¿ç”¨ 10,681 tokens</li>
<li>âœ… <strong>Writer</strong>ï¼šç”Ÿæˆ 188 è¡Œ Markdownï¼ŒåŒ…å« 7 ä¸ªç§‘æŠ€åˆ†ç±»</li>
<li>âœ… <strong>Publisher</strong>ï¼šæˆåŠŸæäº¤å¹¶æ¨é€åˆ°åšå®¢ä»“åº“</li>
</ul>
<h3>æ–°é—»åˆ†ç±»ä½“ç³»</h3>
<p>ç³»ç»Ÿè‡ªåŠ¨å°†æ–°é—»å½’ç±»åˆ° 9 ä¸ªç§‘æŠ€é¢†åŸŸï¼š</p>
<ul>
<li>ğŸ¤– äººå·¥æ™ºèƒ½</li>
<li>ğŸ“± ç§»åŠ¨æŠ€æœ¯  </li>
<li>ğŸš— è‡ªåŠ¨é©¾é©¶</li>
<li>â˜ï¸ äº‘è®¡ç®—</li>
<li>ğŸ’¾ èŠ¯ç‰‡æŠ€æœ¯</li>
<li>ğŸ’° åˆ›ä¸šæŠ•èµ„</li>
<li>ğŸ”’ ç½‘ç»œå®‰å…¨</li>
<li>â›“ï¸ åŒºå—é“¾</li>
<li>ğŸ”¬ ç§‘å­¦ç ”ç©¶</li>
</ul>
<h3>è¾“å‡ºæ ¼å¼ç¤ºä¾‹</h3>
<pre><code class="language-markdown"><span class="line">---</span>
<span class="line">title: æ¯æ—¥æ–°é—»é€Ÿè§ˆ Â· 2025-07-26</span>
<span class="line">pubDate: &#39;2025-07-26&#39;</span>
<span class="line">description: 2025å¹´ï¼Œç¾å›½åŠå¯¼ä½“å¸‚åœºç»å†äº†é‡è¦å˜é©...</span>
<span class="line">tags: [News, Daily, èŠ¯ç‰‡æŠ€æœ¯, è‡ªåŠ¨é©¾é©¶, ç§»åŠ¨æŠ€æœ¯]</span>
<span class="line">layout: news</span>
<span class="line">---</span>
<span class="line"></span>
<span class="line">## èŠ¯ç‰‡æŠ€æœ¯</span>
<span class="line"></span>
<span class="line">- **A timeline of the US semiconductor market in 2025**</span>
<span class="line">  2025å¹´ï¼Œç¾å›½åŠå¯¼ä½“å¸‚åœºç»å†äº†é‡è¦å˜é©ï¼ŒåŒ…æ‹¬ä¼ ç»ŸåŠå¯¼ä½“å…¬å¸é¢†å¯¼å±‚çš„æ›´æ›¿ä»¥åŠèŠ¯ç‰‡å‡ºå£æ”¿ç­–çš„åå¤æ— å¸¸ã€‚</span>
<span class="line">  *æ ‡ç­¾ï¼šåŠå¯¼ä½“ Â· ç¾å›½å¸‚åœº Â· æ”¿ç­–å˜åŒ–*</span>
<span class="line">  [é˜…è¯»åŸæ–‡](https://techcrunch.com/2025/07/25/...) | æ¥æºï¼šTechCrunch</span>
<span class="line"></span>
<span class="line">## è‡ªåŠ¨é©¾é©¶</span>
<span class="line"></span>
<span class="line">- **Tesla is reportedly bringing robotaxi service to San Francisco**</span>
<span class="line">  ç‰¹æ–¯æ‹‰è®¡åˆ’åœ¨æ—§é‡‘å±±æ¨å‡ºé™é‡ç‰ˆè‡ªåŠ¨é©¾é©¶å‡ºç§Ÿè½¦æœåŠ¡ï¼Œä¸å¥¥æ–¯æ±€çš„æœåŠ¡ä¸åŒï¼Œæ­¤æ¬¡å°†æœ‰å‘˜å·¥ååœ¨é©¾é©¶åº§ä¸Šä»¥ç¡®ä¿å®‰å…¨ã€‚</span>
<span class="line">  *æ ‡ç­¾ï¼šç‰¹æ–¯æ‹‰ Â· è‡ªåŠ¨é©¾é©¶ Â· å‡ºç§Ÿè½¦æœåŠ¡*</span>
<span class="line">  [é˜…è¯»åŸæ–‡](https://techcrunch.com/2025/07/25/...) | æ¥æºï¼šTechCrunch</span></code></pre>
<h2>æœªæ¥è§„åˆ’</h2>
<ol>
<li><strong>æ›´æ™ºèƒ½çš„ä¿¡æºå‘ç°</strong>ï¼šè®©æœºå™¨äººè‡ªåŠ¨å‘ç°å’Œæ¨èæ–°çš„é«˜è´¨é‡æ–°é—»æº</li>
<li><strong>è¶‹åŠ¿åˆ†æä¸ä¸»é¢˜èšåˆ</strong>ï¼šè¯†åˆ«ç‰¹å®šæ—¶é—´æ®µå†…çš„çƒ­ç‚¹è¯é¢˜ï¼Œèšåˆç›¸å…³æ–‡ç« </li>
<li><strong>ç”¨æˆ·åé¦ˆé—­ç¯</strong>ï¼šæ”¶é›†ç”¨æˆ·åé¦ˆæ•°æ®ï¼Œç”¨äºå¾®è°ƒ AI æ¨¡å‹</li>
<li><strong>å¼€æºè®¡åˆ’</strong>ï¼šæ•´ç†ä»£ç åå¼€æºï¼Œè®©æ›´å¤šäººæ­å»ºè‡ªå·±çš„ AI æ–°é—»æœºå™¨äºº</li>
</ol>
<h2>æ€»ç»“</h2>
<p><code>astro-news-bot</code> æ˜¯ä¸€ä¸ª&quot;ç”¨æŠ€æœ¯è§£å†³è‡ªå·±é—®é¢˜&quot;çš„å…¸å‹é¡¹ç›®ã€‚å®ƒå°† AIã€è‡ªåŠ¨åŒ–è„šæœ¬ã€ç°ä»£ Web å¼€å‘æ¡†æ¶ï¼ˆAstroï¼‰å’Œ DevOps ç†å¿µï¼ˆGitOpsï¼‰æœ‰æœºç»“åˆï¼Œæ„å»ºäº†ä¸€ä¸ªå°è€Œç¾çš„è‡ªåŠ¨åŒ–ç³»ç»Ÿã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®ä¸ä»…è§£å†³äº†æˆ‘çš„ä¿¡æ¯è¿‡è½½é—®é¢˜ï¼Œä¹Ÿæ˜¯å®è·µ LLM åº”ç”¨ã€å‘é‡æ•°æ®åº“ã€GitOps ç­‰æ–°æŠ€æœ¯çš„ç»ä½³è¯•éªŒç”°ã€‚å¦‚æœä½ ä¹Ÿæƒ³æ„å»ºç±»ä¼¼çš„ç³»ç»Ÿï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™ä½ ä¸€äº›å¯å‘å’Œå‚è€ƒã€‚</p>
<p>å…³é”®æŠ€æœ¯æ ˆï¼š</p>
<ul>
<li><strong>åç«¯</strong>ï¼šPython + OpenAI API + SentenceTransformers</li>
<li><strong>å‰ç«¯</strong>ï¼šAstro + TypeScript + Content Collections</li>
<li><strong>éƒ¨ç½²</strong>ï¼šGitOps + Shell Scripts + Cron Jobs</li>
<li><strong>æ•°æ®</strong>ï¼šJSON + Markdown + Git</li>
</ul>
<p>æ•´ä¸ªç³»ç»Ÿä½“ç°äº†ç°ä»£ AI åº”ç”¨å¼€å‘çš„æœ€ä½³å®è·µï¼šæ¨¡å—åŒ–è®¾è®¡ã€å‘é‡åŒ–å¤„ç†ã€è‡ªåŠ¨åŒ–éƒ¨ç½²å’ŒæŒç»­è¿ç»´ã€‚</p>

    </article>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js"></script>
<script>
Prism.highlightAll();
document.querySelectorAll('article pre').forEach(pre => {
    const code = pre.querySelector('code');
    if (!code) return;
    const toolbar = document.createElement('div');
    toolbar.className = 'code-toolbar';
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.onclick = () => {
        navigator.clipboard.writeText(code.textContent).then(() => {
            btn.textContent = 'Copied!';
            btn.classList.add('copied');
            setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
        });
    };
    toolbar.appendChild(btn);
    pre.parentNode.insertBefore(toolbar, pre);
});
</script>
</body>
</html>