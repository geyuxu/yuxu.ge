<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong | Yuxu Ge</title>
    <style>
        :root { --black: #111; --off-white: #f4f4f4; --vermilion: #C41E3A; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--off-white); }
        a { color: var(--vermilion); text-decoration: none; }
        a:hover { opacity: 0.75; }
        .layout { min-height: 100vh; }
        .sidebar { position: fixed; top: 0; left: 0; width: 320px; height: 100vh; background: var(--black); color: var(--off-white); padding: 3rem 2rem; display: flex; flex-direction: column; justify-content: space-between; }
        .sidebar-top { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .avatar { display: block; width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--vermilion); margin-bottom: 1.5rem; overflow: hidden; }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }
        .sidebar h1 { font-size: 1.8rem; font-weight: 700; color: var(--off-white); }
        .title-role { font-size: 0.9rem; color: #888; margin-top: 0.25rem; }
        .contact-block { margin-top: 2.5rem; width: 100%; }
        .social-links { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; }
        .social-links a { display: flex; align-items: center; gap: 0.75rem; width: 160px; color: var(--off-white); opacity: 0.7; padding: 0.5rem 0.75rem; border-radius: 4px; font-size: 0.9rem; }
        .social-links a:hover { color: var(--vermilion); opacity: 1; }
        .social-links svg { width: 20px; height: 20px; }
        .social-links .orcid-link { font-size: 0.68rem; gap: 0.5rem; white-space: nowrap; }
        .sidebar-footer { text-align: center; font-size: 0.75rem; color: #555; }
        .content { margin-left: 320px; padding: 2rem 3rem; min-height: 100vh; display: flex; flex-direction: column; align-items: center; background: #000; }
        .back-link { display: inline-flex; font-size: 0.85rem; margin-bottom: 1rem; color: #aaa; align-self: flex-start; }
        .back-link:hover { color: #fff; }
        .game-header { width: 100%; max-width: 600px; display: flex; justify-content: space-around; align-items: center; margin-bottom: 1rem; color: white; font-family: 'Courier New', monospace; }
        .game-title { font-size: 2rem; color: #0f0; }
        .score { font-size: 3rem; color: #fff; }
        canvas { display: block; border: 4px solid #0f0; }
        .controls { margin-top: 1rem; display: flex; gap: 0.5rem; }
        button { padding: 0.75rem 1.5rem; font-size: 1rem; background: #0f0; color: #000; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-family: 'Courier New', monospace; }
        button:hover { background: #0c0; }
        .message { margin-top: 1rem; font-size: 1.25rem; font-weight: 600; color: #0f0; font-family: 'Courier New', monospace; }
        .instructions { margin-top: 1.5rem; color: #0f0; font-size: 0.9rem; text-align: center; font-family: 'Courier New', monospace; }
        @media (max-width: 900px) {
            .sidebar { position: relative; width: 100%; height: auto; padding: 2rem 1.5rem 1rem; }
            .social-links { flex-direction: row; flex-wrap: wrap; justify-content: center; }
            .social-links a { width: auto; padding: 0.5rem; font-size: 0; gap: 0; }
            .social-links svg { width: 24px; height: 24px; }
            .content { margin-left: 0; padding: 1.5rem 1rem; }
            canvas { max-width: 100%; height: auto; }
        }
    </style>
</head>
<body>
    <div class="layout">
        <aside class="sidebar" id="sidebar-content"></aside>
        <script src="/components/sidebar.js"></script>
        <main class="content">
            <a href="/games/" class="back-link">‚Üê Back to Games</a>
            <div class="game-header">
                <div class="score" id="player-score">0</div>
                <h1 class="game-title">PONG</h1>
                <div class="score" id="cpu-score">0</div>
            </div>
            <canvas id="game" width="600" height="400"></canvas>
            <div class="controls">
                <button onclick="startGame()">New Game</button>
            </div>
            <div class="message" id="message"></div>
            <div class="instructions">
                <strong>Controls:</strong> W/S or Arrow Up/Down to move paddle.<br>
                First to 5 points wins!
            </div>
        </main>
    </div>
    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const paddleW = 10, paddleH = 80, ballSize = 10;
        let playerY, cpuY, ballX, ballY, ballDX, ballDY, playerScore, cpuScore, gameRunning, animationId;

        function startGame() {
            cancelAnimationFrame(animationId);
            playerY = cpuY = (canvas.height - paddleH) / 2;
            resetBall();
            playerScore = cpuScore = 0;
            gameRunning = true;
            document.getElementById('player-score').textContent = '0';
            document.getElementById('cpu-score').textContent = '0';
            document.getElementById('message').textContent = '';
            loop();
        }

        function resetBall() {
            ballX = canvas.width / 2;
            ballY = canvas.height / 2;
            ballDX = 5 * (Math.random() > 0.5 ? 1 : -1);
            ballDY = (Math.random() - 0.5) * 6;
        }

        function draw() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            // Center line
            ctx.setLineDash([10, 10]);
            ctx.strokeStyle = '#0f0';
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);
            // Paddles
            ctx.fillStyle = '#0f0';
            ctx.fillRect(10, playerY, paddleW, paddleH);
            ctx.fillRect(canvas.width - 20, cpuY, paddleW, paddleH);
            // Ball
            ctx.fillRect(ballX - ballSize / 2, ballY - ballSize / 2, ballSize, ballSize);
        }

        function update() {
            // Ball movement
            ballX += ballDX;
            ballY += ballDY;
            // Top/bottom collision
            if (ballY - ballSize / 2 < 0 || ballY + ballSize / 2 > canvas.height) ballDY = -ballDY;
            // Player paddle collision
            if (ballX - ballSize / 2 < 20 && ballY > playerY && ballY < playerY + paddleH) {
                ballDX = Math.abs(ballDX) * 1.05;
                ballDY = ((ballY - (playerY + paddleH / 2)) / (paddleH / 2)) * 5;
            }
            // CPU paddle collision
            if (ballX + ballSize / 2 > canvas.width - 20 && ballY > cpuY && ballY < cpuY + paddleH) {
                ballDX = -Math.abs(ballDX) * 1.05;
                ballDY = ((ballY - (cpuY + paddleH / 2)) / (paddleH / 2)) * 5;
            }
            // Scoring
            if (ballX < 0) {
                cpuScore++;
                document.getElementById('cpu-score').textContent = cpuScore;
                if (cpuScore >= 5) { endGame('CPU Wins!'); return; }
                resetBall();
            }
            if (ballX > canvas.width) {
                playerScore++;
                document.getElementById('player-score').textContent = playerScore;
                if (playerScore >= 5) { endGame('You Win!'); return; }
                resetBall();
            }
            // CPU AI
            const cpuCenter = cpuY + paddleH / 2;
            if (cpuCenter < ballY - 20) cpuY += 4;
            else if (cpuCenter > ballY + 20) cpuY -= 4;
            cpuY = Math.max(0, Math.min(canvas.height - paddleH, cpuY));
        }

        function endGame(msg) {
            gameRunning = false;
            document.getElementById('message').textContent = msg;
        }

        function loop() {
            if (!gameRunning) return;
            update();
            draw();
            animationId = requestAnimationFrame(loop);
        }

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowUp' || e.key === 'w') playerY = Math.max(0, playerY - 20);
            if (e.key === 'ArrowDown' || e.key === 's') playerY = Math.min(canvas.height - paddleH, playerY + 20);
        });

        canvas.addEventListener('mousemove', e => {
            const rect = canvas.getBoundingClientRect();
            playerY = Math.max(0, Math.min(canvas.height - paddleH, e.clientY - rect.top - paddleH / 2));
        });

        startGame();
    </script>
</body>
</html>
