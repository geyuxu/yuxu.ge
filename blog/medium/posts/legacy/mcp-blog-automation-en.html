<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP-Blog: One-Command Astro Blog Deployment to GitHub Pages</title>
    <style>
        body { font-family: Georgia, serif; max-width: 700px; margin: 2rem auto; padding: 0 1rem; line-height: 1.7; color: #333; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        h2 { font-size: 1.4rem; margin-top: 2rem; }
        pre { background: #f4f4f4; padding: 1rem; overflow-x: auto; border-radius: 4px; }
        code { font-family: Menlo, Monaco, monospace; font-size: 0.9em; }
        p code { background: #f4f4f4; padding: 0.2em 0.4em; border-radius: 3px; }
        img { max-width: 100%; }
        blockquote { border-left: 3px solid #ddd; margin-left: 0; padding-left: 1rem; color: #666; }
        ul { padding-left: 1.5rem; }
        hr { border: none; border-top: 1px solid #ddd; margin: 2rem 0; }
        a { color: #1a8917; }
    </style>
</head>
<body>
<hr>
<h2>date: 2024-01-01
tags: [devops, mcp, astro, automation, github pages, devops]
legacy: true</h2>
<h1>MCP-Blog: One-Command Astro Blog Deployment to GitHub Pages</h1>
<ol>
<li>After writing a new post in my blog project <code>geyuxu.com</code></li>
<li>Run <code>git add .</code>, <code>git commit -m &quot;...&quot;</code>, and <code>git push</code> to push the source code to the main branch</li>
<li>Execute <code>npm run build</code> to generate static files in the <code>dist</code> directory</li>
<li>Push the contents of the <code>dist</code> directory to the <code>gh-pages</code> branch for deployment</li>
</ol>
<p>This process not only involves multiple commands but is also prone to issues, especially if the <code>dist</code> directory isn&#39;t managed correctly by Git. More importantly, I wanted a central &quot;management hub&quot; to handle tasks like this, rather than cluttering my project directories with various scripts.</p>
<p>This led me to create the <strong>MCP-Blog</strong> project. Its core goal is to: <strong>Automate the entire commit-and-deploy workflow for one project directory from a completely separate, dedicated management directory, using a single command.</strong></p>
<p>This approach solves two major pain points:</p>
<ol>
<li><strong>Operational Isolation</strong>: Separates management scripts from blog content, keeping the blog repository clean and focused</li>
<li><strong>Process Automation</strong>: Simplifies a multi-step process into a single action, reducing human error and increasing efficiency</li>
</ol>
<h2>2. Technical Architecture: The MCP Design Philosophy</h2>
<h3>What is MCP (Model Context Protocol)?</h3>
<p>The &quot;Model-Context Protocol&quot; (MCP) is not a public network protocol, but rather a <strong>command-line interaction specification</strong> I designed for this project. Its core philosophy is:</p>
<blockquote>
<p>Enable an independent execution script (Model) to understand and operate on a target project within a specific context (Context).</p>
</blockquote>
<p>In this project:</p>
<ul>
<li><strong>Model</strong>: Our <code>mcp-blog</code> project, which acts as the active executor</li>
<li><strong>Context</strong>: Our <code>geyuxu.com</code> blog project, which is the target being operated on</li>
<li><strong>Protocol</strong>: The command-line interface and script execution logic we define. For example, <code>./mcp.sh &quot;commit message&quot;</code> is an implementation of this protocol</li>
</ul>
<h3>Architecture Diagram</h3>
<p>The workflow is straightforward:</p>
<blockquote><code>+-----------+       +-------------------------+       +---------------------+       +----------------+</code><br>
<code>|           |       |                         |       |                     |       |                |</code><br>
<code>|   User    |------&gt;|  MCP Script (mcp.sh)    |------&gt;|  Astro Blog Project |------&gt;|  GitHub Repo   |</code><br>
<code>|           |       |                         |       | (geyuxu.com)        |       | (main/gh-pages)|</code><br>
<code>+-----------+       +-------------------------+       +---------------------+       +----------------+</code><br>
<code>      |                        |                                |                           |</code><br>
<code>      | 1. Provide commit msg  | 2. cd to blog directory       | 3. Git ops &amp; build       | 4. Deploy to Pages</code><br>
<code>      |                        | 4. Execute deploy commands     |                           |</code></blockquote><p>The key is how the <strong>MCP script</strong> effectively &quot;traverses&quot; into the <strong>Astro blog project</strong> directory to execute operations.</p>
<h2>3. Implementation Details: Building the Automation Tool</h2>
<p>Let&#39;s examine the core implementation. The entire project is driven by a single Shell script.</p>
<p><strong>Project Structure:</strong></p>
<blockquote><code>/Users/geyuxu/repo/blog/</code><br>
<code>â”œâ”€â”€ mcp-blog/         # MCP project</code><br>
<code>â”‚   â””â”€â”€ mcp.sh</code><br>
<code>â””â”€â”€ geyuxu.com/       # Astro blog project</code><br>
<code>    â”œâ”€â”€ src/</code><br>
<code>    â”œâ”€â”€ public/</code><br>
<code>    â”œâ”€â”€ package.json</code><br>
<code>    â””â”€â”€ ...</code></blockquote><h3>1. Core Script <code>mcp.sh</code></h3>
<p>This is the heart of our automation. It handles parameter reception, directory switching, command execution, and error handling.</p>
<blockquote><code>#!/bin/bash</code><br>
<code></code><br>
<code># Exit immediately on error</code><br>
<code>set -e</code><br>
<code></code><br>
<code># --- Configuration ---</code><br>
<code># Define MCP project path (where the script resides)</code><br>
<code>MCP_PROJECT_PATH=&quot;/Users/geyuxu/repo/blog/mcp-blog&quot;</code><br>
<code># ... (48 more lines)</code></blockquote>
<p><em>View full code: <a href="https://gist.github.com/geyuxu/f03c69bfd870b0367adad1a50443b1d3">GitHub Gist</a></em></p><h3>2. Key Technical Points</h3>
<ul>
<li><p><strong>Cross-directory Permission Management (<code>cd &quot;$BLOG_REPO_PATH&quot;</code>)</strong>:
This seemingly simple <code>cd</code> command is key to cross-directory operations. After the script starts, it first switches the current working directory to the blog project. This way, all subsequent <code>git</code> and <code>npm</code> commands execute as if they were run directly in the <code>geyuxu.com</code> directory, naturally gaining the &quot;context permissions&quot; to operate on that directory&#39;s files.</p>
</li>
<li><p><strong>Git Automation (<code>git add/commit/push</code>)</strong>:
The script handles source code commits using standard Git commands. Passing the commit message as the script&#39;s first parameter (<code>$1</code>) adds flexibility.</p>
</li>
<li><p><strong>Astro Integration (<code>npm run build</code>)</strong>:
Every Astro project has a <code>build</code> script defined in <code>package.json</code>. Our automation script calls it directly without concerning itself with the complex internal build process, achieving perfect decoupling.</p>
</li>
<li><p><strong>GitHub Pages Deployment (<code>npm run deploy</code>)</strong>:
To simplify deployment, I highly recommend using the <code>gh-pages</code> npm package.</p>
<p>First, install it in your <strong>Astro project (<code>geyuxu.com</code>)</strong>:</p>
<p><code>npm install gh-pages --save-dev</code></p><p>Then, add a <code>deploy</code> command to your <code>geyuxu.com/package.json</code> scripts:</p>
<blockquote><code>{</code><br>
<code>  &quot;scripts&quot;: {</code><br>
<code>    &quot;dev&quot;: &quot;astro dev&quot;,</code><br>
<code>    &quot;start&quot;: &quot;astro dev&quot;,</code><br>
<code>    &quot;build&quot;: &quot;astro build&quot;,</code><br>
<code>    &quot;preview&quot;: &quot;astro preview&quot;,</code><br>
<code>    &quot;astro&quot;: &quot;astro&quot;,</code><br>
<code>    &quot;deploy&quot;: &quot;gh-pages -d dist&quot; </code><br>
<code>  }</code><br>
<code>}</code></blockquote><p>The <code>gh-pages -d dist</code> command automatically pushes the <code>dist</code> directory contents to the <code>gh-pages</code> branch.</p>
</li>
</ul>
<h2>4. Usage Example: Running MCP-Blog</h2>
<p>Assuming you&#39;ve completed the above configuration, publishing a new blog post is now as simple as breathing.</p>
<ol>
<li><p><strong>Grant execution permissions to the script</strong> (only needed once):</p>
<blockquote><code>cd /Users/geyuxu/repo/blog/mcp-blog</code><br>
<code>chmod +x mcp.sh</code></blockquote></li>
<li><p><strong>One-command publishing</strong>:
After finishing your writing in <code>geyuxu.com</code>, open the terminal and run:</p>
<p><code>./mcp.sh &quot;feat: add new article about MCP-Blog&quot;</code></p></li>
</ol>
<p>Then, grab a coffee and watch the terminal automate everything:</p>
<blockquote><code>ðŸš€ MCP-Blog task starting...</code><br>
<code>=================================</code><br>
<code>ðŸ“‚ Entering blog repository: /Users/geyuxu/repo/blog/geyuxu.com</code><br>
<code>ðŸ”„ Syncing source code to main branch...</code><br>
<code>[main 1234567] feat: add new article about MCP-Blog</code><br>
<code> 1 file changed, 1 insertion(+)</code><br>
<code> ...</code><br>
<code>âœ… Source sync complete.</code><br>
<code># ... (14 more lines)</code></blockquote>
<p><em>View full code: <a href="https://gist.github.com/geyuxu/d5d1e705ce3b8820d35cbb831edbd904">GitHub Gist</a></em></p><p>A few minutes later, your new article will be live online.</p>
<h2>5. Summary and Future Directions</h2>
<p>The <strong>MCP-Blog</strong> project successfully automates the complex blog publishing workflow through a simple Shell script, achieving:</p>
<ul>
<li><strong>Efficiency Boost</strong>: Reduces 5-6 steps to a single command</li>
<li><strong>Error Reduction</strong>: Automated operations prevent manual omissions or mistakes</li>
<li><strong>Clean Code</strong>: Separates management logic from business logic (blog content)</li>
</ul>
<p><strong>Future exploration directions:</strong></p>
<ol>
<li><strong>Feature Enhancement</strong>: Add a command to create new articles, e.g., <code>./mcp.sh new &quot;Article Title&quot;</code>, which automatically generates a Markdown template with frontmatter</li>
<li><strong>Platform Upgrade</strong>: Upgrade from Shell script to a more robust Node.js or Python CLI tool with richer interaction and error handling</li>
<li><strong>CI/CD Integration</strong>: While local scripts are convenient, the ultimate automation solution is migrating to GitHub Actions. When the <code>main</code> branch receives new pushes, it automatically triggers the build and deployment workflow</li>
</ol>
<p>I hope this small project inspires you. Automation is second nature to us engineersâ€”by delegating repetitive work to machines, we can focus on creating more valuable content.</p>

</body>
</html>