<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unveiling Project Nighthawks: Building the Next-Generation AI-Powered Task Scheduler | Yuxu Ge</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        :root {
            --black: #111;
            --dark-grey: #444;
            --off-white: #f4f4f4;
            --vermilion: #C41E3A;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--black);
            background-color: var(--off-white);
        }

        a { color: var(--vermilion); text-decoration: none; }
        a:hover { opacity: 0.75; }

        .layout { min-height: 100vh; }

        /* Sidebar */
        .sidebar {
            position: fixed; top: 0; left: 0;
            width: 320px; height: 100vh;
            background: var(--black); color: var(--off-white);
            padding: 3rem 2rem;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .sidebar-top { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .avatar { display: block; width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--vermilion); margin-bottom: 1.5rem; overflow: hidden; transition: transform 0.2s ease; }
        .avatar:hover { opacity: 1; transform: scale(1.05); }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }
        .name-block { margin-bottom: 0.5rem; }
        h1 { font-size: 1.8rem; font-weight: 700; letter-spacing: 1px; color: var(--off-white); }
        .title-role { font-size: 0.9rem; color: #888; margin-top: 0.25rem; font-weight: 400; }
        .contact-block { margin-top: 2.5rem; width: 100%; }
        .social-links { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; }
        .social-links a { display: flex; align-items: center; gap: 0.75rem; width: 160px; color: var(--off-white); opacity: 0.7; padding: 0.5rem 0.75rem; border-radius: 4px; font-size: 0.9rem; transition: all 0.2s; }
        .social-links a:hover { color: var(--vermilion); opacity: 1; background: rgba(255,255,255,0.05); }
        .social-links svg { width: 20px; height: 20px; flex-shrink: 0; }
        .social-links .orcid-link { font-size: 0.68rem; gap: 0.5rem; white-space: nowrap; }
        .sidebar-footer { text-align: center; font-size: 0.75rem; color: #555; }

        /* Content */
        .content { margin-left: 320px; padding: 3rem 4rem; max-width: 900px; }
        .back-link { display: inline-block; font-size: 0.85rem; margin-bottom: 2rem; color: var(--dark-grey); }
        .back-link:hover { color: var(--vermilion); }

        /* Article */
        article h1 { font-size: 2rem; font-weight: 700; margin-bottom: 1.5rem; line-height: 1.3; color: var(--black); }
        article h2 { font-size: 1.4rem; font-weight: 600; margin: 2rem 0 1rem; color: var(--black); }
        article h3 { font-size: 1.1rem; font-weight: 600; margin: 1.5rem 0 0.75rem; color: var(--black); }
        article p { margin-bottom: 1rem; color: var(--dark-grey); }
        article ul, article ol { margin: 1rem 0 1rem 1.5rem; color: var(--dark-grey); }
        article li { margin-bottom: 0.5rem; }
        article strong { color: var(--black); }
        article code { font-family: "SF Mono", Monaco, monospace; font-size: 0.9em; background: #e8e8e8; padding: 0.15em 0.4em; border-radius: 3px; }
        article pre { margin: 1rem 0; border-radius: 6px; overflow-x: auto; background: #2d2d2d; padding: 1rem; }
        article pre code { background: none; padding: 0; font-size: 0.75em; white-space: pre !important; counter-reset: line; display: block; color: #ccc; }
        article pre code .line { counter-increment: line; }
        article pre code .line::before { content: counter(line); display: inline-block; width: 2.5em; margin-right: 1em; text-align: right; color: #666; user-select: none; }
        .code-toolbar { display: flex; justify-content: flex-start; padding: 0.35rem 0.5rem; background: #3a3a3a; border-radius: 6px 6px 0 0; }
        .code-toolbar + pre { margin-top: 0; border-radius: 0 0 6px 6px; }
        .copy-btn { padding: 0.2rem 0.5rem; font-size: 0.7rem; background: #555; color: #fff; border: none; border-radius: 3px; cursor: pointer; transition: all 0.2s; }
        .copy-btn:hover, .copy-btn:active { background: #777; }
        .copy-btn.copied { background: #2a2; }
        article blockquote { border-left: 3px solid var(--vermilion); padding-left: 1rem; margin: 1rem 0; color: #666; font-style: italic; }
        article hr { border: none; border-top: 1px solid #ddd; margin: 2rem 0; }
        article table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem; }
        article th, article td { border: 1px solid #ddd; padding: 0.5rem 0.75rem; text-align: left; }
        article th { background: #e8e8e8; font-weight: 600; }
        article img { max-width: 100%; height: auto; display: block; margin: 1.5rem 0; border-radius: 6px; }

        .loading { text-align: center; padding: 3rem; color: #888; }
        .error { color: var(--vermilion); }

        /* KaTeX math styles */
        .katex-display { overflow-x: auto; overflow-y: hidden; padding: 0.5rem 0; }
        .katex { font-size: 1.1em; }

        /* Responsive */
        @media (max-width: 900px) {
            .sidebar { position: relative; width: 100%; height: auto; padding: 2rem 1.5rem 1rem; }
            .social-links { flex-direction: row; flex-wrap: wrap; justify-content: center; }
            .social-links a, .social-links .orcid-link { width: auto; padding: 0.5rem; font-size: 0; gap: 0; }
            .social-links svg { width: 24px; height: 24px; }
            .social-links .hide-mobile { display: none; }
            .sidebar-footer { margin-top: 1rem; }
            .content { margin-left: 0; padding: 2rem 1rem; }
        }
        @media (max-width: 480px) {
            .sidebar { padding: 1.5rem 1rem 1rem; }
            .avatar { width: 80px; height: 80px; }
            h1 { font-size: 1.4rem; }
            article h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

<div class="layout">
    <aside class="sidebar" id="sidebar-content"></aside>
    <script src="/components/sidebar.js"></script>

    <main class="content">
        <a href="/blog/" class="back-link">‚Üê Back to Blog</a>
        <article>
<hr>
<h2>date: 2024-01-01
tags: [ai, ai, python, fastapi, system design, devops, openai]
legacy: true</h2>
<h1>Unveiling Project Nighthawks: Building the Next-Generation AI-Powered Task Scheduler</h1>
<ul>
<li><strong>ü§ñ AI-Driven Scheduling</strong>: Integrates OpenAI GPT and the Graphiti knowledge graph to achieve intelligent conversion from natural language to Cron expressions.</li>
<li><strong>üß† Context-Aware Execution</strong>: Task execution is no longer isolated; the system can remember historical execution patterns and optimize based on context.</li>
<li><strong>üèóÔ∏è Enterprise-Grade Architecture</strong>: Built on FastAPI with a microservices design, supporting high-availability, scalable production deployments with Docker and Kubernetes.</li>
<li><strong>üìä Comprehensive Observability</strong>: Deeply integrated with Prometheus and Grafana to provide full-stack monitoring from the application to the system level.</li>
<li><strong>üîí Multi-Layered Security</strong>: Offers comprehensive security mechanisms, including JWT, API keys, and role-based access control.</li>
</ul>
<h2>A Deep Dive into the System Architecture</h2>
<p>The architecture of Nighthawks is designed on principles of high availability, scalability, and security. Below is an overview of its layered architecture.</p>
<pre><code><span class="line"></span>
<span class="line">+--------------------------------+</span>
<span class="line">|        UI & Access Layer       |</span>
<span class="line">|  +-----------+   +-----------+ |</span>
<span class="line">|  |  Web UI   |-->| RESTful API | |</span>
<span class="line">|  +-----------+   +-----------+ |</span>
<span class="line">+--------------------------------+</span>
<span class="line">                 |</span>
<span class="line">                 v</span>
<span class="line">+--------------------------------+</span>
<span class="line">| Application Service Layer (FastAPI) |</span>
<span class="line">|  +-----------+                 |</span>
<span class="line">|  | Main App  |-----------------+</span>
<span class="line">|  +-----------+                 |</span>
<span class="line">|   | |   |   |                  |</span>
<span class="line">|   v v   v   v                  |</span>
<span class="line">| [Auth][Scheduler][NLP][Metrics]|</span>
<span class="line">+--------------------------------+</span>
<span class="line">    |      |      |      |</span>
<span class="line">    |      |      |      +------>[Prometheus]-->[Grafana]</span>
<span class="line">    |      |      |</span>
<span class="line">    |      |      +------------->[AI Layer: OpenAI, Graphiti]</span>
<span class="line">    |      |</span>
<span class="line">    |      +--------------------->[AI Agent]</span>
<span class="line">    |      +--------------------->[Execution Logs]</span>
<span class="line">    |</span>
<span class="line">    +---------------------------->[Data Storage: PostgreSQL, Redis]</span>
<span class="line"></span></code></pre>

<h3>Key Module Analysis</h3>
<ol>
<li><p><strong>Natural Language Processing (NLP) Module</strong>
This is the &quot;brain&quot; of the system. When a user inputs &quot;Generate and send the sales report every Friday at 5 PM,&quot; this module calls the OpenAI GPT model. It not only parses the Cron expression <code>0 17 * * 5</code> but also extracts the core task &quot;generate and send sales report&quot; as the execution directive for the AI Agent. Through carefully designed Prompt Engineering, we have achieved a parsing accuracy of over 95%.</p>
</li>
<li><p><strong>AI Agent and Knowledge Graph</strong>
Each task is executed by an independent AI Agent. Before execution, this Agent queries the <strong>Graphiti knowledge graph</strong> to retrieve relevant historical information, user preferences, or contextual data for the task. For example, if a previous report failed due to data source delays, the Agent might automatically learn to check the data source status before execution. This mechanism enables Nighthawks to have continuous learning and evolution capabilities.</p>
</li>
<li><p><strong>Task Scheduler (APScheduler)</strong>
We chose APScheduler as the underlying execution engine. It provides stable and reliable distributed task scheduling capabilities. The AI layer is responsible for &quot;deciding what to do and when,&quot; while the scheduler is responsible for &quot;executing on time.&quot;</p>
</li>
<li><p><strong>Data Model (SQLModel)</strong>
We use SQLModel to define our data structures. It combines the advantages of Pydantic and SQLAlchemy, providing type-safe ORM operations that significantly improve development efficiency and code robustness.</p>
</li>
</ol>
<h2>Technology Stack Highlights</h2>
<table>
<thead>
<tr>
<th>Tier</th>
<th>Technology Choice</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Web Framework</strong></td>
<td>FastAPI</td>
<td>Offers unparalleled performance and asynchronous support, making it the ideal choice for building high-performance APIs.</td>
</tr>
<tr>
<td><strong>AI Engine</strong></td>
<td>OpenAI GPT + Graphiti</td>
<td>GPT understands intent, and Graphiti retains knowledge. Together, they form a powerful intelligent core.</td>
</tr>
<tr>
<td><strong>Task Scheduling</strong></td>
<td>APScheduler</td>
<td>Mature, stable, and supports various triggers and distributed deployments.</td>
</tr>
<tr>
<td><strong>Containerization</strong></td>
<td>Docker + Kubernetes</td>
<td>Enables standardized deployment and management, with easy auto-scaling via HPA.</td>
</tr>
<tr>
<td><strong>Monitoring</strong></td>
<td>Prometheus + Grafana</td>
<td>Provides powerful observability, allowing us to gain real-time insights into system status and performance bottlenecks.</td>
</tr>
</tbody></table>
<h2>From Idea to Reality: A Usage Example</h2>
<p>Let&#39;s walk through a concrete example to see how Nighthawks works.</p>
<p><strong>1. User inputs a natural language command:</strong></p>
<pre><code class="language-bash"><span class="line">curl -X POST http://localhost:9527/api/v1/nlp/parse \</span>
<span class="line">  -d &#39;{&quot;text&quot;: &quot;Check server health and send an email notification every weekday at 9 AM&quot;}&#39;</span></code></pre>
<p><strong>2. Nighthawks&#39; AI parses the request:</strong></p>
<p>The system returns a structured task definition:</p>
<pre><code class="language-json"><span class="line">{</span>
<span class="line">  &quot;success&quot;: true,</span>
<span class="line">  &quot;task_name&quot;: &quot;Server Health Check&quot;,</span>
<span class="line">  &quot;cron_expression&quot;: &quot;0 9 * * 1-5&quot;,</span>
<span class="line">  &quot;agent_prompt&quot;: &quot;Check server health status and email the results to the administrator.&quot;,</span>
<span class="line">  &quot;confidence&quot;: 0.98</span>
<span class="line">}</span></code></pre>
<p><strong>3. Create and schedule the task:</strong></p>
<p>After user confirmation, the task is persisted to the database and scheduled by APScheduler.</p>
<p><strong>4. Task execution:</strong></p>
<p>At 9 AM every weekday, the scheduler triggers the corresponding AI Agent. The Agent first queries the knowledge graph and might discover that &quot;Server B had high CPU usage at 9 AM last week,&quot; so it prioritizes checking Server B. After completing the health check, it generates a report and sends it via email. All execution details, including token consumption and execution time, are logged for future optimization.</p>
<h2>Conclusion</h2>
<p>The Nighthawks project is more than just a technical exploration; it is a reflection on the future of automated work patterns. It demonstrates that by combining large language models, knowledge graphs, and traditional software engineering, we can create tools that are far more intelligent and user-friendly than ever before.</p>
<p>We believe that the software of the future will no longer be just a cold executor of instructions but an intelligent partner capable of understanding, learning, and collaborating efficiently with humans. Nighthawks is a solid step in this direction.</p>

    </article>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js"></script>
<script>
Prism.highlightAll();
document.querySelectorAll('article pre').forEach(pre => {
    const code = pre.querySelector('code');
    if (!code) return;
    const toolbar = document.createElement('div');
    toolbar.className = 'code-toolbar';
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.onclick = () => {
        navigator.clipboard.writeText(code.textContent).then(() => {
            btn.textContent = 'Copied!';
            btn.classList.add('copied');
            setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
        });
    };
    toolbar.appendChild(btn);
    pre.parentNode.insertBefore(toolbar, pre);
});
</script>
</body>
</html>