<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cassandra ç´¢å¼•é‡å»ºå®è·µ | Yuxu Ge</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        :root {
            --black: #111;
            --dark-grey: #444;
            --off-white: #f4f4f4;
            --vermilion: #C41E3A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--black);
            background-color: var(--off-white);
        }

        a {
            color: var(--vermilion);
            text-decoration: none;
        }

        a:hover {
            opacity: 0.75;
        }

        .layout {
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 320px;
            height: 100vh;
            background: var(--black);
            color: var(--off-white);
            padding: 3rem 2rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .sidebar-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .avatar {
            display: block;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid var(--vermilion);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .avatar:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .name-block {
            margin-bottom: 0.5rem;
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--off-white);
        }

        .title-role {
            font-size: 0.9rem;
            color: #888;
            margin-top: 0.25rem;
            font-weight: 400;
        }

        .contact-block {
            margin-top: 2.5rem;
            width: 100%;
        }

        .social-links {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .social-links a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 160px;
            color: var(--off-white);
            opacity: 0.7;
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .social-links a:hover {
            color: var(--vermilion);
            opacity: 1;
            background: rgba(255, 255, 255, 0.05);
        }

        .social-links svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .social-links .orcid-link {
            font-size: 0.68rem;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .sidebar-footer {
            text-align: center;
            font-size: 0.75rem;
            color: #555;
        }

        /* Content */
        .content {
            margin-left: 320px;
            padding: 3rem 4rem;
            max-width: calc(100vw - 320px - 8rem);
        }

        .back-link {
            display: inline-block;
            font-size: 0.85rem;
            margin-bottom: 2rem;
            color: var(--dark-grey);
        }

        .back-link:hover {
            color: var(--vermilion);
        }

        /* Article */
        article h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.3;
            color: var(--black);
        }

        article h2 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--black);
        }

        article h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 1.5rem 0 0.75rem;
            color: var(--black);
        }

        article p {
            margin-bottom: 1rem;
            color: var(--dark-grey);
        }

        article ul,
        article ol {
            margin: 1rem 0 1rem 1.5rem;
            color: var(--dark-grey);
        }

        article li {
            margin-bottom: 0.5rem;
        }

        article strong {
            color: var(--black);
        }

        article code {
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
            background: #e8e8e8;
            padding: 0.15em 0.4em;
            border-radius: 3px;
        }

        article pre {
            margin: 1rem 0;
            border-radius: 6px;
            overflow-x: auto;
            background: #2d2d2d;
            padding: 1rem;
        }

        article pre code {
            background: none;
            padding: 0;
            font-size: 0.75em;
            white-space: pre !important;
            counter-reset: line;
            display: block;
            color: #ccc;
        }

        article pre code .line {
            counter-increment: line;
        }

        article pre code .line::before {
            content: counter(line);
            display: inline-block;
            width: 2.5em;
            margin-right: 1em;
            text-align: right;
            color: #666;
            user-select: none;
        }

        .code-toolbar {
            display: flex;
            justify-content: flex-start;
            padding: 0.35rem 0.5rem;
            background: #3a3a3a;
            border-radius: 6px 6px 0 0;
        }

        .code-toolbar+pre {
            margin-top: 0;
            border-radius: 0 0 6px 6px;
        }

        .copy-btn {
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
            background: #555;
            color: #fff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-btn:hover,
        .copy-btn:active {
            background: #777;
        }

        .copy-btn.copied {
            background: #2a2;
        }

        article blockquote {
            border-left: 3px solid var(--vermilion);
            padding-left: 1rem;
            margin: 1rem 0;
            color: #666;
            font-style: italic;
        }

        article hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 2rem 0;
        }

        article table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        article th,
        article td {
            border: 1px solid #ddd;
            padding: 0.5rem 0.75rem;
            text-align: left;
        }

        article th {
            background: #e8e8e8;
            font-weight: 600;
        }

        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem 0;
            border-radius: 6px;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: #888;
        }

        .error {
            color: var(--vermilion);
        }

        /* Language Selector */
        .lang-selector {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 0.75rem 1rem;
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .lang-selector-label {
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .lang-selector-label svg {
            width: 16px;
            height: 16px;
        }

        .lang-select {
            padding: 0.4rem 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            min-width: 140px;
        }

        .lang-select:focus {
            outline: none;
            border-color: var(--vermilion);
        }

        .lang-status {
            font-size: 0.8rem;
            color: #888;
            margin-left: auto;
        }

        .lang-status.translating {
            color: var(--vermilion);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .lang-status.translating::before {
            content: '';
            width: 14px;
            height: 14px;
            border: 2px solid #f0f0f0;
            border-top-color: var(--vermilion);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .lang-status.cached {
            color: #4CAF50;
        }

        .lang-original-btn {
            padding: 0.35rem 0.6rem;
            font-size: 0.75rem;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            color: #666;
            transition: all 0.2s;
        }

        .lang-original-btn:hover {
            background: #e0e0e0;
            color: #333;
        }

        @media (max-width: 600px) {
            .lang-selector {
                flex-wrap: wrap;
            }
            .lang-status {
                width: 100%;
                margin-left: 0;
                margin-top: 0.5rem;
            }
        }

        /* KaTeX math styles */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0;
        }

        .katex {
            font-size: 1.1em;
        }

        /* Jupyter Notebook Styles */
        .notebook-container {
            margin-top: 1rem;
        }

        .notebook-download {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 1.5rem;
            background: var(--black);
            color: var(--off-white);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .notebook-download:hover {
            opacity: 0.8;
            color: var(--off-white);
        }

        .notebook-download svg {
            width: 16px;
            height: 16px;
        }

        .nb-cell {
            margin-bottom: 1.5rem;
        }

        .nb-cell-code .nb-source {
            background: #2d2d2d;
            border-radius: 6px;
            overflow-x: auto;
        }

        .nb-cell-code .nb-source pre {
            margin: 0;
            padding: 1rem;
            color: #ccc;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.85em;
        }

        .nb-cell-code .nb-source code {
            background: none;
            padding: 0;
        }

        .nb-output {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
        }

        .nb-output pre {
            margin: 0;
            padding: 0;
            background: transparent;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.85em;
            color: #222;
        }

        .nb-output img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0.5rem 0;
        }

        .nb-output table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .nb-output th,
        .nb-output td {
            border: 1px solid #ddd;
            padding: 0.5rem;
            text-align: left;
        }

        .nb-output th {
            background: #e8e8e8;
            font-weight: 600;
        }

        .nb-cell-markdown {
            padding: 0;
        }

        .nb-cell-markdown h1:first-child {
            margin-top: 0;
        }

        /* Document Download Button */
        .doc-download {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 1.5rem;
            background: var(--black);
            color: var(--off-white);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .doc-download:hover {
            opacity: 0.8;
            color: var(--off-white);
        }

        .doc-download svg {
            width: 16px;
            height: 16px;
        }

        /* PDF Viewer */
        .pdf-container {
            margin-top: 1rem;
        }

        .pdf-viewer {
            width: 100%;
            height: 80vh;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f5f5f5;
        }

        /* Text File Display */
        .text-container {
            margin-top: 1rem;
        }

        .text-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 1.5rem;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--dark-grey);
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Word Document Display */
        .word-container {
            margin-top: 1rem;
        }

        .word-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 2rem;
            line-height: 1.8;
            color: var(--dark-grey);
        }

        .word-content p {
            margin-bottom: 1rem;
        }

        .word-content h1,
        .word-content h2,
        .word-content h3 {
            color: var(--black);
            margin: 1.5rem 0 1rem;
        }

        .word-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .word-content th,
        .word-content td {
            border: 1px solid #ddd;
            padding: 0.5rem;
        }

        .word-content img {
            max-width: 100%;
            height: auto;
        }

        /* Excel Display */
        .excel-container {
            margin-top: 1rem;
        }

        .excel-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .excel-tab {
            padding: 0.5rem 1rem;
            background: #e8e8e8;
            border: none;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .excel-tab.active {
            background: #4CAF50;
            color: white;
        }

        .excel-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow-x: auto;
            max-height: 70vh;
            overflow-y: auto;
        }

        .excel-content table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .excel-content th,
        .excel-content td {
            border: 1px solid #ddd;
            padding: 0.4rem 0.6rem;
            text-align: left;
            white-space: nowrap;
        }

        .excel-content th {
            background: #f5f5f5;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .excel-content tr:nth-child(even) {
            background: #fafafa;
        }

        /* PowerPoint Display */
        .ppt-container {
            margin-top: 1rem;
        }

        .ppt-viewer {
            width: 100%;
            height: 80vh;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f5f5f5;
        }

        /* CSV Display (uses excel styles) */
        .csv-container {
            margin-top: 1rem;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                padding: 2rem 1.5rem 1rem;
            }

            .social-links {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }

            .social-links a,
            .social-links .orcid-link {
                width: auto;
                padding: 0.5rem;
                font-size: 0;
                gap: 0;
            }

            .social-links svg {
                width: 24px;
                height: 24px;
            }

            .social-links .hide-mobile {
                display: none;
            }

            .sidebar-footer {
                margin-top: 1rem;
            }

            .content {
                margin-left: 0;
                padding: 2rem 1rem;
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                padding: 1.5rem 1rem 1rem;
            }

            .avatar {
                width: 80px;
                height: 80px;
            }

            h1 {
                font-size: 1.4rem;
            }

            article h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>

    <div class="layout">
        <aside class="sidebar" id="sidebar-content"></aside>
        <script src="/components/sidebar.js?v=20260128"></script>

        <main class="content">
            <a href="/blog/" class="back-link">â† Back to Blog</a>

            <!-- Language Selector -->
            <div class="lang-selector" id="lang-selector" style="display: none;">
                <span class="lang-selector-label">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
                    </svg>
                    Language
                </span>
                <select class="lang-select" id="lang-select">
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                    <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                    <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃªs</option>
                    <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                    <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                </select>
                <button class="lang-original-btn" id="lang-original-btn" style="display: none;">Show Original</button>
                <span class="lang-status" id="lang-status"></span>
            </div>

            <article>
<hr>
<h2>date: 2022-04-01
tags: [search]
legacy: true</h2>
<h1>Cassandra ç´¢å¼•é‡å»ºå®è·µ</h1>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒCassandra äºŒçº§ç´¢å¼•å¹¶ä¸é€‚åˆæ‰€æœ‰æŸ¥è¯¢åœºæ™¯ã€‚å¦‚æœæ»¥ç”¨ï¼Œå¯èƒ½å¯¼è‡´å†™å…¥æ€§èƒ½ä¸‹é™ï¼ˆå› ä¸ºæ¯æ¬¡å†™å…¥è¿˜éœ€æ›´æ–°ç´¢å¼•è¡¨ï¼‰ï¼ŒæŸ¥è¯¢å»¶è¿Ÿå¢å¤§ï¼Œç”šè‡³ç»™é›†ç¾¤å¢åŠ è´Ÿæ‹…ã€‚åœ¨ Cassandra 3.x ä¸­ï¼Œå¼•å…¥äº† SAIï¼ˆStorage-Attached Indexingï¼‰ç­‰æ”¹è¿›çš„ç´¢å¼•æœºåˆ¶ï¼Œä½†ç»å…¸çš„äºŒçº§ç´¢å¼•ä»ç„¶è¢«å¹¿æ³›ä½¿ç”¨ã€‚ç†è§£å…¶å·¥ä½œåŸç†æœ‰åŠ©äºåˆ¤æ–­ä½•æ—¶è¯¥ä½¿ç”¨ç´¢å¼•ã€ä½•æ—¶åº”è€ƒè™‘å…¶ä»–æ–¹æ¡ˆã€‚</p>
<h2>ä¸ºä»€ä¹ˆéœ€è¦æ‰‹åŠ¨é‡å»ºç´¢å¼•</h2>
<p>ç†æƒ³æƒ…å†µä¸‹ï¼ŒCassandra çš„äºŒçº§ç´¢å¼•ä¼šéšç€æ•°æ®æ›´æ–°è‡ªåŠ¨ç»´æŠ¤ï¼Œä¸éœ€è¦é¢å¤–å¹²é¢„ã€‚ç„¶è€Œï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¯èƒ½å‡ºç°ç´¢å¼•å¼‚å¸¸æˆ–æ€§èƒ½é—®é¢˜ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¹²é¢„é‡å»ºç´¢å¼•ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„åŸå› ï¼š</p>
<ul>
<li>ç´¢å¼•ä¸ä¸€è‡´æˆ–æŸåï¼šç”±äºé›†ç¾¤æ•…éšœã€Bug æˆ–å…¶å®ƒå¼‚å¸¸æƒ…å†µï¼Œç´¢å¼•æ•°æ®å¯èƒ½ä¸å®é™…æ•°æ®ä¸åŒæ­¥ã€‚ä¾‹å¦‚ï¼ŒæŸäº›å†™å…¥åœ¨ç´¢å¼•è¡¨ä¸­æœªæ­£ç¡®è®°å½•ï¼Œå¯¼è‡´é€šè¿‡ç´¢å¼•æŸ¥è¯¢æ— æ³•æ‰¾åˆ°å®é™…å­˜åœ¨çš„æ•°æ®ï¼Œæˆ–è€…å·²ç»åˆ é™¤çš„æ•°æ®ä»é€šè¿‡ç´¢å¼•æŸ¥è¯¢å‡ºç°ã€‚è¿™ç§ç´¢å¼•æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µéœ€è¦é‡å»ºç´¢å¼•æ¥ä¿®å¤ã€‚</li>
<li>æ€§èƒ½ä¸‹é™ï¼šé•¿æ—¶é—´è¿è¡Œåï¼Œç´¢å¼•è¡¨å¯èƒ½ç§¯ç´¯å¤§é‡è¿‡æœŸæˆ–æ— æ•ˆæ¡ç›®ï¼ˆä¾‹å¦‚å¯¹åº”å·²åˆ é™¤æˆ–è¿‡æœŸçš„æ•°æ®ï¼‰ï¼Œä»è€Œå……æ–¥å¤§é‡å¢“ç¢‘ï¼ˆtombstoneï¼‰è®°å½•ï¼Œå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚å¦‚æœç´¢å¼•åˆ—ä¸Šçš„æ•°æ®åˆ†å¸ƒå‘ç”Ÿæ˜¾è‘—å˜åŒ–ï¼ˆä¾‹å¦‚å¤§é‡æ’å…¥åˆ é™¤ï¼‰ï¼Œç´¢å¼•çš„æŸ¥è¯¢æ•ˆç‡å¯èƒ½ä¸‹é™ã€‚è¿™æ—¶ï¼Œé‡æ–°ç´¢å¼•å¯ä»¥æ¸…ç†æ— æ•ˆæ•°æ®ã€å‹ç¼©ç´¢å¼•ç»“æ„ï¼Œä»è€Œæå‡æ€§èƒ½ã€‚</li>
<li>æ•°æ®æ‰¹é‡å¯¼å…¥æˆ–è¿ç§»ï¼šåœ¨é€šè¿‡ SSTable ç¦»çº¿å¯¼å…¥æ•°æ®ã€èŠ‚ç‚¹æ‰©å®¹/ç¼©å®¹æˆ–ç¾å¤‡æ•°æ®æ¢å¤ç­‰æ“ä½œåï¼ŒäºŒçº§ç´¢å¼•å¯èƒ½æ²¡æœ‰åŠæ—¶æ„å»ºå®Œå…¨ã€‚ä¾‹å¦‚ï¼Œå°†æŸèŠ‚ç‚¹æ•°æ®æ–‡ä»¶æ‹·è´æ¢å¤åˆ°æ–°é›†ç¾¤æ—¶ï¼Œç´¢å¼•æ•°æ®ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œéœ€è¦æ‰‹åŠ¨é‡å»ºç´¢å¼•ä»¥æ¶µç›–æ‰€æœ‰å¯¼å…¥çš„æ•°æ®ã€‚</li>
<li>ç´¢å¼•è®¾è®¡è°ƒæ•´ï¼šæœ‰æ—¶ä¸ºäº†ä¼˜åŒ–æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯èƒ½ä¿®æ”¹ç´¢å¼•ç­–ç•¥æˆ–åˆ—ã€‚åœ¨åˆ é™¤æ—§ç´¢å¼•ã€æ›´æ¢æ–°ç´¢å¼•æ—¶ï¼Œæ‰‹åŠ¨åˆ é™¤å’Œé‡å»ºç´¢å¼•æ˜¯å¿…è¦æ­¥éª¤ã€‚æ­¤å¤–ï¼ŒCassandra æä¾›äº† nodetool rebuild_index å‘½ä»¤ï¼Œå¯ä»¥åœ¨ä¸åˆ é™¤ç´¢å¼•å®šä¹‰çš„æƒ…å†µä¸‹é‡å»ºç´¢å¼•ï¼Œä½†åœ¨æŸäº›ç‰ˆæœ¬ä¸­å¯èƒ½ä¸ç¨³å®šã€‚æ‰€ä»¥ï¼Œåˆ é™¤åé‡æ–°åˆ›å»º often æ˜¯æ›´ç›´æ¥å¯é çš„åšæ³•ã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼Œå½“å‡ºç°ç´¢å¼•æ— æ³•æ­£å¸¸æœåŠ¡ï¼ˆæŸ¥è¯¢ç»“æœä¸æ­£ç¡®æˆ–è¶…æ—¶ï¼‰æˆ–è€…ç´¢å¼•æœ¬èº«å¯¼è‡´å†™å…¥/è¯»å–æ€§èƒ½æ˜¾è‘—ä¸‹é™æ—¶ï¼Œæ‰‹åŠ¨é‡å»ºç´¢å¼•æ˜¯ä¸€ç§æœ‰æ•ˆçš„ä¿®å¤æ‰‹æ®µã€‚</p>
<h2>ç´¢å¼•é‡å»ºçš„å®è·µæ­¥éª¤</h2>
<p>ä¸‹é¢ä»¥å®é™…æ¡ˆä¾‹ä¸ºèƒŒæ™¯ï¼Œä»‹ç» Cassandra äºŒçº§ç´¢å¼•é‡å»ºçš„ä¸€èˆ¬æ­¥éª¤å’Œå®è·µæ–¹æ³•ã€‚å‡è®¾æˆ‘ä»¬åœ¨ Keyspace keyspace_xxx çš„è¡¨ table_xxx ä¸Šæœ‰ä¸€ä¸ªç´¢å¼• index_xxxï¼Œç´¢å¼•ç›®æ ‡åˆ—ä¸º field_xxxã€‚è¿‘æœŸç›‘æ§å‘ç°ï¼Œé’ˆå¯¹è¯¥ç´¢å¼•åˆ—çš„æŸ¥è¯¢å‡ºç°å¼‚å¸¸ï¼ˆæŸ¥è¯¢ä¸åˆ°åº”æœ‰çš„æ•°æ®ï¼‰ï¼ŒåŒæ—¶å†™å…¥å»¶è¿Ÿå‡é«˜ï¼Œæ€€ç–‘ç´¢å¼•å‡ºç°é—®é¢˜ã€‚æˆ‘ä»¬è®¡åˆ’åœ¨ç»´æŠ¤æ—¶é—´çª—å¯¹å…¶è¿›è¡Œé‡å»ºã€‚å¤§ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h3>ç¡®è®¤ç´¢å¼•çŠ¶å†µ</h3>
<p>åœ¨åŠ¨æ‰‹ä¹‹å‰ï¼Œå…ˆè¯„ä¼°ç´¢å¼•çš„å½“å‰çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç™»å½•èŠ‚ç‚¹æœåŠ¡å™¨æ£€æŸ¥ç´¢å¼•æ–‡ä»¶å ç”¨çš„ç£ç›˜å¤§å°ï¼Œä»¥è¯„ä¼°ç´¢å¼•è§„æ¨¡ã€‚Cassandra çš„æ•°æ®ç›®å½•é€šå¸¸ä½äº <code>.../data/data/&lt;keyspace&gt;/&lt;table&gt; </code>ä¸‹ï¼Œå…¶ä¸­äºŒçº§ç´¢å¼•æ•°æ®ä¼šå­˜å‚¨åœ¨ç±»ä¼¼ <code>&lt;table&gt;.&lt;index_name&gt;</code> çš„å­ç›®å½•ä¸­ã€‚é€šè¿‡å¦‚ä¸‹ä¸€æ¡å‘½ä»¤å¯ä»¥æŸ¥çœ‹ç´¢å¼•ç›¸å…³ç›®å½•å¤§å°ï¼š</p>
<blockquote><code>cd /path/to/cassandra-data/data/data/keyspace_xxx</code><br>
<code>du -h --max-depth=1 | grep index_xxx</code></blockquote><p>å¦‚æœå‘ç°ç´¢å¼•æ•°æ®æ–‡ä»¶å¼‚å¸¸åºå¤§ï¼ˆä¾‹å¦‚æ•°åGBï¼‰ï¼Œæˆ–ä¸é¢„æœŸä¸ç¬¦ï¼Œè¯´æ˜ç´¢å¼•å¯èƒ½ç´¯ç§¯äº†å¤§é‡å†å²æ•°æ®ã€‚è¿™è¿›ä¸€æ­¥ä½è¯äº†éœ€è¦é‡å»ºç´¢å¼•çš„åˆ¤æ–­ã€‚</p>
<h3>é€šçŸ¥å¹¶åœæ­¢ç›¸å…³åº”ç”¨</h3>
<p>å› ä¸ºé‡å»ºç´¢å¼•éœ€è¦åˆ é™¤å¹¶é‡æ–°åˆ›å»ºç´¢å¼•ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ä¾èµ–è¯¥ç´¢å¼•çš„æŸ¥è¯¢å°†ä¸å¯ç”¨ã€‚ä¸ºé¿å…å½±å“ä¸šåŠ¡ï¼Œåº”è¯¥æå‰é€šçŸ¥ç›¸å…³æ–¹å¹¶åœ¨ç»´æŠ¤çª—å£æ‰§è¡Œã€‚å…³é—­æˆ–æš‚åœä½¿ç”¨è¯¥ç´¢å¼•çš„åº”ç”¨æœåŠ¡ï¼ˆä¾‹å¦‚æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ç›¸å…³çš„ service_xxx ç­‰å¾®æœåŠ¡ï¼‰ä»¥é¿å…åœ¨ç´¢å¼•é‡å»ºæœŸé—´æ”¶åˆ°é”™è¯¯æŸ¥è¯¢ç»“æœã€‚åŒæ—¶åœæ­¢å†™å…¥è¯¥è¡¨çš„æ•°æ®ä¹Ÿæœ‰åŠ©äºä¿è¯é‡å»ºæœŸé—´æ•°æ®ä¸€è‡´æ€§ï¼ˆè™½ç„¶Cassandraå…è®¸åœ¨çº¿é‡å»ºç´¢å¼•ï¼Œä½†é™é»˜æ•°æ®ç¯å¢ƒä¸‹æ“ä½œé£é™©æ›´ä½ï¼‰ã€‚</p>
<h3>è¿æ¥åˆ° Cassandra é›†ç¾¤</h3>
<p>ä½¿ç”¨ CQL å·¥å…·æˆ–é©±åŠ¨è¿æ¥åˆ° Cassandra æ‰§è¡Œç´¢å¼•é‡å»ºæ“ä½œã€‚å¯ä»¥é€šè¿‡ cqlsh è¿æ¥ï¼Œæˆ–è€…å¦‚ä¸‹ä¸€æ ·ä½¿ç”¨ Python Driver è„šæœ¬è¿æ¥ã€‚è¿™é‡Œä»¥ cqlsh ä¸ºä¾‹ï¼š</p>
<p><code>$ cqlsh 10.x.x.x    # è¿æ¥åˆ°é›†ç¾¤æŸèŠ‚ç‚¹çš„ CQL æ¥å£ï¼ŒIPå·²è„±æ•ä¸º10.x.x.x</code></p><p>è¿æ¥åï¼Œåˆ‡æ¢åˆ°ç›®æ ‡ Keyspaceï¼š</p>
<p><code>USE keyspace_xxx;</code></p><h3>å¤‡ä»½è¡¨æ¨¡å¼ï¼ˆå¯é€‰ï¼‰</h3>
<p>åœ¨åˆ é™¤ç´¢å¼•å‰ï¼Œå»ºè®®ä½¿ç”¨ DESCRIBE TABLE table_xxx; ä¿å­˜è¡¨çš„ schema å®šä¹‰ã€‚è¿™æœ‰åŠ©äºäº†è§£è¡¨ç»“æ„å’Œç´¢å¼•ä¿¡æ¯ï¼Œé˜²æ­¢è¯¯æ“ä½œã€‚å¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥å¤‡ä»½å½“å‰ç´¢å¼•çš„å®šä¹‰ã€‚</p>
<h3>åˆ é™¤ç´¢å¼•</h3>
<p>æ‰§è¡Œç´¢å¼•åˆ é™¤è¯­å¥ï¼Œå°†å¼‚å¸¸çš„ç´¢å¼•ç§»é™¤ï¼š</p>
<p><code>DROP INDEX IF EXISTS index_xxx;</code></p><p>ä½¿ç”¨ IF EXISTS å¯ä»¥é¿å…ç´¢å¼•ä¸å­˜åœ¨æ—¶çš„é”™è¯¯ã€‚åˆ é™¤ç´¢å¼•ä¼šä»ç³»ç»Ÿä¸­ç§»é™¤ç´¢å¼•çš„å…ƒæ•°æ®ï¼Œå¹¶è§¦å‘é›†ç¾¤å„èŠ‚ç‚¹åˆ æ‰æœ¬åœ°ç´¢å¼•æ•°æ®ï¼ˆè¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´æ¥æ¸…ç†ç£ç›˜ä¸Šçš„ç´¢å¼•SSTableæ–‡ä»¶ï¼‰ã€‚</p>
<h3>åˆ›å»ºç´¢å¼•</h3>
<p>ç¡®è®¤ç´¢å¼•å·²åˆ é™¤åï¼Œé‡æ–°åˆ›å»ºç´¢å¼•ï¼š</p>
<p><code>CREATE INDEX index_xxx ON table_xxx (field_xxx);</code></p><p>Cassandra ä¼šä¸ºå·²æœ‰çš„æ•°æ®å¼‚æ­¥é‡å»ºç´¢å¼•ã€‚åœ¨æˆ‘ä»¬æ¡ˆä¾‹ä¸­ï¼Œç´¢å¼•é‡å»ºå¼€å§‹åï¼Œé›†ç¾¤å„èŠ‚ç‚¹ä¼šæ‰«æè¡¨ table_xxx ä¸Šçš„ field_xxx åˆ—æ•°æ®å¹¶æ’å…¥ç´¢å¼•æ¡ç›®ã€‚è¿™ä¸ªè¿‡ç¨‹å¯¹å¤§è¡¨æ¥è¯´å¯èƒ½æ¯”è¾ƒè€—æ—¶ã€‚åœ¨é‡å»ºè¿‡ç¨‹ä¸­ï¼Œæ–°çš„ç´¢å¼•æŸ¥è¯¢å¯èƒ½ä»ç„¶æ— æ³•è¿”å›å®Œæ•´ç»“æœï¼Œç›´åˆ°é‡å»ºå®Œæˆã€‚</p>
<h3>ç›‘æ§é‡å»ºè¿›åº¦</h3>
<p>ç´¢å¼•åˆ›å»ºè¯­å¥æäº¤åï¼Œéœ€ç­‰å¾…ç´¢å¼•é‡å»ºå®Œæˆã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç›‘æ§ï¼š</p>
<ul>
<li>æ—¥å¿—è§‚å¯Ÿï¼šæ£€æŸ¥å„èŠ‚ç‚¹çš„ Cassandra æ—¥å¿—ï¼ˆsystem.logï¼‰ï¼Œæœç´¢å…³äºç´¢å¼•é‡å»ºçš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ Cassandra ä¼šè®°å½•ç´¢å¼•å»ºç«‹å®Œæˆçš„æ—¶é—´ç‚¹ã€‚æˆ‘ä»¬çš„å®è·µä¸­ï¼Œä»å¼€å§‹åˆ°ç´¢å¼•æ„å»ºå®Œæ¯•è€—æ—¶çº¦æ•°å°æ—¶ï¼Œéœ€è€å¿ƒç­‰å¾…ã€‚</li>
<li>ç›®å½•å¤§å°å˜åŒ–ï¼šå†æ¬¡æŸ¥çœ‹æ•°æ®ç›®å½•ä¸­ç´¢å¼•ç›®å½•çš„å¤§å°å¢é•¿æƒ…å†µã€‚å¦‚æœç´¢å¼•æ–‡ä»¶å¤§å°è¶‹äºç¨³å®šï¼Œä¸”æ¥è¿‘åŸè¡¨æ•°æ®ä½“é‡çš„é¢„æœŸæ¯”ä¾‹ï¼Œè¡¨æ˜é‡å»ºæ¥è¿‘å®Œæˆã€‚</li>
<li>æ€§èƒ½ç›‘æ§ï¼šé‡å»ºç´¢å¼•æœŸé—´ï¼ŒèŠ‚ç‚¹ CPU å’Œ IO å¯èƒ½æ˜¾è‘—å‡é«˜ã€‚å¾…è¿™äº›æŒ‡æ ‡æ¢å¤æ­£å¸¸æ°´å¹³ï¼Œä¹Ÿæš—ç¤ºé‡å»ºç»“æŸã€‚</li>
</ul>
<h3>éªŒè¯ç´¢å¼•</h3>
<p>ç´¢å¼•é‡å»ºå®Œæˆåï¼Œä½¿ç”¨æŸ¥è¯¢éªŒè¯ç´¢å¼•æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚å¯ä»¥ä½¿ç”¨ä¹‹å‰å­˜åœ¨çš„ä¸€äº›å®é™…å€¼è¿›è¡Œæµ‹è¯•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨è¡¨ table_xxx ä¸­å­˜åœ¨ä¸€æ¡è®°å½•ï¼Œå…¶ field_xxx å­—æ®µå€¼ä¸º &#39;some_value&#39;ï¼ˆè¿™é‡Œç”¨ç¤ºä¾‹å€¼ä»£æ›¿å®é™…å€¼ï¼‰ã€‚æˆ‘ä»¬å°è¯•ç”¨ç´¢å¼•åˆ—æ¥æŸ¥è¯¢å®ƒï¼š</p>
<blockquote><code>SELECT * </code><br>
<code>FROM table_xxx </code><br>
<code>WHERE field_xxx = &#039;some_value&#039; </code><br>
<code>LIMIT 1;</code></blockquote><p>å¦‚æœè¿”å›ç»“æœåŒ…å«è¯¥è®°å½•ï¼ˆæˆ–è‡³å°‘ä¸å†è¶…æ—¶ï¼‰ï¼Œè¯´æ˜ç´¢å¼•æŸ¥è¯¢åŠŸèƒ½æ¢å¤æ­£å¸¸ã€‚å¯¹äºæ•°å€¼ç±»å‹çš„å­—æ®µæŸ¥è¯¢æ—¶æ— éœ€åŠ å¼•å·ï¼Œè¿™é‡Œè¦æ ¹æ®å­—æ®µç±»å‹è°ƒæ•´æŸ¥è¯¢è¯­å¥ã€‚</p>
<h3>æ¢å¤åº”ç”¨æœåŠ¡</h3>
<p>ç¡®è®¤ç´¢å¼•åŠŸèƒ½æ¢å¤åï¼Œé‡æ–°å¯åŠ¨å…ˆå‰æš‚åœçš„åº”ç”¨æœåŠ¡ã€‚ä¾‹å¦‚ï¼š</p>
<blockquote><code># é‡å¯ç›¸å…³åº”ç”¨æœåŠ¡</code><br>
<code>$ cd /path/to/service_xxx1 &amp;&amp; sh startup.sh start</code><br>
<code>$ cd /path/to/service_xxx2 &amp;&amp; sh startup.sh start</code><br>
<code>$ cd /path/to/service_xxx3 &amp;&amp; sh startup.sh start</code></blockquote><p>è®©åº”ç”¨é‡æ–°ä¸ Cassandra å»ºç«‹è¿æ¥ï¼Œå¹¶éªŒè¯ä¸šåŠ¡æŸ¥è¯¢æ­£å¸¸ã€‚æ­¤æ—¶ç´¢å¼•é‡å»ºæµç¨‹å…¨éƒ¨å®Œæˆã€‚</p>
<p>ç»è¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæˆ‘ä»¬æˆåŠŸä¿®å¤å¹¶é‡å»ºäº† Cassandra çš„äºŒçº§ç´¢å¼• index_xxxã€‚åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬çš„ç´¢å¼•åœ¨ DROP æ—¶é‡Šæ”¾äº†å¤§é‡ç£ç›˜ç©ºé—´ï¼Œé‡å»ºåæŸ¥è¯¢æ¢å¤æ­£å¸¸ã€å†™å…¥æ€§èƒ½ä¹Ÿæœ‰æ‰€æ”¹å–„ã€‚è¿™å°è¯äº†æ‰‹åŠ¨é‡å»ºç´¢å¼•åœ¨è§£å†³ç´¢å¼•å¼‚å¸¸é—®é¢˜ä¸Šçš„æœ‰æ•ˆæ€§ã€‚</p>
<h2>Pythonç´¢å¼•é‡å»ºè‡ªåŠ¨åŒ–å°å·¥å…·</h2>
<p>ä¸Šè¿°è¿‡ç¨‹å¯ä»¥é€šè¿‡äººå·¥é€æ­¥æ‰§è¡Œï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶å·¥å…·åŒ–ï¼Œä»¥ä¾¿æ›´å¿«æ·ä¸”å¯é‡å¤åœ°å¯¹ç´¢å¼•è¿›è¡Œæ“ä½œã€‚ä¸‹é¢æä¾›ä¸€ä¸ªä½¿ç”¨ Python å’Œ DataStax Cassandra Driver (cassandra-driver) çš„å°å·¥å…·ç¤ºä¾‹ï¼Œç”¨äºè‡ªåŠ¨åŒ–åœ°è¿æ¥é›†ç¾¤å¹¶é‡å»ºæŒ‡å®šç´¢å¼•ã€‚è¿™ä¸ªè„šæœ¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å·¥ä½œï¼š</p>
<ul>
<li>è¿æ¥ Cassandra é›†ç¾¤ï¼ˆæ”¯æŒæŒ‡å®šèŠ‚ç‚¹åœ°å€åˆ—è¡¨ï¼‰ã€‚</li>
<li>åˆ é™¤æŒ‡å®šç´¢å¼•ï¼ˆè‹¥å­˜åœ¨ï¼‰ã€‚</li>
<li>åˆ›å»ºæŒ‡å®šç´¢å¼•ã€‚</li>
<li>ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨ç»™å®šçš„æµ‹è¯•å€¼æŸ¥è¯¢ç´¢å¼•åˆ—ï¼ŒéªŒè¯ç´¢å¼•æ˜¯å¦æœ‰æ•ˆã€‚</li>
</ul>
<p>åœ¨ä½¿ç”¨è¯¥è„šæœ¬ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²é€šè¿‡ pip install cassandra-driver å®‰è£… Cassandra Python é©±åŠ¨ï¼Œå¹¶æ ¹æ®éœ€è¦é…ç½®å¥½ Cassandra é›†ç¾¤çš„ç½‘ç»œè¿é€šæ€§å’Œè®¤è¯ä¿¡æ¯ï¼ˆå¦‚æœé›†ç¾¤å¯ç”¨äº†ç”¨æˆ·å/å¯†ç éªŒè¯ï¼Œéœ€è¦åœ¨ä»£ç ä¸­æ·»åŠ è®¤è¯æ”¯æŒï¼Œä¾‹å¦‚ä½¿ç”¨ PlainTextAuthProviderï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯è„šæœ¬æºç ï¼š</p>
<blockquote><code>#!/usr/bin/env python3</code><br>
<code># -*- coding: utf-8 -*-</code><br>
<code>&quot;&quot;&quot;</code><br>
<code>Cassandra äºŒçº§ç´¢å¼•é‡å»ºå·¥å…·</code><br>
<code>&quot;&quot;&quot;</code><br>
<code>import argparse</code><br>
<code>from cassandra.cluster import Cluster</code><br>
<code># å¦‚æœéœ€è¦è®¤è¯ï¼Œå¯å¯ç”¨ä»¥ä¸‹å¯¼å…¥å¹¶åœ¨ Cluster æ—¶åŠ å…¥ auth_provider</code><br>
<code># ... (50 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><p>ä¸Šè¿°è„šæœ¬é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦è¿æ¥çš„èŠ‚ç‚¹ã€Keyspaceã€è¡¨ã€åˆ—å’Œç´¢å¼•åç§°ï¼Œå¹¶æ‰§è¡Œé‡å»ºæ“ä½œã€‚æˆ‘ä»¬ä½¿ç”¨ DROP INDEX IF EXISTS ç¡®ä¿åœ¨ç´¢å¼•å­˜åœ¨æ—¶åˆ é™¤å®ƒï¼Œéšåç”¨ CREATE INDEX é‡å»ºã€‚cassandra-driver ä¼šç­‰å¾…é›†ç¾¤å…ƒæ•°æ®åŒæ­¥ï¼ˆSchema agreementï¼‰ï¼Œç¡®ä¿ç´¢å¼•åœ¨æ•´ä¸ªé›†ç¾¤ä¸­åˆ›å»ºã€‚æ³¨æ„ï¼šåˆ›å»ºç´¢å¼•ä¼šç«‹å³è¿”å›ï¼Œä½†ç´¢å¼•çš„æ•°æ®é‡å»ºåœ¨åå°å¼‚æ­¥è¿›è¡Œï¼Œå› æ­¤è„šæœ¬è¿”å›åç´¢å¼•å¯èƒ½è¿˜åœ¨æ„å»ºä¸­ï¼›å¦‚æœæ•°æ®é‡å¤§ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½æŸ¥è¯¢å‡ºç»“æœã€‚</p>
<p>åœ¨éªŒè¯ç¯èŠ‚ä¸­ï¼Œè‹¥æä¾›äº† --test-value å‚æ•°ï¼Œè„šæœ¬ä¼šä½¿ç”¨è¯¥å€¼å¯¹ç´¢å¼•åˆ—æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼ˆç­‰ä»·äº SELECT ... WHERE column = &#39;value&#39; LIMIT 1ï¼‰ï¼Œå¹¶è¾“å‡ºæ˜¯å¦æŸ¥æ‰¾åˆ°ç»“æœã€‚è¿™å¯ä»¥ç®€å•åœ°æ£€éªŒç´¢å¼•æŸ¥è¯¢æ˜¯å¦ç”Ÿæ•ˆã€‚ä½†éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ªéªŒè¯ä¾èµ–äºæä¾›çš„å€¼ç¡®å®å­˜åœ¨äºè¡¨ä¸­ã€‚å¦‚æœå€¼ä¸å­˜åœ¨æˆ–è€…ç´¢å¼•å°šæœªå®Œå…¨é‡å»ºï¼ŒæŸ¥è¯¢å¯èƒ½å¾—ä¸åˆ°ç»“æœã€‚</p>
<h2>ç¤ºä¾‹ï¼šä½¿ç”¨Pythonè„šæœ¬é‡å»ºç´¢å¼•</h2>
<p>å‡è®¾æˆ‘ä»¬å¸Œæœ›å¯¹å‰è¿°çš„ index_xxx ç´¢å¼•æ‰§è¡Œé‡å»ºï¼Œç´¢å¼•ç›®æ ‡åˆ— field_xxx æˆ‘ä»¬å·²çŸ¥å­˜åœ¨å€¼ &#39;some_value&#39; ç”¨äºæµ‹è¯•ã€‚é›†ç¾¤çš„æŸèŠ‚ç‚¹ IP ä¸º 10.x.x.xï¼ˆå·²è„±æ•ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼è¿è¡Œè„šæœ¬ï¼š</p>
<blockquote><code>$ python cass_rebuild_index.py \</code><br>
<code>    --hosts 10.x.x.x \</code><br>
<code>    --keyspace keyspace_xxx \</code><br>
<code>    --table table_xxx \</code><br>
<code>    --column field_xxx \</code><br>
<code>    --index index_xxx \</code><br>
<code>    --test-value some_value</code></blockquote><p>è¿è¡Œåï¼Œè„šæœ¬ä¼šä¾æ¬¡è¾“å‡ºè¿æ¥ä¿¡æ¯ã€ç´¢å¼•åˆ é™¤/åˆ›å»ºè¿›åº¦ä»¥åŠéªŒè¯ç»“æœã€‚ä¾‹å¦‚ï¼Œé¢„æœŸè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<blockquote><code>Connected to cluster at [&#039;10.x.x.x&#039;], keyspace keyspace_xxx  </code><br>
<code>Index index_xxx dropped (if existed).  </code><br>
<code>Index index_xxx created on table_xxx(field_xxx).  </code><br>
<code>Index query successful, found field_xxx = some_value.  </code><br>
<code>Index rebuild completed.  </code></blockquote><p>ä»è¾“å‡ºå¯ä»¥çœ‹åˆ°ç´¢å¼•å·²æˆåŠŸé‡å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡ç´¢å¼•æŸ¥è¯¢åˆ°æµ‹è¯•å€¼ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç•™æ„å®é™…é›†ç¾¤ä¸­ç´¢å¼•é‡å»ºçš„å®Œæˆæƒ…å†µã€‚å¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œè„šæœ¬å¯èƒ½åœ¨ç´¢å¼•å®Œå…¨å»ºå¥½ä¹‹å‰å°±è¿”å›äº†â€œæŸ¥è¯¢æˆåŠŸâ€ï¼ˆå› ä¸ºåˆšå¥½æµ‹è¯•å€¼æ‰€åœ¨çš„éƒ¨åˆ†å·²ç»å»ºç´¢å¼•å®Œæˆï¼‰ã€‚å¯¹äºç”Ÿäº§ç¯å¢ƒä¸­çš„å¤§å‹ç´¢å¼•ï¼Œå»ºè®®åœ¨è„šæœ¬æ‰§è¡Œåï¼Œé€šè¿‡ç›‘æ§æˆ–æ—¥å¿—è¿›ä¸€æ­¥ç¡®è®¤ç´¢å¼•é‡å»ºçš„å®Œæˆï¼Œç„¶åå†æ¢å¤ä¸šåŠ¡æµé‡ã€‚</p>
<h2>ç»“è®º</h2>
<p>åœ¨ Cassandra é›†ç¾¤ä¸­ï¼ŒäºŒçº§ç´¢å¼•çš„å¼‚å¸¸ä¿®å¤ä¸é‡å»ºæ˜¯ä¸€é¡¹éœ€è¦è°¨æ…å¯¹å¾…çš„ç»´æŠ¤æ“ä½œã€‚æœ¬æ–‡é€šè¿‡ä»‹ç» Cassandra å’ŒäºŒçº§ç´¢å¼•çš„åŸç†ï¼Œé˜è¿°äº†æ‰‹åŠ¨é‡å»ºç´¢å¼•çš„åŸå› å’Œé‡è¦æ€§ï¼Œå¹¶ç»™å‡ºäº†å®é™…æ“ä½œæ­¥éª¤å’Œè‡ªåŠ¨åŒ–è„šæœ¬ç¤ºä¾‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬åº”å°½é‡é¿å…äºŒçº§ç´¢å¼•å¤±æ•ˆæˆ–æ€§èƒ½é—®é¢˜çš„å‘ç”Ÿï¼Œä¾‹å¦‚åˆç†è¯„ä¼°ç´¢å¼•åˆ—çš„åŸºæ•°å’ŒæŸ¥è¯¢æ¨¡å¼ï¼Œå®šæœŸå…³æ³¨ç´¢å¼•ç›¸å…³çš„ç›‘æ§æŒ‡æ ‡ã€‚ä¸€æ—¦ç´¢å¼•å‡ºç°é—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šè¿°æµç¨‹é‡å»ºç´¢å¼•èƒ½å¤Ÿæœ‰æ•ˆæ¢å¤é›†ç¾¤çš„æŸ¥è¯¢èƒ½åŠ›ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé‡å»ºç´¢å¼•å¯¹é›†ç¾¤æœ‰ä¸€å®šæ€§èƒ½å½±å“ï¼Œåº”åœ¨ä¸šåŠ¡ä½è°·æœŸè¿›è¡Œï¼Œå¹¶åšå¥½åº”ç”¨åœæœºæˆ–æµé‡åˆ‡æ¢çš„å‡†å¤‡ã€‚</p>
<p>é€šè¿‡å¯¹ Cassandra ç´¢å¼•é‡å»ºå®è·µ çš„æ·±å…¥äº†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æ›´ä»å®¹åœ°åº”å¯¹åˆ†å¸ƒå¼æ•°æ®åº“è¿ç»´ä¸­çš„ç´¢å¼•æŒ‘æˆ˜ï¼Œä¿éšœæ•°æ®åº“æœåŠ¡çš„ç¨³å®šå¯é è¿è¡Œã€‚</p>

    </article>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js"></script>
<script>
Prism.highlightAll();
document.querySelectorAll('article pre').forEach(pre => {
    const code = pre.querySelector('code');
    if (!code) return;
    const toolbar = document.createElement('div');
    toolbar.className = 'code-toolbar';
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.onclick = () => {
        navigator.clipboard.writeText(code.textContent).then(() => {
            btn.textContent = 'Copied!';
            btn.classList.add('copied');
            setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
        });
    };
    toolbar.appendChild(btn);
    pre.parentNode.insertBefore(toolbar, pre);
});
</script>
</body>
</html>