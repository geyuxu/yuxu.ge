<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders | Yuxu Ge</title>
    <style>
        :root { --black: #111; --off-white: #f4f4f4; --vermilion: #C41E3A; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--off-white); }
        a { color: var(--vermilion); text-decoration: none; }
        a:hover { opacity: 0.75; }
        .layout { min-height: 100vh; }
        .sidebar { position: fixed; top: 0; left: 0; width: 320px; height: 100vh; background: var(--black); color: var(--off-white); padding: 3rem 2rem; display: flex; flex-direction: column; justify-content: space-between; }
        .sidebar-top { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .avatar { display: block; width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--vermilion); margin-bottom: 1.5rem; overflow: hidden; }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }
        .sidebar h1 { font-size: 1.8rem; font-weight: 700; color: var(--off-white); }
        .title-role { font-size: 0.9rem; color: #888; margin-top: 0.25rem; }
        .contact-block { margin-top: 2.5rem; width: 100%; }
        .social-links { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; }
        .social-links a { display: flex; align-items: center; gap: 0.75rem; width: 160px; color: var(--off-white); opacity: 0.7; padding: 0.5rem 0.75rem; border-radius: 4px; font-size: 0.9rem; }
        .social-links a:hover { color: var(--vermilion); opacity: 1; }
        .social-links svg { width: 20px; height: 20px; }
        .social-links .orcid-link { font-size: 0.68rem; gap: 0.5rem; white-space: nowrap; }
        .sidebar-footer { text-align: center; font-size: 0.75rem; color: #555; }
        .content { margin-left: 320px; padding: 2rem 3rem; min-height: 100vh; display: flex; flex-direction: column; align-items: center; background: #000; }
        .back-link { display: inline-flex; font-size: 0.85rem; margin-bottom: 1rem; color: #0f0; align-self: flex-start; }
        .back-link:hover { color: #fff; }
        .game-header { width: 100%; max-width: 500px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; font-family: 'Courier New', monospace; }
        .game-title { font-size: 1.5rem; color: #0f0; }
        .score-box { color: #0f0; font-size: 1.25rem; }
        canvas { display: block; border: 2px solid #0f0; }
        .controls { margin-top: 1rem; display: flex; gap: 0.5rem; }
        button { padding: 0.75rem 1.5rem; font-size: 1rem; background: #0f0; color: #000; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-family: 'Courier New', monospace; }
        button:hover { background: #0c0; }
        .message { margin-top: 1rem; font-size: 1.25rem; font-weight: 600; color: #0f0; font-family: 'Courier New', monospace; }
        .instructions { margin-top: 1.5rem; color: #0f0; font-size: 0.9rem; text-align: center; font-family: 'Courier New', monospace; }
        @media (max-width: 900px) {
            .sidebar { position: relative; width: 100%; height: auto; padding: 2rem 1.5rem 1rem; }
            .social-links { flex-direction: row; flex-wrap: wrap; justify-content: center; }
            .social-links a { width: auto; padding: 0.5rem; font-size: 0; gap: 0; }
            .social-links svg { width: 24px; height: 24px; }
            .content { margin-left: 0; padding: 1.5rem 1rem; }
            canvas { max-width: 100%; height: auto; }
        }
    </style>
</head>
<body>
    <div class="layout">
        <aside class="sidebar" id="sidebar-content"></aside>
        <script src="/components/sidebar.js"></script>
        <main class="content">
            <a href="/games/" class="back-link">← Back to Games</a>
            <div class="game-header">
                <h1 class="game-title">SPACE INVADERS</h1>
                <div class="score-box">SCORE: <span id="score">0</span></div>
                <div class="score-box">LIVES: <span id="lives">3</span></div>
            </div>
            <canvas id="game" width="500" height="400"></canvas>
            <div class="controls">
                <button onclick="startGame()">START</button>
            </div>
            <div class="message" id="message"></div>
            <div class="instructions">
                <strong>CONTROLS:</strong> ← → MOVE | SPACE SHOOT<br>
                Destroy all invaders before they reach you!
            </div>
        </main>
    </div>
    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const PLAYER_W = 40, PLAYER_H = 20;
        let player = { x: 230, y: 370 };
        let invaders = [], bullets = [], invaderBullets = [];
        let score = 0, lives = 3, gameRunning = false, animationId;
        let invaderDir = 1, invaderSpeed = 1, lastShot = 0;
        const keys = {};

        function createInvaders() {
            invaders = [];
            for (let r = 0; r < 4; r++) {
                for (let c = 0; c < 8; c++) {
                    invaders.push({ x: 60 + c * 50, y: 40 + r * 35, alive: true, type: r < 2 ? 0 : 1 });
                }
            }
        }

        function startGame() {
            cancelAnimationFrame(animationId);
            player = { x: 230, y: 370 };
            bullets = [];
            invaderBullets = [];
            score = 0;
            lives = 3;
            invaderDir = 1;
            invaderSpeed = 1;
            gameRunning = true;
            createInvaders();
            document.getElementById('score').textContent = '0';
            document.getElementById('lives').textContent = '3';
            document.getElementById('message').textContent = '';
            loop();
        }

        function draw() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            // Player
            ctx.fillStyle = '#0f0';
            ctx.fillRect(player.x, player.y, PLAYER_W, PLAYER_H);
            ctx.fillRect(player.x + 17, player.y - 8, 6, 8);
            // Invaders
            invaders.forEach(inv => {
                if (!inv.alive) return;
                ctx.fillStyle = inv.type === 0 ? '#ff0' : '#f0f';
                ctx.fillRect(inv.x, inv.y, 30, 20);
                ctx.fillStyle = '#000';
                ctx.fillRect(inv.x + 5, inv.y + 5, 5, 5);
                ctx.fillRect(inv.x + 20, inv.y + 5, 5, 5);
            });
            // Bullets
            ctx.fillStyle = '#0f0';
            bullets.forEach(b => ctx.fillRect(b.x, b.y, 3, 10));
            ctx.fillStyle = '#f00';
            invaderBullets.forEach(b => ctx.fillRect(b.x, b.y, 3, 10));
        }

        function update() {
            // Player movement
            if (keys['ArrowLeft'] && player.x > 0) player.x -= 5;
            if (keys['ArrowRight'] && player.x < canvas.width - PLAYER_W) player.x += 5;
            // Bullets
            bullets.forEach(b => b.y -= 8);
            bullets = bullets.filter(b => b.y > 0);
            invaderBullets.forEach(b => b.y += 4);
            invaderBullets = invaderBullets.filter(b => b.y < canvas.height);
            // Invader movement
            let moveDown = false;
            invaders.forEach(inv => {
                if (!inv.alive) return;
                if ((inv.x + 30 >= canvas.width && invaderDir > 0) || (inv.x <= 0 && invaderDir < 0)) {
                    moveDown = true;
                }
            });
            if (moveDown) {
                invaderDir *= -1;
                invaders.forEach(inv => { if (inv.alive) inv.y += 15; });
            }
            invaders.forEach(inv => { if (inv.alive) inv.x += invaderDir * invaderSpeed; });
            // Invader shooting
            if (Math.random() < 0.02) {
                const aliveInvaders = invaders.filter(i => i.alive);
                if (aliveInvaders.length) {
                    const shooter = aliveInvaders[Math.floor(Math.random() * aliveInvaders.length)];
                    invaderBullets.push({ x: shooter.x + 13, y: shooter.y + 20 });
                }
            }
            // Collision: bullet -> invader
            bullets.forEach((b, bi) => {
                invaders.forEach(inv => {
                    if (inv.alive && b.x > inv.x && b.x < inv.x + 30 && b.y > inv.y && b.y < inv.y + 20) {
                        inv.alive = false;
                        bullets.splice(bi, 1);
                        score += inv.type === 0 ? 20 : 10;
                        document.getElementById('score').textContent = score;
                    }
                });
            });
            // Collision: invader bullet -> player
            invaderBullets.forEach((b, bi) => {
                if (b.x > player.x && b.x < player.x + PLAYER_W && b.y > player.y && b.y < player.y + PLAYER_H) {
                    invaderBullets.splice(bi, 1);
                    lives--;
                    document.getElementById('lives').textContent = lives;
                    if (lives <= 0) endGame('GAME OVER');
                }
            });
            // Check win
            if (invaders.every(i => !i.alive)) {
                invaderSpeed += 0.5;
                createInvaders();
            }
            // Check lose
            if (invaders.some(i => i.alive && i.y + 20 >= player.y)) {
                endGame('GAME OVER');
            }
        }

        function endGame(msg) {
            gameRunning = false;
            document.getElementById('message').textContent = msg;
        }

        function loop() {
            if (!gameRunning) return;
            update();
            draw();
            animationId = requestAnimationFrame(loop);
        }

        document.addEventListener('keydown', e => {
            keys[e.key] = true;
            if (e.code === 'Space' && gameRunning) {
                e.preventDefault();
                const now = Date.now();
                if (now - lastShot > 250) {
                    bullets.push({ x: player.x + 18, y: player.y - 10 });
                    lastShot = now;
                }
            }
        });
        document.addEventListener('keyup', e => keys[e.key] = false);

        draw();
    </script>
</body>
</html>
