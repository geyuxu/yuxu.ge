<!DOCTYPE html><html lang="zh"> <head><!-- Global Metadata --><meta charset="utf-8"><!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">--><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"><link rel="shortcut icon" href="/favicon.png" type="image/png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Ge Yuxu • AI &#38; Engineering" href="https://geyuxu.com/rss.xml"><meta name="generator" content="Astro v5.5.6"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://geyuxu.com/blog/notes/20211012-%E6%89%B9%E9%87%8F%E8%A1%8C%E6%94%BF%E5%8C%BA%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"><!-- Primary Meta Tags --><title>批量行政区代码更新脚本实战笔记</title><meta name="title" content="批量行政区代码更新脚本实战笔记"><meta name="description"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://geyuxu.com/blog/notes/20211012-%E6%89%B9%E9%87%8F%E8%A1%8C%E6%94%BF%E5%8C%BA%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"><meta property="og:title" content="批量行政区代码更新脚本实战笔记"><meta property="og:description"><meta property="og:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://geyuxu.com/blog/notes/20211012-%E6%89%B9%E9%87%8F%E8%A1%8C%E6%94%BF%E5%8C%BA%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"><meta property="twitter:title" content="批量行政区代码更新脚本实战笔记"><meta property="twitter:description"><meta property="twitter:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><script src="/js/jquery-3.7.1.min.js"></script><script src="/js/copy-code-button.js" defer></script><!-- Dify Chatbot Configuration --><script>
 window.difyChatbotConfig = {
  token: 'VgrjCAto93bjE0MW',
  systemVariables: {
    // user_id: 'YOU CAN DEFINE USER ID HERE',
    // conversation_id: 'YOU CAN DEFINE CONVERSATION ID HERE, IT MUST BE A VALID UUID',
  },
  userVariables: {
    // avatar_url: 'YOU CAN DEFINE USER AVATAR URL HERE',
    // name: 'YOU CAN DEFINE USER NAME HERE',
  },
 }
</script><!-- Dify Chatbot Script --><script src="https://udify.app/embed.min.js" id="VgrjCAto93bjE0MW" defer>
</script><!-- Dify Chatbot Custom Styles --><script is:global>
	window.addEventListener('DOMContentLoaded', () => {
		$('.toc ol').css({
		'list-style': 'none',   // 隐藏 1. 2. 3.
		'margin': 0,
		'padding-left': 0,       // 可按需调整
		});
		$('.toc ol > li').css({
		'list-style': 'none',   // 隐藏 1. 2. 3.
		'padding-left': 10
		});
        $('.sidebar').append($('.toc'));
      });
	</script><link rel="stylesheet" href="/_astro/assets-slug_.BFPovWfH.css">
<style>a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#fff;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
.statement[data-astro-cid-uffxixac]{font-size:10px;color:gray}@media (max-width: 640px){.statement[data-astro-cid-uffxixac]{font-size:6px;color:gray}}
</style></head> <body> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <!--<h2><a href="/">{SITE_TITLE}</a></h2>--> <h2 data-astro-cid-3ef6ksr2><a style="padding-left:0;color:blue;" href="/" data-astro-cid-3ef6ksr2>Ge Yuxu<br data-astro-cid-3ef6ksr2>AI & Engineering</a></h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a>  <a href="/blog/1" class="active" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/series" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Series </a>  <a href="/projects" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Projects </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://github.com/geyuxu" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Ge Yuxu's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://www.linkedin.com/in/geyuxu/" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Ge Yuxu's LinkedIn profile</span> <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M20.447 20.452H17.2v-5.569c0-1.328-.025-3.039-1.852-3.039-1.853 0-2.136 1.447-2.136 2.942v5.666h-3.248V9h3.122v1.561h.045c.435-.823 1.498-1.688 3.083-1.688 3.295 0 3.903 2.17 3.903 4.989v6.59zM5.337 7.433a1.882 1.882 0 110-3.764 1.882 1.882 0 010 3.764zm1.626 13.019H3.708V9h3.255v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.226.792 24 1.771 24h20.451C23.2 24 24 23.226 24 22.271V1.729C24 .774 23.2 0 22.222 0z" data-astro-cid-3ef6ksr2></path> </svg> </a> <a href="mailto:ngzerone@hotmail.com" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Send email to Ge Yuxu</span> <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </nav> <!-- Microsoft Clarity --> <script type="text/javascript">
		(function(c,l,a,r,i,t,y){
			c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
			t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
			y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
		})(window, document, "clarity", "script", "rc2w96osp6");
	</script> </header>  <main class="page"> <!-- 左侧栏 --> <aside class="sidebar"> <div class="meta"> <b>批量行政区代码更新脚本实战笔记</b> <p><time datetime="2021-10-11T16:00:00.000Z"> 2021/10/12 00:00:00 </time></p>   </div> <hr> <br> </aside> <!-- 右侧正文区域（flex 居中） --> <div class="content-wrapper"> <article class="prose">  <nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#引言">引言</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#需求拆解">需求拆解</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#脚本生成思路">脚本生成思路</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#执行前校验">执行前校验</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#最佳执行姿势">最佳执行姿势</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#校验与回滚">校验与回滚</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#常见坑">常见坑</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#优化与扩展">优化与扩展</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#总结">总结</a></li></ol></nav><h2 id="引言"><a aria-hidden="true" tabindex="-1" href="#引言"><span class="icon icon-link"></span></a>引言</h2>
<ul>
<li>在门店中台长期运行过程中，行政区划代码（province / city / area）会因政府区划调整、数据迁移等原因出现旧码。</li>
<li>本次任务需要批量修正“非上海门店”的 <strong>area / city</strong> 字段，确保与国家行政区划最新版本保持一致。</li>
</ul>
<h2 id="需求拆解"><a aria-hidden="true" tabindex="-1" href="#需求拆解"><span class="icon icon-link"></span></a>需求拆解</h2>
<ul>
<li>找到所有需更新门店：通过业务报表 + 人工确认得到门店清单。</li>
<li>获取正确行政区编码：比对国家统计局最新区划发布表。</li>
<li>生成脚本并在生产库执行：保证幂等、安全、可回滚。</li>
</ul>
<h2 id="脚本生成思路"><a aria-hidden="true" tabindex="-1" href="#脚本生成思路"><span class="icon icon-link"></span></a>脚本生成思路</h2>
<ul>
<li>源数据整理至 CSV：<code>STORE_CODE,STORE_TYPE,OLD_AREA,NEW_AREA</code>。</li>
<li>使用简单 Python 模版批量输出：</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> csv, datetime</span></span>
<span class="line"><span style="color:#24292E">tpl </span><span style="color:#D73A49">=</span><span style="color:#032F62"> "update site_store set area = </span><span style="color:#005CC5">{new}</span><span style="color:#032F62"> where store_code = '</span><span style="color:#005CC5">{code}</span><span style="color:#032F62">' and store_type = '</span><span style="color:#005CC5">{typ}</span><span style="color:#032F62">';"</span></span>
<span class="line"><span style="color:#D73A49">with</span><span style="color:#005CC5"> open</span><span style="color:#24292E">(</span><span style="color:#032F62">'mapping.csv'</span><span style="color:#24292E">) </span><span style="color:#D73A49">as</span><span style="color:#24292E"> f, </span><span style="color:#005CC5">open</span><span style="color:#24292E">(</span><span style="color:#032F62">'update.sql'</span><span style="color:#24292E">,</span><span style="color:#032F62">'w'</span><span style="color:#24292E">) </span><span style="color:#D73A49">as</span><span style="color:#24292E"> out:</span></span>
<span class="line"><span style="color:#D73A49">    for</span><span style="color:#24292E"> row </span><span style="color:#D73A49">in</span><span style="color:#24292E"> csv.DictReader(f):</span></span>
<span class="line"><span style="color:#24292E">        out.write(tpl.format(</span><span style="color:#D73A49">**</span><span style="color:#24292E">row)</span><span style="color:#D73A49">+</span><span style="color:#032F62">'</span><span style="color:#005CC5">\n</span><span style="color:#032F62">'</span><span style="color:#24292E">)</span></span></code></pre>
<ul>
<li>模板优势：</li>
<li>可读性强，后期维护仅需修改 CSV。</li>
<li>支持追加其他字段（如 city）而无需改脚本主体。</li>
</ul>
<h2 id="执行前校验"><a aria-hidden="true" tabindex="-1" href="#执行前校验"><span class="icon icon-link"></span></a>执行前校验</h2>
<ul>
<li>
<p>备份：</p>
<ul>
<li>利用 <code>CREATE TABLE site_store_bak AS SELECT * FROM site_store WHERE store_code IN (...)</code> 备份受影响行。</li>
</ul>
</li>
<li>
<p>常量检查：</p>
<ul>
<li><code>SELECT COUNT(1) FROM site_store_bak</code> 与脚本行数一致。</li>
<li>编码有效性：通过 <code>sys_area</code> 字典表校验 <code>new_area</code> 均存在。</li>
</ul>
</li>
</ul>
<h2 id="最佳执行姿势"><a aria-hidden="true" tabindex="-1" href="#最佳执行姿势"><span class="icon icon-link"></span></a>最佳执行姿势</h2>
<ul>
<li>会话设置：</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#D73A49">SET</span><span style="color:#24292E"> SERVEROUTPUT </span><span style="color:#D73A49">ON</span></span>
<span class="line"><span style="color:#24292E">WHENEVER SQLERROR EXIT </span><span style="color:#005CC5">SQL</span><span style="color:#24292E">.</span><span style="color:#005CC5">SQLCODE</span></span></code></pre>
<ul>
<li>使用 <code>@update.sql</code> 执行，遇错即停。</li>
<li>分批提交：
<ul>
<li>每 500 条 COMMIT 一次，减少回滚体积。</li>
</ul>
</li>
</ul>
<h2 id="校验与回滚"><a aria-hidden="true" tabindex="-1" href="#校验与回滚"><span class="icon icon-link"></span></a>校验与回滚</h2>
<ul>
<li>
<p>快速校验：</p>
<ul>
<li><code>SELECT COUNT(*) WHERE area = new_area</code> 验证成功率。</li>
</ul>
</li>
<li>
<p>聚合对比：<code>SUM(old_area)</code> vs <code>SUM(new_area)</code>。</p>
</li>
<li>
<p>回滚方案：若发现误更新，使用 <code>MERGE</code> 将备份表写回原表。</p>
</li>
</ul>
<h2 id="常见坑"><a aria-hidden="true" tabindex="-1" href="#常见坑"><span class="icon icon-link"></span></a>常见坑</h2>
<ul>
<li><strong>行锁争抢</strong>：门店表被其他业务写入，可在夜间窗口操作。</li>
<li><strong>错误编码</strong>：脚本中若写错 <code>WHERE</code> 条件，可能更新全国门店。务必在测试库实测并 <code>EXPLAIN PLAN</code> 确认命中行。</li>
<li><strong>权限问题</strong>：生产执行需 DBA 协助，提前走变更流程。</li>
</ul>
<h2 id="优化与扩展"><a aria-hidden="true" tabindex="-1" href="#优化与扩展"><span class="icon icon-link"></span></a>优化与扩展</h2>
<ul>
<li>改用 <strong>MERGE INTO</strong> 一次完成：</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#D73A49">MERGE</span><span style="color:#D73A49"> INTO</span><span style="color:#24292E"> site_store s </span><span style="color:#D73A49">USING</span><span style="color:#24292E"> tmp_area_map m</span></span>
<span class="line"><span style="color:#D73A49">ON</span><span style="color:#24292E"> (</span><span style="color:#005CC5">s</span><span style="color:#24292E">.</span><span style="color:#005CC5">store_code</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> m</span><span style="color:#24292E">.</span><span style="color:#005CC5">store_code</span><span style="color:#D73A49"> AND</span><span style="color:#005CC5"> s</span><span style="color:#24292E">.</span><span style="color:#005CC5">store_type</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> m</span><span style="color:#24292E">.</span><span style="color:#005CC5">store_type</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#D73A49">WHEN</span><span style="color:#D73A49"> MATCHED</span><span style="color:#D73A49"> THEN</span><span style="color:#D73A49"> UPDATE</span><span style="color:#D73A49"> SET</span><span style="color:#005CC5"> s</span><span style="color:#24292E">.</span><span style="color:#005CC5">area</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> m</span><span style="color:#24292E">.</span><span style="color:#005CC5">new_area</span><span style="color:#24292E">;</span></span></code></pre>
<ul>
<li>加 <code>CHECK(area IN (SELECT id FROM sys_area))</code> 防止脏数据。</li>
<li>自动化校验：脚本执行完触发 Jenkins Job，对比异常差异并出报警。</li>
</ul>
<h2 id="总结"><a aria-hidden="true" tabindex="-1" href="#总结"><span class="icon icon-link"></span></a>总结</h2>
<ul>
<li>批量数据脚本需求看似简单，核心在于 <strong>生成可靠脚本</strong> + <strong>完善备份校验</strong>。</li>
<li>小型场景用单条 <code>UPDATE</code> 直观易读；大规模可考虑 <code>MERGE</code> 或 ETL 工具。</li>
<li>数据治理应在源头加约束，降低后期修补成本。</li>
</ul> <html lang="en" data-astro-cid-uffxixac> <head><!-- Global Metadata --><meta charset="utf-8"><!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">--><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"><link rel="shortcut icon" href="/favicon.png" type="image/png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Ge Yuxu • AI &#38; Engineering" href="https://geyuxu.com/rss.xml"><meta name="generator" content="Astro v5.5.6"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://geyuxu.com/blog/notes/20211012-%E6%89%B9%E9%87%8F%E8%A1%8C%E6%94%BF%E5%8C%BA%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"><!-- Primary Meta Tags --><title>Ge Yuxu • AI &amp; Engineering</title><meta name="title" content="Ge Yuxu • AI &#38; Engineering"><meta name="description" content="Welcome to my blog!"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://geyuxu.com/blog/notes/20211012-%E6%89%B9%E9%87%8F%E8%A1%8C%E6%94%BF%E5%8C%BA%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"><meta property="og:title" content="Ge Yuxu • AI &#38; Engineering"><meta property="og:description" content="Welcome to my blog!"><meta property="og:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://geyuxu.com/blog/notes/20211012-%E6%89%B9%E9%87%8F%E8%A1%8C%E6%94%BF%E5%8C%BA%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"><meta property="twitter:title" content="Ge Yuxu • AI &#38; Engineering"><meta property="twitter:description" content="Welcome to my blog!"><meta property="twitter:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><script src="/js/jquery-3.7.1.min.js"></script><script src="/js/copy-code-button.js" defer></script><!-- Dify Chatbot Configuration --><script>
 window.difyChatbotConfig = {
  token: 'VgrjCAto93bjE0MW',
  systemVariables: {
    // user_id: 'YOU CAN DEFINE USER ID HERE',
    // conversation_id: 'YOU CAN DEFINE CONVERSATION ID HERE, IT MUST BE A VALID UUID',
  },
  userVariables: {
    // avatar_url: 'YOU CAN DEFINE USER AVATAR URL HERE',
    // name: 'YOU CAN DEFINE USER NAME HERE',
  },
 }
</script><!-- Dify Chatbot Script --><script src="https://udify.app/embed.min.js" id="VgrjCAto93bjE0MW" defer>
</script><!-- Dify Chatbot Custom Styles --></head> <body data-astro-cid-uffxixac>  <div class="statement" data-astro-cid-uffxixac> <blockquote data-astro-cid-uffxixac> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>脱敏说明</strong>：本文所有出现的表名、字段名、接口地址、变量名、IP地址及示例数据等均非真实，仅用于阐述技术思路与实现步骤，示例代码亦非公司真实代码。示例方案亦非公司真实完整方案，仅为本人记忆总结，用于技术学习探讨。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;文中所示任何标识符并不对应实际生产环境中的名称或编号。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;示例&nbsp;SQL、脚本、代码及数据等均为演示用途，不含真实业务数据，也不具备直接运行或复现的完整上下文。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;读者若需在实际项目中参考本文方案，请结合自身业务场景及数据安全规范，使用符合内部命名和权限控制的配置。</p> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>Data Desensitization Notice</strong>: All table names, field names, API endpoints, variable names, IP addresses, and sample data appearing in this article are fictitious and intended solely to illustrate technical concepts and implementation steps. The sample code is not actual company code. The proposed solutions are not complete or actual company solutions but are summarized from the author's memory for technical learning and discussion.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;Any identifiers shown in the text do not correspond to names or numbers in any actual production environment.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;Sample SQL, scripts, code, and data are for demonstration purposes only, do not contain real business data, and lack the full context required for direct execution or reproduction.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;Readers who wish to reference the solutions in this article for actual projects should adapt them to their own business scenarios and data security standards, using configurations that comply with internal naming and access control policies.</p> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>版权声明</strong>：本文版权归原作者所有，未经作者事先书面许可，任何单位或个人不得以任何方式复制、转载、摘编或用于商业用途。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;若需非商业性引用或转载本文内容，请务必注明出处并保持内容完整。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;对因商业使用、篡改或不当引用本文内容所产生的法律纠纷，作者保留追究法律责任的权利。</p> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>Copyright Notice</strong>: The copyright of this article belongs to the original author. Without prior written permission from the author, no entity or individual may copy, reproduce, excerpt, or use it for commercial purposes in any way.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;For non-commercial citation or reproduction of this content, attribution must be given, and the integrity of the content must be maintained.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;The author reserves the right to pursue legal action against any legal disputes arising from the commercial use, alteration, or improper citation of this article's content.</p> <p data-astro-cid-uffxixac><em data-astro-cid-uffxixac>Copyright&nbsp;©&nbsp;1989–Present&nbsp;Ge&nbsp;Yuxu.&nbsp;All&nbsp;Rights&nbsp;Reserved.</em></p> </blockquote> </div></body></html>  </article> </div> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 All rights reserved.
</footer>  </body></html>