<!DOCTYPE html><html lang="zh"> <head><!-- Global Metadata --><meta charset="utf-8"><!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">--><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"><link rel="shortcut icon" href="/favicon.png" type="image/png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Ge Yuxu • AI &#38; Engineering" href="https://geyuxu.com/rss.xml"><meta name="generator" content="Astro v5.5.6"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://geyuxu.com/blog/ai/data-augmentation-underfitting-overfitting-zh/"><!-- Primary Meta Tags --><title>图像分类：数据稀缺、样本增强与欠拟合/过拟合</title><meta name="title" content="图像分类：数据稀缺、样本增强与欠拟合/过拟合"><meta name="description"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://geyuxu.com/blog/ai/data-augmentation-underfitting-overfitting-zh/"><meta property="og:title" content="图像分类：数据稀缺、样本增强与欠拟合/过拟合"><meta property="og:description"><meta property="og:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://geyuxu.com/blog/ai/data-augmentation-underfitting-overfitting-zh/"><meta property="twitter:title" content="图像分类：数据稀缺、样本增强与欠拟合/过拟合"><meta property="twitter:description"><meta property="twitter:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><script src="/js/jquery-3.7.1.min.js"></script><script src="/js/copy-code-button.js" defer></script><!-- Dify Chatbot Configuration --><script>
 window.difyChatbotConfig = {
  token: 'VgrjCAto93bjE0MW',
  systemVariables: {
    // user_id: 'YOU CAN DEFINE USER ID HERE',
    // conversation_id: 'YOU CAN DEFINE CONVERSATION ID HERE, IT MUST BE A VALID UUID',
  },
  userVariables: {
    // avatar_url: 'YOU CAN DEFINE USER AVATAR URL HERE',
    // name: 'YOU CAN DEFINE USER NAME HERE',
  },
 }
</script><!-- Dify Chatbot Script --><script src="https://udify.app/embed.min.js" id="VgrjCAto93bjE0MW" defer>
</script><!-- Dify Chatbot Custom Styles --><script is:global>
	window.addEventListener('DOMContentLoaded', () => {
		$('.toc ol').css({
		'list-style': 'none',   // 隐藏 1. 2. 3.
		'margin': 0,
		'padding-left': 0,       // 可按需调整
		});
		$('.toc ol > li').css({
		'list-style': 'none',   // 隐藏 1. 2. 3.
		'padding-left': 10
		});
        $('.sidebar').append($('.toc'));
      });
	</script><link rel="stylesheet" href="/_astro/assets-slug_.BFPovWfH.css">
<style>a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#fff;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
.statement[data-astro-cid-uffxixac]{font-size:10px;color:gray}@media (max-width: 640px){.statement[data-astro-cid-uffxixac]{font-size:6px;color:gray}}
</style></head> <body> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <!--<h2><a href="/">{SITE_TITLE}</a></h2>--> <h2 data-astro-cid-3ef6ksr2><a style="padding-left:0;color:blue;" href="/" data-astro-cid-3ef6ksr2>Ge Yuxu<br data-astro-cid-3ef6ksr2>AI & Engineering</a></h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a>  <a href="/blog/1" class="active" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/series" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Series </a>  <a href="/projects" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Projects </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://github.com/geyuxu" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Ge Yuxu's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://www.linkedin.com/in/geyuxu/" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Ge Yuxu's LinkedIn profile</span> <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M20.447 20.452H17.2v-5.569c0-1.328-.025-3.039-1.852-3.039-1.853 0-2.136 1.447-2.136 2.942v5.666h-3.248V9h3.122v1.561h.045c.435-.823 1.498-1.688 3.083-1.688 3.295 0 3.903 2.17 3.903 4.989v6.59zM5.337 7.433a1.882 1.882 0 110-3.764 1.882 1.882 0 010 3.764zm1.626 13.019H3.708V9h3.255v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.226.792 24 1.771 24h20.451C23.2 24 24 23.226 24 22.271V1.729C24 .774 23.2 0 22.222 0z" data-astro-cid-3ef6ksr2></path> </svg> </a> <a href="mailto:ngzerone@hotmail.com" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Send email to Ge Yuxu</span> <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </nav> <!-- Microsoft Clarity --> <script type="text/javascript">
		(function(c,l,a,r,i,t,y){
			c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
			t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
			y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
		})(window, document, "clarity", "script", "rc2w96osp6");
	</script> </header>  <main class="page"> <!-- 左侧栏 --> <aside class="sidebar"> <div class="meta"> <b>图像分类：数据稀缺、样本增强与欠拟合/过拟合</b> <p><time datetime="2025-07-25T08:21:00.000Z"> 2025/07/25 16:21:00 </time></p>   </div> <hr> <br> </aside> <!-- 右侧正文区域（flex 居中） --> <div class="content-wrapper"> <article class="prose">  <nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#1-前置背景">1. 前置背景</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#2-欠拟合与过拟合">2. 欠拟合与过拟合</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#3-数据稀缺下的样本增强">3. 数据稀缺下的样本增强</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#4-实践落地步骤-pytorch-示例">4. 实践落地步骤 (PyTorch 示例)</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#5-综合调优流程">5. 综合调优流程</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#6-常见坑--实用-tips">6. 常见坑 &#x26; 实用 Tips</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#7-结语与延伸">7. 结语与延伸</a></li></ol></nav><h3 id="1-前置背景"><a aria-hidden="true" tabindex="-1" href="#1-前置背景"><span class="icon icon-link"></span></a>1. 前置背景</h3>
<p>在许多专业领域，如医学影像分析、工业瑕疵检测或特定科研项目中，我们常常面临一个共同的挑战：小规模图像分类。与拥有数百万样本的公开数据集不同，这些场景的数据量可能只有几百或几千张，极其宝贵。</p>
<p>在这种数据稀缺的情况下，模型训练极易出现两种极端症状。最常见的是<strong>过拟合 (Over-fitting)</strong>，即模型过度学习了训练数据的细节和噪声，导致其在未见过的新数据上表现糟糕。偶尔，如果数据本身存在大量噪声，或者选用的模型过于简单，也可能出现<strong>欠拟合 (Under-fitting)</strong>，即模型未能充分捕捉到数据中潜在的规律。我们的核心任务，正是在有限的资源和开发成本下，通过一系列技术手段，有效提升模型的泛化性能。</p>
<h3 id="2-欠拟合与过拟合"><a aria-hidden="true" tabindex="-1" href="#2-欠拟合与过拟合"><span class="icon icon-link"></span></a>2. 欠拟合与过拟合</h3>
<p>为了对症下药，我们首先需要精准地理解、诊断并区分欠拟合与过拟合。它们是模型学习能力与数据复杂性之间失衡的两种表现。</p>








































<table><thead><tr><th align="left">维度</th><th align="left">欠拟合</th><th align="left">过拟合</th></tr></thead><tbody><tr><td align="left"><strong>定义</strong></td><td align="left">模型未捕获数据内在规律，表现为高偏差 (High Bias)。</td><td align="left">模型将训练数据中的噪声也当作规律来学习，表现为高方差 (High Variance)。</td></tr><tr><td align="left"><strong>训练曲线</strong></td><td align="left">训练集和验证集的损失（Loss）都比较高，且很早就收敛不再下降。</td><td align="left">训练集损失持续降低，但验证集损失在下降到某个点后开始回升，形成一个明显的“剪刀差”。</td></tr><tr><td align="left"><strong>直观比喻</strong></td><td align="left">试图用一条直线去拟合一条复杂的“S”形曲线。</td><td align="left">试图用一条曲线精确地穿过每一个训练数据点，形成一个“马蜂窝”状的复杂路径。</td></tr><tr><td align="left"><strong>触发条件</strong></td><td align="left">数据本身的复杂度远超模型的表达能力。</td><td align="left">模型的容量（复杂度）远超训练数据所包含的信息量。</td></tr><tr><td align="left"><strong>诊断方法</strong></td><td align="left">学习曲线平行上移；无论如何调参，模型的偏差（bias）都无法有效降低。</td><td align="left">训练集与验证集的准确率差距（Training/Validation Gap）通常大于5-10个百分点；模型对错误预测的置信度（confidence）异常高。</td></tr><tr><td align="left"><strong>缓解方案</strong></td><td align="left">① 增大模型容量（更深或更宽的网络）或增加特征。 <br> ② 延长训练时间或优化学习率等超参数。 <br> ③ 减少正则化强度。</td><td align="left">① <strong>数据增强</strong>或扩充数据集。 <br> ② 使用正则化（L1/L2、Dropout、早停）。 <br> ③ 简化模型结构。 <br> ④ 模型集成（Ensemble）或知识蒸馏（Distillation）。</td></tr></tbody></table>
<h3 id="3-数据稀缺下的样本增强"><a aria-hidden="true" tabindex="-1" href="#3-数据稀缺下的样本增强"><span class="icon icon-link"></span></a>3. 数据稀缺下的样本增强</h3>
<p>在所有解决过拟合的策略中，数据增强是最直接、最有效的方法之一。它通过对现有训练数据进行一系列随机变换，创造出更多样的、模型“未曾见过”的样本，从而在不增加标注成本的情况下，扩充了数据的信息量。</p>
<h4 id="31-几何变换"><a aria-hidden="true" tabindex="-1" href="#31-几何变换"><span class="icon icon-link"></span></a>3.1 几何变换</h4>
<p>这类变换模拟了物体在真实世界中可能出现的姿态、大小和位置变化。常用操作包括：随机旋转 (±15° to ±30°)、随机缩放 (0.8× to 1.2×) 和随机平移 (≤10% of image dimensions)。更复杂的变换如弹性扭曲 (Elastic Distortion) 和透视变换 (Perspective Transformation) 也能提供更强的泛化能力。</p>
<h4 id="32-像素级扰动"><a aria-hidden="true" tabindex="-1" href="#32-像素级扰动"><span class="icon icon-link"></span></a>3.2 像素级扰动</h4>
<p>这类变换旨在提高模型对图像质量变化的鲁棒性。例如，向图像中加入高斯噪声 (Gaussian Noise, e.g., σ=0.01-0.05 × 255) 或椒盐噪声 (Salt-and-Pepper Noise, e.g., ratio=0.3-0.5%)，以及应用高斯模糊 (GaussianBlur, kernel size=3 or 5) 或运动模糊 (MotionBlur)。</p>
<h4 id="33-颜色空间变换"><a aria-hidden="true" tabindex="-1" href="#33-颜色空间变换"><span class="icon icon-link"></span></a>3.3 颜色空间变换</h4>
<p>颜色空间的变换可以增强模型对光照、对比度和色彩变化的适应性。<code>ColorJitter</code> 是一个常用工具，它可以随机调整图像的亮度 (brightness)、对比度 (contrast) 和饱和度 (saturation)（例如，在 0.8-1.2 倍之间）。将图像转为灰度图再复制回三个通道，也是一种强制模型关注形状而非颜色的有效技巧。</p>
<h4 id="34-合成混合方法"><a aria-hidden="true" tabindex="-1" href="#34-合成混合方法"><span class="icon icon-link"></span></a>3.4 合成/混合方法</h4>
<p>近年来，将多张图片信息混合的增强方法变得非常流行，它们能创造出在真实世界中不存在但对模型正则化非常有益的样本。</p>





























<table><thead><tr><th align="left">方法</th><th align="left">核心思路</th><th align="left">推荐触发概率 (p)</th><th align="left">备注</th></tr></thead><tbody><tr><td align="left"><strong>Cutout/GridMask</strong></td><td align="left">在图像上随机挖去一个或多个矩形区域进行遮挡。</td><td align="left"><code>p=0.3</code></td><td align="left">在目标检测/分割任务中，需要注意避免遮挡到关键目标。</td></tr><tr><td align="left"><strong>Mixup</strong></td><td align="left">将两张图片的输入和标签按一个从Beta分布中采样的比例 (λ) 进行线性插值。</td><td align="left"><code>1.0</code> (作为一个独立的epoch)</td><td align="left">α=0.2 是一个常用的超参数。</td></tr><tr><td align="left"><strong>CutMix</strong></td><td align="left">从一张图片中随机剪下一个区域，粘贴到另一张图片上，并根据区域面积比例调整标签权重。</td><td align="left"><code>p=0.5</code></td><td align="left">α=1.0 是一个常用的超参数。</td></tr></tbody></table>
<h4 id="35-自动增强"><a aria-hidden="true" tabindex="-1" href="#35-自动增强"><span class="icon icon-link"></span></a>3.5 自动增强</h4>
<p>手动设计增强策略组合费时费力，因此自动增强应运而生。<strong>RandAugment</strong> 是一种简单高效的方法，它从一个预设的变换池中随机挑选 N 种变换，并以一个统一的强度 M 应用。对于小数据集，它通常能带来显著收益（如 N=2, M=9）。更复杂的 <strong>AutoAugment</strong> 使用强化学习来搜索最佳策略组合，但计算成本高昂。</p>
<h3 id="4-实践落地步骤-pytorch-示例"><a aria-hidden="true" tabindex="-1" href="#4-实践落地步骤-pytorch-示例"><span class="icon icon-link"></span></a>4. 实践落地步骤 (PyTorch 示例)</h3>
<p>下面我们展示如何在 PyTorch 中构建一个包含多种增强策略的 <code>transform</code> 流水线，并实现一个可插拔的 Mixup 功能。</p>
<h4 id="41-变换流水线"><a aria-hidden="true" tabindex="-1" href="#41-变换流水线"><span class="icon icon-link"></span></a>4.1 变换流水线</h4>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> torchvision.transforms </span><span style="color:#D73A49">as</span><span style="color:#24292E"> T</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> torch</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> numpy </span><span style="color:#D73A49">as</span><span style="color:#24292E"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 自定义一个椒盐噪声类</span></span>
<span class="line"><span style="color:#D73A49">class</span><span style="color:#6F42C1"> SaltPepperNoise</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#D73A49">    def</span><span style="color:#005CC5"> __init__</span><span style="color:#24292E">(self, ratio</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.003</span><span style="color:#24292E">):</span></span>
<span class="line"><span style="color:#005CC5">        self</span><span style="color:#24292E">.ratio </span><span style="color:#D73A49">=</span><span style="color:#24292E"> ratio</span></span>
<span class="line"><span style="color:#D73A49">    def</span><span style="color:#005CC5"> __call__</span><span style="color:#24292E">(self, img):</span></span>
<span class="line"><span style="color:#6A737D">        # ... (实现细节省略)</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#24292E"> img</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">train_tf </span><span style="color:#D73A49">=</span><span style="color:#24292E"> T.Compose([</span></span>
<span class="line"><span style="color:#24292E">    T.RandomResizedCrop(</span><span style="color:#005CC5">224</span><span style="color:#24292E">, </span><span style="color:#E36209">scale</span><span style="color:#D73A49">=</span><span style="color:#24292E">(</span><span style="color:#005CC5">0.8</span><span style="color:#24292E">, </span><span style="color:#005CC5">1.0</span><span style="color:#24292E">)),</span></span>
<span class="line"><span style="color:#24292E">    T.RandomHorizontalFlip(</span><span style="color:#E36209">p</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.5</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">    T.RandomRotation(</span><span style="color:#005CC5">20</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">    T.ColorJitter(</span><span style="color:#E36209">brightness</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.2</span><span style="color:#24292E">, </span><span style="color:#E36209">contrast</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.2</span><span style="color:#24292E">, </span><span style="color:#E36209">saturation</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.2</span><span style="color:#24292E">, </span><span style="color:#E36209">hue</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">    T.GaussianBlur(</span><span style="color:#E36209">kernel_size</span><span style="color:#D73A49">=</span><span style="color:#005CC5">5</span><span style="color:#24292E">, </span><span style="color:#E36209">sigma</span><span style="color:#D73A49">=</span><span style="color:#24292E">(</span><span style="color:#005CC5">0.1</span><span style="color:#24292E">, </span><span style="color:#005CC5">2.0</span><span style="color:#24292E">)),</span></span>
<span class="line"><span style="color:#6A737D">    # SaltPepperNoise(0.003), # 自定义变换</span></span>
<span class="line"><span style="color:#24292E">    T.ToTensor(),</span></span>
<span class="line"><span style="color:#24292E">    T.Normalize(</span><span style="color:#E36209">mean</span><span style="color:#D73A49">=</span><span style="color:#24292E">[</span><span style="color:#005CC5">0.485</span><span style="color:#24292E">, </span><span style="color:#005CC5">0.456</span><span style="color:#24292E">, </span><span style="color:#005CC5">0.406</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#E36209">                std</span><span style="color:#D73A49">=</span><span style="color:#24292E">[</span><span style="color:#005CC5">0.229</span><span style="color:#24292E">, </span><span style="color:#005CC5">0.224</span><span style="color:#24292E">, </span><span style="color:#005CC5">0.225</span><span style="color:#24292E">])</span></span>
<span class="line"><span style="color:#24292E">])</span></span></code></pre>
<p>这个流水线整合了多种几何和颜色变换。注意，<code>Normalize</code> 步骤通常放在最后，且其均值和标准差应基于预训练模型所使用的数据集（如 ImageNet）来设定。</p>
<h4 id="42-可插拔的-mixupcutmix"><a aria-hidden="true" tabindex="-1" href="#42-可插拔的-mixupcutmix"><span class="icon icon-link"></span></a>4.2 可插拔的 Mixup/CutMix</h4>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#D73A49">def</span><span style="color:#6F42C1"> mixup_data</span><span style="color:#24292E">(x, y, alpha</span><span style="color:#D73A49">=</span><span style="color:#005CC5">0.2</span><span style="color:#24292E">, use_cuda</span><span style="color:#D73A49">=</span><span style="color:#005CC5">True</span><span style="color:#24292E">):</span></span>
<span class="line"><span style="color:#032F62">    '''Returns mixed inputs, pairs of targets, and lambda'''</span></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> alpha </span><span style="color:#D73A49">></span><span style="color:#005CC5"> 0</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">        lam </span><span style="color:#D73A49">=</span><span style="color:#24292E"> np.random.beta(alpha, alpha)</span></span>
<span class="line"><span style="color:#D73A49">    else</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">        lam </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    batch_size </span><span style="color:#D73A49">=</span><span style="color:#24292E"> x.size()[</span><span style="color:#005CC5">0</span><span style="color:#24292E">]</span></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> use_cuda:</span></span>
<span class="line"><span style="color:#24292E">        index </span><span style="color:#D73A49">=</span><span style="color:#24292E"> torch.randperm(batch_size).cuda()</span></span>
<span class="line"><span style="color:#D73A49">    else</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">        index </span><span style="color:#D73A49">=</span><span style="color:#24292E"> torch.randperm(batch_size)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    mixed_x </span><span style="color:#D73A49">=</span><span style="color:#24292E"> lam </span><span style="color:#D73A49">*</span><span style="color:#24292E"> x </span><span style="color:#D73A49">+</span><span style="color:#24292E"> (</span><span style="color:#005CC5">1</span><span style="color:#D73A49"> -</span><span style="color:#24292E"> lam) </span><span style="color:#D73A49">*</span><span style="color:#24292E"> x[index, :]</span></span>
<span class="line"><span style="color:#24292E">    y_a, y_b </span><span style="color:#D73A49">=</span><span style="color:#24292E"> y, y[index]</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> mixed_x, y_a, y_b, lam</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">def</span><span style="color:#6F42C1"> mixup_criterion</span><span style="color:#24292E">(criterion, pred, y_a, y_b, lam):</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> lam </span><span style="color:#D73A49">*</span><span style="color:#24292E"> criterion(pred, y_a) </span><span style="color:#D73A49">+</span><span style="color:#24292E"> (</span><span style="color:#005CC5">1</span><span style="color:#D73A49"> -</span><span style="color:#24292E"> lam) </span><span style="color:#D73A49">*</span><span style="color:#24292E"> criterion(pred, y_b)</span></span></code></pre>
<p>在训练循环中，你可以从 DataLoader 中取出 <code>inputs</code> 和 <code>targets</code>，调用 <code>mixup_data</code> 生成混合数据，然后用 <code>mixup_criterion</code> 计算混合后的损失。</p>
<h4 id="43-学习曲线监控"><a aria-hidden="true" tabindex="-1" href="#43-学习曲线监控"><span class="icon icon-link"></span></a>4.3 学习曲线监控</h4>
<p>在整个训练过程中，必须持续监控训练集和验证集的准确率与损失曲线。一个关键的实践是<strong>早停 (Early Stopping)</strong>：当验证集损失连续 N 个周期（epoch）不再下降反而上升时，就应停止训练，并保存之前验证性能最好的模型权重。这能有效防止模型在训练后期陷入过拟合。</p>
<h3 id="5-综合调优流程"><a aria-hidden="true" tabindex="-1" href="#5-综合调优流程"><span class="icon icon-link"></span></a>5. 综合调优流程</h3>
<p>一个系统性的调优流程可以帮助你最大化数据增强的效果：</p>
<ol>
<li><strong>建立基线</strong>: 首先在没有任何数据增强的情况下训练模型，记录其准确率和损失作为基准。</li>
<li><strong>阶段一</strong>: 加入基础的几何和颜色变换，学习率可以保持不变或适当调大。</li>
<li><strong>阶段二</strong>: 引入 Mixup 或 CutMix，通常需要配合标签平滑 (Label Smoothing) 来获得更好效果。</li>
<li><strong>阶段三</strong>: 如果计算资源允许，尝试使用 RandAugment 或 AutoAugment 来自动搜索最佳的增强策略组合。</li>
<li><strong>阶段四</strong>: 最后，根据增强后的数据分布，微调模型的容量（如网络深度）和正则化参数（如 Dropout 率、权重衰减 weight decay）。</li>
</ol>
<h3 id="6-常见坑--实用-tips"><a aria-hidden="true" tabindex="-1" href="#6-常见坑--实用-tips"><span class="icon icon-link"></span></a>6. 常见坑 &#x26; 实用 Tips</h3>
<ul>
<li><strong>过度增强</strong>: 过强的增强可能会使训练集分布与真实测试集分布产生严重漂移，反而损害性能。建议从一个较小的应用概率（如 <code>p=0.3</code>）开始试水。</li>
<li><strong>标签同步</strong>: 在目标检测或语义分割任务中，对图像进行几何变换时，必须对边界框 (bounding box) 或掩码 (mask) 执行完全相同的变换。</li>
<li><strong>验证集纯净度</strong>: 验证集应尽可能保持“干净”，以真实反映模型在原始数据分布上的性能。通常只对其进行必要的缩放 (Resize) 和中心裁剪 (Center Crop)，不做“重口味”的增强。</li>
<li><strong>小批量 Mixup</strong>: 在批量大小 (batch size) 很小的情况下使用 Mixup，可能会过度稀释原始信号。此时应考虑适当增大批量或调整学习率。</li>
</ul>
<h3 id="7-结语与延伸"><a aria-hidden="true" tabindex="-1" href="#7-结语与延伸"><span class="icon icon-link"></span></a>7. 结语与延伸</h3>
<p>面对数据稀缺的挑战，我们的核心目标是通过数据增强来<strong>扩充数据的多样性</strong>，而不仅仅是增加数量。欠拟合与过拟合的斗争，本质上是在模型的<strong>容量</strong>与数据的<strong>信息量</strong>之间寻找一个精妙的平衡点。</p>
<p>本文所介绍的策略是解决这一问题的经典起点。在此基础上，你还可以进一步探索更前沿的方向，例如：利用无标签数据进行自监督预训练 (Self-supervised Pre-training)、使用生成模型（如 Diffusion Models）或 3D 渲染来合成新数据、以及应用半监督学习 (Semi-supervised Learning) 等技术。</p> <html lang="en" data-astro-cid-uffxixac> <head><!-- Global Metadata --><meta charset="utf-8"><!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">--><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"><link rel="shortcut icon" href="/favicon.png" type="image/png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Ge Yuxu • AI &#38; Engineering" href="https://geyuxu.com/rss.xml"><meta name="generator" content="Astro v5.5.6"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://geyuxu.com/blog/ai/data-augmentation-underfitting-overfitting-zh/"><!-- Primary Meta Tags --><title>Ge Yuxu • AI &amp; Engineering</title><meta name="title" content="Ge Yuxu • AI &#38; Engineering"><meta name="description" content="Welcome to my blog!"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://geyuxu.com/blog/ai/data-augmentation-underfitting-overfitting-zh/"><meta property="og:title" content="Ge Yuxu • AI &#38; Engineering"><meta property="og:description" content="Welcome to my blog!"><meta property="og:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://geyuxu.com/blog/ai/data-augmentation-underfitting-overfitting-zh/"><meta property="twitter:title" content="Ge Yuxu • AI &#38; Engineering"><meta property="twitter:description" content="Welcome to my blog!"><meta property="twitter:image" content="https://geyuxu.com/blog-placeholder-1.jpg"><script src="/js/jquery-3.7.1.min.js"></script><script src="/js/copy-code-button.js" defer></script><!-- Dify Chatbot Configuration --><script>
 window.difyChatbotConfig = {
  token: 'VgrjCAto93bjE0MW',
  systemVariables: {
    // user_id: 'YOU CAN DEFINE USER ID HERE',
    // conversation_id: 'YOU CAN DEFINE CONVERSATION ID HERE, IT MUST BE A VALID UUID',
  },
  userVariables: {
    // avatar_url: 'YOU CAN DEFINE USER AVATAR URL HERE',
    // name: 'YOU CAN DEFINE USER NAME HERE',
  },
 }
</script><!-- Dify Chatbot Script --><script src="https://udify.app/embed.min.js" id="VgrjCAto93bjE0MW" defer>
</script><!-- Dify Chatbot Custom Styles --></head> <body data-astro-cid-uffxixac>  <div class="statement" data-astro-cid-uffxixac> <blockquote data-astro-cid-uffxixac> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>脱敏说明</strong>：本文所有出现的表名、字段名、接口地址、变量名、IP地址及示例数据等均非真实，仅用于阐述技术思路与实现步骤，示例代码亦非公司真实代码。示例方案亦非公司真实完整方案，仅为本人记忆总结，用于技术学习探讨。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;文中所示任何标识符并不对应实际生产环境中的名称或编号。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;示例&nbsp;SQL、脚本、代码及数据等均为演示用途，不含真实业务数据，也不具备直接运行或复现的完整上下文。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;读者若需在实际项目中参考本文方案，请结合自身业务场景及数据安全规范，使用符合内部命名和权限控制的配置。</p> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>Data Desensitization Notice</strong>: All table names, field names, API endpoints, variable names, IP addresses, and sample data appearing in this article are fictitious and intended solely to illustrate technical concepts and implementation steps. The sample code is not actual company code. The proposed solutions are not complete or actual company solutions but are summarized from the author's memory for technical learning and discussion.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;Any identifiers shown in the text do not correspond to names or numbers in any actual production environment.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;Sample SQL, scripts, code, and data are for demonstration purposes only, do not contain real business data, and lack the full context required for direct execution or reproduction.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;Readers who wish to reference the solutions in this article for actual projects should adapt them to their own business scenarios and data security standards, using configurations that comply with internal naming and access control policies.</p> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>版权声明</strong>：本文版权归原作者所有，未经作者事先书面许可，任何单位或个人不得以任何方式复制、转载、摘编或用于商业用途。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;若需非商业性引用或转载本文内容，请务必注明出处并保持内容完整。<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;对因商业使用、篡改或不当引用本文内容所产生的法律纠纷，作者保留追究法律责任的权利。</p> <p data-astro-cid-uffxixac><strong data-astro-cid-uffxixac>Copyright Notice</strong>: The copyright of this article belongs to the original author. Without prior written permission from the author, no entity or individual may copy, reproduce, excerpt, or use it for commercial purposes in any way.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;For non-commercial citation or reproduction of this content, attribution must be given, and the integrity of the content must be maintained.<br data-astro-cid-uffxixac>
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;The author reserves the right to pursue legal action against any legal disputes arising from the commercial use, alteration, or improper citation of this article's content.</p> <p data-astro-cid-uffxixac><em data-astro-cid-uffxixac>Copyright&nbsp;©&nbsp;1989–Present&nbsp;Ge&nbsp;Yuxu.&nbsp;All&nbsp;Rights&nbsp;Reserved.</em></p> </blockquote> </div></body></html>  </article> </div> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 All rights reserved.
</footer>  </body></html>