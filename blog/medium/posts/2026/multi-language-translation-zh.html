<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ºåšå®¢æ·»åŠ å¤šè¯­è¨€ AI ç¿»è¯‘åŠŸèƒ½</title>
    <style>
        body { font-family: Georgia, serif; max-width: 700px; margin: 2rem auto; padding: 0 1rem; line-height: 1.7; color: #333; }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        h2 { font-size: 1.4rem; margin-top: 2rem; }
        pre { background: #f4f4f4; padding: 1rem; overflow-x: auto; border-radius: 4px; }
        code { font-family: Menlo, Monaco, monospace; font-size: 0.9em; }
        p code { background: #f4f4f4; padding: 0.2em 0.4em; border-radius: 3px; }
        img { max-width: 100%; }
        blockquote { border-left: 3px solid #ddd; margin-left: 0; padding-left: 1rem; color: #666; }
        ul { padding-left: 1.5rem; }
        hr { border: none; border-top: 1px solid #ddd; margin: 2rem 0; }
        a { color: #1a8917; }
    </style>
</head>
<body>
<hr>
<h2>date: 2026-01-28
tags: [ai, translation, cloudflare-workers, javascript, llm]
description: ä½¿ç”¨ GPT-4o-mini å’Œ Cloudflare Workers ä¸ºé™æ€åšå®¢æ·»åŠ å®æ—¶ AI ç¿»è¯‘åŠŸèƒ½ï¼Œæ”¯æŒ 10 ç§è¯­è¨€ï¼Œé‡‡ç”¨åŒå±‚ç¼“å­˜ç­–ç•¥ã€‚</h2>
<h1>ä¸ºåšå®¢æ·»åŠ å¤šè¯­è¨€ AI ç¿»è¯‘åŠŸèƒ½</h1>
<p>åœ¨å®ç°äº† <a href="/blog/post.html?p=posts/2026/ai-assistant-rag">RAG é©±åŠ¨çš„ AI åŠ©æ‰‹</a>ä¹‹åï¼Œæˆ‘å¸Œæœ›è®©åšå®¢å†…å®¹èƒ½è¢«å…¨çƒè¯»è€…è®¿é—®ã€‚ä¸å…¶æ‰‹åŠ¨ç¿»è¯‘æ¯ç¯‡æ–‡ç« ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ªæŒ‰éœ€ AI ç¿»è¯‘ç³»ç»Ÿï¼Œæ”¯æŒ 10 ç§è¯­è¨€ã€‚</p>
<h2>ç›®æ ‡</h2>
<p>åˆ›å»ºæ— ç¼çš„ç¿»è¯‘ä½“éªŒï¼š</p>
<ul>
<li>æŒ‰éœ€å°†ä»»ä½•åšå®¢æ–‡ç« ç¿»è¯‘æˆ 10 ç§ä¸»è¦è¯­è¨€</li>
<li>ä¿ç•™ Markdown æ ¼å¼ï¼ˆæ ‡é¢˜ã€ä»£ç å—ã€é“¾æ¥ï¼‰</li>
<li>ç¼“å­˜ç¿»è¯‘ç»“æœä»¥é™ä½ API æˆæœ¬</li>
<li>ç¿»è¯‘æ—¶æ˜¾ç¤ºåŠ è½½åé¦ˆ</li>
</ul>
<h2>æ¶æ„</h2>
<blockquote><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</code><br>
<code>â”‚                     æµè§ˆå™¨ï¼ˆå‰ç«¯ï¼‰                               â”‚</code><br>
<code>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</code><br>
<code>â”‚  è¯­è¨€é€‰æ‹©å™¨ â”€â”€â–¶ æ£€æŸ¥ localStorage ç¼“å­˜                          â”‚</code><br>
<code>â”‚         â”‚                     â”‚                                 â”‚</code><br>
<code>â”‚         â”‚â—€â”€â”€ ç¼“å­˜å‘½ä¸­ â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚</code><br>
<code>â”‚         â”‚                                                       â”‚</code><br>
<code>â”‚         â–¼ ç¼“å­˜æœªå‘½ä¸­                                            â”‚</code><br>
<code># ... (16 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><h2>æ”¯æŒçš„è¯­è¨€</h2>
<p>ç³»ç»Ÿæ”¯æŒ 10 ç§è¯­è¨€ï¼Œè¦†ç›–å…¨çƒå¤§éƒ¨åˆ†äººå£ï¼š</p>
<p><img src="/blog/images/tables/table-5b7597bd.png" alt="Table"></p><h2>å®ç°</h2>
<h3>1. è¯­è¨€é€‰æ‹©å™¨ UI</h3>
<p>ä¸€ä¸ªç®€æ´çš„ä¸‹æ‹‰èœå•ï¼Œå‡ºç°åœ¨æ¯ç¯‡åšå®¢æ–‡ç« ä¸Šï¼š</p>
<blockquote><code>&lt;div class=&quot;lang-selector&quot; id=&quot;lang-selector&quot;&gt;</code><br>
<code>    &lt;span class=&quot;lang-selector-label&quot;&gt;</code><br>
<code>        &lt;svg&gt;&lt;!-- ç¿»è¯‘å›¾æ ‡ --&gt;&lt;/svg&gt;</code><br>
<code>        Language</code><br>
<code>    &lt;/span&gt;</code><br>
<code>    &lt;select class=&quot;lang-select&quot; id=&quot;lang-select&quot;&gt;</code><br>
<code>        &lt;option value=&quot;en&quot;&gt;ğŸ‡ºğŸ‡¸ English&lt;/option&gt;</code><br>
<code>        &lt;option value=&quot;zh&quot;&gt;ğŸ‡¨ğŸ‡³ ä¸­æ–‡&lt;/option&gt;</code><br>
<code># ... (8 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><h3>2. åŠ è½½åŠ¨ç”»</h3>
<p>ç¿»è¯‘æœŸé—´æ˜¾ç¤ºçº¯ CSS æ—‹è½¬åŠ¨ç”»ï¼š</p>
<blockquote><code>.lang-status.translating {</code><br>
<code>    color: var(--vermilion);</code><br>
<code>    display: flex;</code><br>
<code>    align-items: center;</code><br>
<code>    gap: 0.5rem;</code><br>
<code>}</code><br>
<code></code><br>
<code>.lang-status.translating::before {</code><br>
<code># ... (12 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><h3>3. åŒå±‚ç¼“å­˜ç­–ç•¥</h3>
<p>ä¸ºäº†é™ä½ API æˆæœ¬ï¼Œæˆ‘åœ¨ä¸¤ä¸ªå±‚é¢å®ç°äº†ç¼“å­˜ï¼š</p>
<p><strong>å‰ç«¯ï¼ˆlocalStorageï¼‰</strong> - 7 å¤© TTLï¼š</p>
<blockquote><code>function getTranslationCache(key) {</code><br>
<code>    const raw = localStorage.getItem(key);</code><br>
<code>    if (!raw) return null;</code><br>
<code></code><br>
<code>    const data = JSON.parse(raw);</code><br>
<code>    if (Date.now() - data.timestamp &gt; 7 * 24 * 60 * 60 * 1000) {</code><br>
<code>        localStorage.removeItem(key);</code><br>
<code>        return null;</code><br>
<code>    }</code><br>
<code>    return data.content;</code><br>
<code>}</code></blockquote><p><strong>åç«¯ï¼ˆCloudflare KVï¼‰</strong> - 30 å¤© TTLï¼š</p>
<blockquote><code>// æ£€æŸ¥ç¼“å­˜</code><br>
<code>const cached = await env.TRANSLATIONS.get(cacheKey);</code><br>
<code>if (cached) {</code><br>
<code>    return Response.json({ translated: cached, cached: true });</code><br>
<code>}</code><br>
<code></code><br>
<code>// ç¿»è¯‘åç¼“å­˜ç»“æœ</code><br>
<code>await env.TRANSLATIONS.put(cacheKey, translated, {</code><br>
<code>    expirationTtl: 30 * 24 * 60 * 60</code><br>
<code>});</code></blockquote><h3>4. ç¿»è¯‘ APIï¼ˆCloudflare Workerï¼‰</h3>
<p>Worker é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æç¤ºè¯å¤„ç†ç¿»è¯‘è¯·æ±‚ï¼š</p>
<blockquote><code>if (path === &quot;/api/translate&quot;) {</code><br>
<code>    const { content, targetLang, slug } = await request.json();</code><br>
<code></code><br>
<code>    const response = await fetch(&quot;https://api.openai.com/v1/chat/completions&quot;, {</code><br>
<code>        method: &quot;POST&quot;,</code><br>
<code>        headers: {</code><br>
<code>            &quot;Authorization&quot;: `Bearer ${env.OPENAI_API_KEY}`,</code><br>
<code>            &quot;Content-Type&quot;: &quot;application/json&quot;,</code><br>
<code># ... (25 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><h3>5. æ™ºèƒ½è¯­è¨€æ£€æµ‹</h3>
<p>å‰ç«¯è‡ªåŠ¨æ£€æµ‹åŸå§‹è¯­è¨€ä»¥è®¾ç½®æ­£ç¡®çš„é»˜è®¤å€¼ï¼š</p>
<blockquote><code>function detectLanguage(text) {</code><br>
<code>    const chineseChars = (text.match(/[\u4e00-\u9fff]/g) || []).length;</code><br>
<code>    const totalChars = text.length;</code><br>
<code>    if (chineseChars / totalChars &gt; 0.3) return &#039;zh&#039;;</code><br>
<code>    return &#039;en&#039;;</code><br>
<code>}</code></blockquote><h2>å…³é”®è®¾è®¡å†³ç­–</h2>
<ol>
<li><p><strong>ç¿»è¯‘ Markdown è€Œé HTML</strong>ï¼šåœ¨å¯ç”¨æ—¶ï¼Œæˆ‘ç¿»è¯‘åŸå§‹ Markdown æºç å¹¶é‡æ–°æ¸²æŸ“ã€‚è¿™æ¯”ç¿»è¯‘æ¸²æŸ“åçš„ HTML èƒ½æ›´å¥½åœ°ä¿ç•™æ ¼å¼ã€‚</p>
</li>
<li><p><strong>ä½æ¸©åº¦å€¼ï¼ˆ0.3ï¼‰</strong>ï¼šç¿»è¯‘éœ€è¦ä¸€è‡´æ€§ï¼Œè€Œéåˆ›é€ æ€§ã€‚ä½æ¸©åº¦å€¼èƒ½äº§ç”Ÿæ›´å¯é çš„ç»“æœã€‚</p>
</li>
<li><p><strong>å†…å®¹å“ˆå¸Œä½œä¸ºç¼“å­˜é”®</strong>ï¼šä½¿ç”¨ <code>slug_hash_lang</code> ä½œä¸ºç¼“å­˜é”®ç¡®ä¿åŸå§‹å†…å®¹å˜åŒ–æ—¶ï¼Œç¿»è¯‘ç¼“å­˜è‡ªåŠ¨å¤±æ•ˆã€‚</p>
</li>
<li><p><strong>å¯é€‰çš„ KV ç»‘å®š</strong>ï¼šWorker åœ¨æ²¡æœ‰ KV å­˜å‚¨çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å·¥ä½œâ€”â€”åªæ˜¯æ²¡æœ‰æœåŠ¡ç«¯ç¼“å­˜ã€‚è¿™ä½¿å¼€å‘æ›´å®¹æ˜“ã€‚</p>
</li>
</ol>
<h2>æˆæœ¬åˆ†æ</h2>
<p>ä½¿ç”¨ <code>gpt-4o-mini</code> è¿›è¡Œç¿»è¯‘ï¼š</p>
<ul>
<li>å¹³å‡åšå®¢æ–‡ç« ï¼šçº¦ 3000 tokens è¾“å…¥ï¼Œçº¦ 3000 tokens è¾“å‡º</li>
<li>æ¯æ¬¡ç¿»è¯‘æˆæœ¬ï¼šçº¦ $0.003</li>
<li>æœ‰ç¼“å­˜åï¼Œé‡å¤è¯·æ±‚å…è´¹</li>
</ul>
<p>å¯¹äºä¸­ç­‰æµé‡çš„åšå®¢ï¼Œé¢„è®¡ç¿»è¯‘æˆæœ¬æ¯æœˆä¸è¶…è¿‡ $5ã€‚</p>
<h2>æœªæ¥æ”¹è¿›</h2>
<ul>
<li><input disabled="" type="checkbox"> æ„å»ºæ—¶é¢„ç¿»è¯‘çƒ­é—¨æ–‡ç« </li>
<li><input disabled="" type="checkbox"> ä¸ºé•¿æ–‡ç« æ·»åŠ æµå¼ä¼ è¾“</li>
<li><input disabled="" type="checkbox"> æ”¯æŒ RTL è¯­è¨€ï¼ˆé˜¿æ‹‰ä¼¯è¯­ï¼‰çš„æ­£ç¡® CSS</li>
<li><input disabled="" type="checkbox"> æ·»åŠ ç¿»è¯‘è´¨é‡åé¦ˆ</li>
</ul>
<p>å®Œæ•´å®ç°åœ¨æˆ‘çš„<a href="https://github.com/geyuxu/yuxu.ge">ç½‘ç«™ä»“åº“</a>ä¸­ã€‚</p>

</body>
</html>