<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pandas Basics: Core Objects & Common Operations | Yuxu Ge</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        :root {
            --black: #111;
            --dark-grey: #444;
            --off-white: #f4f4f4;
            --vermilion: #C41E3A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--black);
            background-color: var(--off-white);
        }

        a {
            color: var(--vermilion);
            text-decoration: none;
        }

        a:hover {
            opacity: 0.75;
        }

        .layout {
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 320px;
            height: 100vh;
            background: var(--black);
            color: var(--off-white);
            padding: 3rem 2rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .sidebar-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .avatar {
            display: block;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid var(--vermilion);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .avatar:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .name-block {
            margin-bottom: 0.5rem;
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--off-white);
        }

        .title-role {
            font-size: 0.9rem;
            color: #888;
            margin-top: 0.25rem;
            font-weight: 400;
        }

        .contact-block {
            margin-top: 2.5rem;
            width: 100%;
        }

        .social-links {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .social-links a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 160px;
            color: var(--off-white);
            opacity: 0.7;
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .social-links a:hover {
            color: var(--vermilion);
            opacity: 1;
            background: rgba(255, 255, 255, 0.05);
        }

        .social-links svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .social-links .orcid-link {
            font-size: 0.68rem;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .sidebar-footer {
            text-align: center;
            font-size: 0.75rem;
            color: #555;
        }

        /* Content */
        .content {
            margin-left: 320px;
            padding: 3rem 4rem;
            max-width: calc(100vw - 320px - 8rem);
        }

        .back-link {
            display: inline-block;
            font-size: 0.85rem;
            margin-bottom: 2rem;
            color: var(--dark-grey);
        }

        .back-link:hover {
            color: var(--vermilion);
        }

        /* Article */
        article h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.3;
            color: var(--black);
        }

        article h2 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--black);
        }

        article h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 1.5rem 0 0.75rem;
            color: var(--black);
        }

        article p {
            margin-bottom: 1rem;
            color: var(--dark-grey);
        }

        article ul,
        article ol {
            margin: 1rem 0 1rem 1.5rem;
            color: var(--dark-grey);
        }

        article li {
            margin-bottom: 0.5rem;
        }

        article strong {
            color: var(--black);
        }

        article code {
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
            background: #e8e8e8;
            padding: 0.15em 0.4em;
            border-radius: 3px;
        }

        article pre {
            margin: 1rem 0;
            border-radius: 6px;
            overflow-x: auto;
            background: #2d2d2d;
            padding: 1rem;
        }

        article pre code {
            background: none;
            padding: 0;
            font-size: 0.75em;
            white-space: pre !important;
            counter-reset: line;
            display: block;
            color: #ccc;
        }

        article pre code .line {
            counter-increment: line;
        }

        article pre code .line::before {
            content: counter(line);
            display: inline-block;
            width: 2.5em;
            margin-right: 1em;
            text-align: right;
            color: #666;
            user-select: none;
        }

        .code-toolbar {
            display: flex;
            justify-content: flex-start;
            padding: 0.35rem 0.5rem;
            background: #3a3a3a;
            border-radius: 6px 6px 0 0;
        }

        .code-toolbar+pre {
            margin-top: 0;
            border-radius: 0 0 6px 6px;
        }

        .copy-btn {
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
            background: #555;
            color: #fff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-btn:hover,
        .copy-btn:active {
            background: #777;
        }

        .copy-btn.copied {
            background: #2a2;
        }

        article blockquote {
            border-left: 3px solid var(--vermilion);
            padding-left: 1rem;
            margin: 1rem 0;
            color: #666;
            font-style: italic;
        }

        article hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 2rem 0;
        }

        article table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        article th,
        article td {
            border: 1px solid #ddd;
            padding: 0.5rem 0.75rem;
            text-align: left;
        }

        article th {
            background: #e8e8e8;
            font-weight: 600;
        }

        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem 0;
            border-radius: 6px;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: #888;
        }

        .error {
            color: var(--vermilion);
        }

        /* Language Selector */
        .lang-selector {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 0.75rem 1rem;
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .lang-selector-label {
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .lang-selector-label svg {
            width: 16px;
            height: 16px;
        }

        .lang-select {
            padding: 0.4rem 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            min-width: 140px;
        }

        .lang-select:focus {
            outline: none;
            border-color: var(--vermilion);
        }

        .lang-status {
            font-size: 0.8rem;
            color: #888;
            margin-left: auto;
        }

        .lang-status.translating {
            color: var(--vermilion);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .lang-status.translating::before {
            content: '';
            width: 14px;
            height: 14px;
            border: 2px solid #f0f0f0;
            border-top-color: var(--vermilion);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .lang-status.cached {
            color: #4CAF50;
        }

        .lang-original-btn {
            padding: 0.35rem 0.6rem;
            font-size: 0.75rem;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            color: #666;
            transition: all 0.2s;
        }

        .lang-original-btn:hover {
            background: #e0e0e0;
            color: #333;
        }

        @media (max-width: 600px) {
            .lang-selector {
                flex-wrap: wrap;
            }
            .lang-status {
                width: 100%;
                margin-left: 0;
                margin-top: 0.5rem;
            }
        }

        /* KaTeX math styles */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0;
        }

        .katex {
            font-size: 1.1em;
        }

        /* Jupyter Notebook Styles */
        .notebook-container {
            margin-top: 1rem;
        }

        .notebook-download {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 1.5rem;
            background: var(--black);
            color: var(--off-white);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .notebook-download:hover {
            opacity: 0.8;
            color: var(--off-white);
        }

        .notebook-download svg {
            width: 16px;
            height: 16px;
        }

        .nb-cell {
            margin-bottom: 1.5rem;
        }

        .nb-cell-code .nb-source {
            background: #2d2d2d;
            border-radius: 6px;
            overflow-x: auto;
        }

        .nb-cell-code .nb-source pre {
            margin: 0;
            padding: 1rem;
            color: #ccc;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.85em;
        }

        .nb-cell-code .nb-source code {
            background: none;
            padding: 0;
        }

        .nb-output {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
        }

        .nb-output pre {
            margin: 0;
            padding: 0;
            background: transparent;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.85em;
            color: #222;
        }

        .nb-output img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0.5rem 0;
        }

        .nb-output table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .nb-output th,
        .nb-output td {
            border: 1px solid #ddd;
            padding: 0.5rem;
            text-align: left;
        }

        .nb-output th {
            background: #e8e8e8;
            font-weight: 600;
        }

        .nb-cell-markdown {
            padding: 0;
        }

        .nb-cell-markdown h1:first-child {
            margin-top: 0;
        }

        /* Document Download Button */
        .doc-download {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            margin-bottom: 1.5rem;
            background: var(--black);
            color: var(--off-white);
            border-radius: 4px;
            font-size: 0.85rem;
            transition: opacity 0.2s;
        }

        .doc-download:hover {
            opacity: 0.8;
            color: var(--off-white);
        }

        .doc-download svg {
            width: 16px;
            height: 16px;
        }

        /* PDF Viewer */
        .pdf-container {
            margin-top: 1rem;
        }

        .pdf-viewer {
            width: 100%;
            height: 80vh;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f5f5f5;
        }

        /* Text File Display */
        .text-container {
            margin-top: 1rem;
        }

        .text-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 1.5rem;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--dark-grey);
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Word Document Display */
        .word-container {
            margin-top: 1rem;
        }

        .word-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 2rem;
            line-height: 1.8;
            color: var(--dark-grey);
        }

        .word-content p {
            margin-bottom: 1rem;
        }

        .word-content h1,
        .word-content h2,
        .word-content h3 {
            color: var(--black);
            margin: 1.5rem 0 1rem;
        }

        .word-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .word-content th,
        .word-content td {
            border: 1px solid #ddd;
            padding: 0.5rem;
        }

        .word-content img {
            max-width: 100%;
            height: auto;
        }

        /* Excel Display */
        .excel-container {
            margin-top: 1rem;
        }

        .excel-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .excel-tab {
            padding: 0.5rem 1rem;
            background: #e8e8e8;
            border: none;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .excel-tab.active {
            background: #4CAF50;
            color: white;
        }

        .excel-content {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow-x: auto;
            max-height: 70vh;
            overflow-y: auto;
        }

        .excel-content table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .excel-content th,
        .excel-content td {
            border: 1px solid #ddd;
            padding: 0.4rem 0.6rem;
            text-align: left;
            white-space: nowrap;
        }

        .excel-content th {
            background: #f5f5f5;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .excel-content tr:nth-child(even) {
            background: #fafafa;
        }

        /* PowerPoint Display */
        .ppt-container {
            margin-top: 1rem;
        }

        .ppt-viewer {
            width: 100%;
            height: 80vh;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f5f5f5;
        }

        /* CSV Display (uses excel styles) */
        .csv-container {
            margin-top: 1rem;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                padding: 2rem 1.5rem 1rem;
            }

            .social-links {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }

            .social-links a,
            .social-links .orcid-link {
                width: auto;
                padding: 0.5rem;
                font-size: 0;
                gap: 0;
            }

            .social-links svg {
                width: 24px;
                height: 24px;
            }

            .social-links .hide-mobile {
                display: none;
            }

            .sidebar-footer {
                margin-top: 1rem;
            }

            .content {
                margin-left: 0;
                padding: 2rem 1rem;
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                padding: 1.5rem 1rem 1rem;
            }

            .avatar {
                width: 80px;
                height: 80px;
            }

            h1 {
                font-size: 1.4rem;
            }

            article h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>

    <div class="layout">
        <aside class="sidebar" id="sidebar-content"></aside>
        <script src="/components/sidebar.js?v=20260128"></script>

        <main class="content">
            <a href="/blog/" class="back-link">â† Back to Blog</a>

            <!-- Language Selector -->
            <div class="lang-selector" id="lang-selector" style="display: none;">
                <span class="lang-selector-label">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
                    </svg>
                    Language
                </span>
                <select class="lang-select" id="lang-select">
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                    <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                    <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃªs</option>
                    <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                    <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                </select>
                <button class="lang-original-btn" id="lang-original-btn" style="display: none;">Show Original</button>
                <span class="lang-status" id="lang-status"></span>
            </div>

            <article>
<hr>
<h2>date: 2023-04-23
tags: [pandas, data-analysis, python]
legacy: true</h2>
<h1>Pandas Basics: Core Objects &amp; Common Operations</h1>
<blockquote><code>import pandas as pd</code><br>
<code>import numpy as np</code><br>
<code></code><br>
<code># åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„ Seriesï¼šä¸æŒ‡å®šç´¢å¼•æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨0,1,2,...ä½œä¸ºç´¢å¼•</code><br>
<code>s1 = pd.Series([10, 20, 30, 40])</code><br>
<code>print(s1)</code><br>
<code># è¾“å‡º:</code><br>
<code># 0    10</code><br>
<code># ... (21 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><p>ä¸Šé¢ä»£ç å±•ç¤ºäº†ä¸‰ç§åˆ›å»º Series çš„æ–¹å¼ï¼šç›´æ¥ç”±åˆ—è¡¨åˆ›å»ºï¼ˆå¯ä»¥æŒ‡å®šç´¢å¼•ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šç”¨é»˜è®¤ç´¢å¼•0,1,2,â€¦ï¼‰ï¼Œä»¥åŠç”±å­—å…¸åˆ›å»ºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé€šè¿‡åˆ—è¡¨åˆ›å»ºå¯ä»¥çµæ´»æŒ‡å®šç´¢å¼•é¡ºåºï¼Œè€Œé€šè¿‡å­—å…¸åˆ›å»ºä¼šä½¿ç”¨å­—å…¸çš„é”®ä½œä¸ºç´¢å¼•ï¼ˆé¡ºåºä¸ºæ’å…¥é¡ºåºï¼‰ã€‚ä¸¤è€…æ•ˆæœç±»ä¼¼ï¼Œéƒ½å¾—åˆ°ä¸€ä¸ªå¸¦ç´¢å¼•çš„ä¸€ç»´æ•°æ®åºåˆ—ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§å¿«æ·æ–¹å¼ï¼Œå¦‚æœæƒ³è¦åˆ›å»ºå†…å®¹å…¨éƒ¨ç›¸åŒçš„ Seriesï¼Œå¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªå¸¸æ•°å€¼å’Œç´¢å¼•ã€‚ä¾‹å¦‚ä¸‹é¢ä»£ç å°†ç”Ÿæˆ10ä¸ªå…ƒç´ éƒ½ä¸º0.2çš„Seriesï¼š</p>
<blockquote><code># åˆ›å»ºä¸€ä¸ªåŒ…å«10ä¸ª0.2çš„ Series</code><br>
<code>s4 = pd.Series(0.2, index=range(10))</code><br>
<code>print(s4.head(3))  # å…ˆçœ‹å¤´3è¡Œ</code><br>
<code># è¾“å‡º:</code><br>
<code># 0    0.2</code><br>
<code># 1    0.2</code><br>
<code># 2    0.2</code><br>
<code># dtype: float64</code></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œs4çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯0.2ï¼ŒæŒ‡æ•°0åˆ°9ã€‚head(3)æ–¹æ³•è¿”å›å‰3è¡Œï¼Œä¾¿äºæˆ‘ä»¬é¢„è§ˆæ•°æ®ã€‚</p>
<h3>Series çš„æ•°æ®è®¿é—®</h3>
<p>Series æœ‰ç‚¹ç±»ä¼¼äº Python çš„åˆ—è¡¨å’Œå­—å…¸çš„ç»“åˆï¼Œåœ¨è®¿é—®æ•°æ®æ—¶æ—¢å¯ä»¥ç”¨ä½ç½®ä¸‹æ ‡ä¹Ÿå¯ä»¥ç”¨æ ‡ç­¾ç´¢å¼•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šSeriesåŒæ—¶æ”¯æŒåŸºäºä½ç½®å’ŒåŸºäºæ ‡ç­¾çš„ç´¢å¼•æ–¹å¼ï¼Œè¿™ä¸¤å¥—ç´¢å¼•å½¼æ­¤ç‹¬ç«‹ã€‚</p>
<ul>
<li>ä½ç½®ç´¢å¼•ï¼ˆä¸‹æ ‡ï¼‰ï¼šæŒ‰ç…§å…ƒç´ çš„ä½ç½®é¡ºåºï¼Œä»0å¼€å§‹è®¡æ•°ã€‚ä¾‹å¦‚ s[0] å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œs[1:3] å–åˆ‡ç‰‡ã€‚</li>
<li>æ ‡ç­¾ç´¢å¼•ï¼ˆindexï¼‰ï¼šæŒ‰ç…§æˆ‘ä»¬å®šä¹‰çš„ç´¢å¼•å€¼æ¥å–ã€‚ä¾‹å¦‚ç´¢å¼•æ˜¯å­—ç¬¦ä¸² â€˜zsâ€™ï¼Œç”¨ s[&#39;zs&#39;] æ¥å–å¯¹åº”çš„å€¼ã€‚</li>
</ul>
<p>ä¸‹é¢ç”¨å…·ä½“ä¾‹å­è¯´æ˜ Series çš„ä¸¤ç§ç´¢å¼•æ–¹æ³•ï¼š</p>
<blockquote><code>s = pd.Series([100, 78, 98, 79], index=[&#039;zs&#039;, &#039;ls&#039;, &#039;ww&#039;, &#039;sl&#039;])</code><br>
<code># è¿™ä¸ª Series çš„ç´¢å¼•ä¸º &#039;zs&#039;,&#039;ls&#039;,&#039;ww&#039;,&#039;sl&#039;ï¼Œå¯¹åº”çš„å€¼å¦‚åˆ—è¡¨æ‰€ç»™</code><br>
<code></code><br>
<code># æŒ‰ä½ç½®ç´¢å¼•è®¿é—®</code><br>
<code>print(s[3])      # ç¬¬4ä¸ªå…ƒç´ ï¼Œä½ç½®ä»0å¼€å§‹è®¡æ•°</code><br>
<code>print(s[:2])     # å‰2ä¸ªå…ƒç´ çš„åˆ‡ç‰‡ï¼ˆä¸åŒ…å«ä½ç½®2ï¼‰</code><br>
<code>print(s[[0, 2]]) # ä½ç½®0å’Œ2çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ Series</code><br>
<code></code><br>
<code># æŒ‰æ ‡ç­¾ç´¢å¼•è®¿é—®</code><br>
<code>print(s[&#039;sl&#039;])              # ç´¢å¼•æ ‡ç­¾ä¸º &#039;sl&#039; çš„å…ƒç´ </code><br>
<code>print(s[&#039;zs&#039;:&#039;ww&#039;])         # æŒ‰æ ‡ç­¾åˆ‡ç‰‡ï¼ŒåŒ…å« &#039;zs&#039; åˆ° &#039;ww&#039;ï¼ˆæ³¨æ„åŒ…å«æœ«ç«¯ï¼‰</code><br>
<code>print(s[[&#039;zs&#039;, &#039;ww&#039;, &#039;sl&#039;]])# æŒ‡å®šæ ‡ç­¾åˆ—è¡¨ï¼Œè¿”å›å¤šä¸ªå…ƒç´ </code></blockquote><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œs[3] é€šè¿‡ä½ç½®è·å–åˆ°äº†ç¬¬4ä¸ªå…ƒç´  79ï¼Œè€Œ s[&#39;sl&#39;] åˆ™é€šè¿‡æ ‡ç­¾è·å–åˆ°äº†å¯¹åº”çš„å€¼ 79ã€‚åŒºåˆ«ï¼šåˆ‡ç‰‡æ—¶ï¼Œs[:2]æŒ‰ä½ç½®å–ä¸åŒ…æ‹¬ç´¢å¼•2ï¼Œè€Œ s[&#39;zs&#39;:&#39;ww&#39;]æŒ‰æ ‡ç­¾å–åˆ™æ˜¯åŒ…å« &#39;ww&#39; è¿™ä¸ªç´¢å¼•çš„ï¼ˆä¹Ÿå°±æ˜¯åŒ…å«åˆ‡ç‰‡åŒºé—´çš„æœ«ç«¯ï¼‰ã€‚è¿™ç‚¹ä¸ Python åŸºæœ¬åˆ‡ç‰‡è§„åˆ™ä¸åŒï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚</p>
<p>å¦å¤–ï¼ŒSeries ä¸æ”¯æŒåƒ Python åˆ—è¡¨é‚£æ ·çš„è´Ÿç´¢å¼•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œs[-1] å¹¶ä¸èƒ½å–æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆé™¤éä½ çš„ç´¢å¼•æ°å¥½æœ‰ -1 è¿™ä¸ªæ ‡ç­¾ï¼‰ã€‚å¦‚æœéœ€è¦å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ s.iloc[-1]ï¼ˆiloc æ˜¯åé¢ä¼šä»‹ç»çš„æŒ‰ä½ç½®é€‰å–çš„é€šç”¨æ–¹å¼ï¼‰ã€‚æ€»ä¹‹ï¼ŒSeries çš„ä¸‹æ ‡ç´¢å¼•åªæœ‰æ­£å‘çš„ï¼Œæ²¡æœ‰åå‘çš„ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥æŸ¥çœ‹ Series çš„ä¸€äº›å±æ€§æ¥äº†è§£æ•°æ®ç»“æ„ï¼š</p>
<blockquote><code>print(s.index)   # Index([&#039;zs&#039;, &#039;ls&#039;, &#039;ww&#039;, &#039;sl&#039;], dtype=&#039;object&#039;)</code><br>
<code>print(s.values)  # [100  78  98  79]ï¼Œå€¼æœ¬èº«æ˜¯ä¸€ä¸ª numpy.ndarray</code><br>
<code>print(s.dtype)   # int64ï¼Œå€¼çš„æ•°æ®ç±»å‹</code><br>
<code>print(s.shape)   # (4,)ï¼ŒSeries çš„å½¢çŠ¶ï¼Œç›¸å½“äºé•¿åº¦ä¸º4çš„ä¸€ç»´æ•°ç»„</code><br>
<code>print(s.size)    # 4ï¼Œå…ƒç´ ä¸ªæ•°</code><br>
<code>print(s.ndim)    # 1ï¼Œç»´åº¦ï¼Œå¯¹äºSeriesæ°¸è¿œæ˜¯1</code></blockquote><p>index å±æ€§è¿”å›ä¸€ä¸ª Index å¯¹è±¡ï¼ŒåŒ…å« Series çš„ç´¢å¼•åˆ—è¡¨ï¼›values åˆ™è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å€¼çš„ NumPy æ•°ç»„ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå€¼å…¨æ˜¯æ•´æ•°ï¼Œæ‰€ä»¥ dtype æ˜¯ int64ã€‚å¦‚æœæ•°æ®åŒ…å«æµ®ç‚¹æˆ–å‡ºç° NaNï¼ˆç¼ºå¤±å€¼ï¼‰ï¼Œdtype å¯èƒ½å˜ä¸º float64ã€‚shapeã€sizeã€ndim ç­‰å±æ€§å’Œ NumPy çš„æ•°ç»„ç±»ä¼¼ï¼Œåˆ†åˆ«è¡¨ç¤ºæ•°æ®çš„å½¢çŠ¶ã€å…ƒç´ æ•°é‡å’Œç»´åº¦ã€‚</p>
<h2>DataFrame æ˜¯ä»€ä¹ˆ</h2>
<p>DataFrame æ˜¯ Pandas ä¸­æ›´ä¸ºå¸¸ç”¨çš„äºŒç»´è¡¨ç»“æ„ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œå¸¦è¡Œæ ‡ç­¾å’Œåˆ—æ ‡ç­¾çš„è¡¨æ ¼æ•°æ®â€ã€‚å¦‚æœè¯´ Series æœ‰ç‚¹åƒ Excel ä¸­çš„ä¸€åˆ—ï¼Œé‚£ä¹ˆ DataFrame å°±åƒæ•´ä¸ªè¡¨æ ¼ï¼ˆç”±å¤šåˆ—ç»„æˆï¼‰ï¼ŒåŒæ—¶æ‹¥æœ‰è¡Œç´¢å¼•ï¼ˆindexï¼‰å’Œåˆ—åï¼ˆcolumnsï¼‰ã€‚DataFrame ä¹Ÿå¯ä»¥çœ‹ä½œç”±å¤šä¸ªå…±äº«åŒä¸€ä¸ªç´¢å¼•çš„ Series ç»„æˆçš„å­—å…¸ï¼Œæ¯ä¸€åˆ—æ˜¯ä¸€ä¸ª Seriesï¼Œåˆ—åæ˜¯å­—å…¸çš„é”®ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ª DataFrame å¯ä»¥ç”¨æ¥è¡¨ç¤ºå¤šä¸ªäººçš„è‹¥å¹²å±æ€§ï¼Œä¾‹å¦‚å§“åã€å¹´é¾„ã€æ€§åˆ«ï¼Œæ¯ä¸€åˆ—æ˜¯ä¸€ç§å±æ€§ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªäººã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼æ¥æ„é€  DataFrameï¼Œå¸¸è§çš„æ–¹æ³•åŒ…æ‹¬ï¼šç”±å­—å…¸ã€ç”±åˆ—è¡¨ç»„æˆçš„åˆ—è¡¨ã€ç”±å¤šä¸ª Series ç­‰ã€‚ä¸‹é¢é€šè¿‡ä»£ç æ¥æ¼”ç¤º DataFrame çš„åˆ›å»ºå’ŒåŸºæœ¬å±æ€§ã€‚</p>
<blockquote><code>import pandas as pd</code><br>
<code></code><br>
<code># é€šè¿‡å­—å…¸åˆ›å»º DataFrameï¼Œæ¯ä¸ªé”®ä»£è¡¨ä¸€åˆ—</code><br>
<code>data = {</code><br>
<code>    &#039;Name&#039;: [&#039;Tom&#039;, &#039;Jerry&#039;, &#039;Jack&#039;, &#039;Rose&#039;],</code><br>
<code>    &#039;Age&#039;: [18, 18, 20, 20]</code><br>
<code>}</code><br>
<code>df = pd.DataFrame(data)</code><br>
<code>print(df)</code><br>
<code># è¾“å‡º:</code><br>
<code>#    Name  Age</code><br>
<code># 0   Tom   18</code><br>
<code># 1 Jerry   18</code><br>
<code># 2  Jack   20</code><br>
<code># 3  Rose   20</code></blockquote><p>ä¸Šé¢ç”¨å­—å…¸åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ DataFrame dfï¼ŒåŒ…å«ä¸¤åˆ—ï¼šName å’Œ Ageã€‚å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šç´¢å¼•ï¼ŒPandas è‡ªåŠ¨ç”¨äº†é»˜è®¤çš„æ•´æ•°ç´¢å¼• 0,1,2,3ã€‚å¯ä»¥çœ‹åˆ° DataFrame æ‰“å°è¾“å‡ºæ—¶ï¼Œä¼šæ˜¾ç¤ºè¡Œç´¢å¼•å’Œåˆ—åï¼Œä»¥åŠæ¯ä¸ªå•å…ƒæ ¼çš„æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè‡ªå·±çš„ç´¢å¼•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç”¨ a, b, c, d ä½œä¸ºæ¯è¡Œçš„ç´¢å¼•æ ‡ç­¾ï¼Œå¯ä»¥ä¼ å…¥å‚æ•° index= æ¥æŒ‡å®šï¼›å¦å¤–ç”¨ columns= å¯ä»¥æŒ‡å®šåˆ—åçš„é¡ºåºã€‚ä¸‹é¢æˆ‘ä»¬æ„é€ ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ DataFrameï¼šå¤šåŠ ä¸€åˆ— Genderï¼Œå¹¶ä¸”è®©ä¸åŒåˆ—æ¥è‡ªä¸åŒé•¿åº¦çš„ Seriesï¼Œä»¥æ¼”ç¤º Pandas ä¼šå¦‚ä½•å¯¹é½æ•°æ®ã€‚</p>
<blockquote><code># ç”¨å­—å…¸åŒ…å«å¤šä¸ª Series æ¥åˆ›å»º DataFrameï¼Œå„ Series æŒ‰ç´¢å¼•è‡ªåŠ¨å¯¹é½</code><br>
<code>data2 = {</code><br>
<code>    &#039;Name&#039;: pd.Series([&#039;Tom&#039;, &#039;Jerry&#039;, &#039;Jack&#039;, &#039;Rose&#039;], index=[&#039;a&#039;, &#039;b&#039;, &#039;c&#039;, &#039;d&#039;]),</code><br>
<code>    &#039;Age&#039;: pd.Series([18, 18, 20], index=[&#039;a&#039;, &#039;b&#039;, &#039;c&#039;]),      # å°‘äº†ç´¢å¼• &#039;d&#039;</code><br>
<code>    &#039;Gender&#039;: pd.Series([&#039;M&#039;, &#039;M&#039;, &#039;F&#039;], index=[&#039;a&#039;, &#039;c&#039;, &#039;d&#039;]) # å°‘äº†ç´¢å¼• &#039;b&#039;</code><br>
<code>}</code><br>
<code>df2 = pd.DataFrame(data2)</code><br>
<code>print(df2)</code><br>
<code># è¾“å‡º:</code><br>
<code>#   Name   Age Gender</code><br>
<code># a   Tom  18.0      M</code><br>
<code># b Jerry  18.0    NaN</code><br>
<code># c  Jack  20.0      F</code><br>
<code># d  Rose   NaN      M</code></blockquote><p>åœ¨è¿™ä¸ª df2 DataFrame ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº†ç´¢å¼•ä¸º &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;ã€‚Name åˆ—æœ‰è¿™å››ä¸ªç´¢å¼•çš„å€¼ï¼Œä½† Age åˆ—ç¼ºå°‘ &#39;d&#39;çš„å€¼ï¼ŒGender åˆ—ç¼ºå°‘ &#39;b&#39;çš„å€¼ã€‚Pandas ä¼šæ ¹æ®ç´¢å¼•è‡ªåŠ¨å¯¹é½ä¸åŒåˆ—çš„æ•°æ®ï¼šå¯¹äºç¼ºå¤±çš„ä½ç½®ä»¥ NaN å¡«å……ã€‚ä¸Šé¢è¾“å‡ºä¸­ï¼Œç´¢å¼• b çš„ Gender æ˜¾ç¤ºä¸º NaNï¼ˆå› ä¸ºæ²¡æœ‰æä¾› b å¯¹åº”çš„ Genderï¼‰ï¼Œç´¢å¼• d çš„ Age ä¸º NaNï¼ˆæ²¡æœ‰æä¾› d å¯¹åº”çš„ Ageï¼‰ã€‚NaN è¡¨ç¤ºç¼ºå¤±å€¼ï¼Œåœ¨ Pandas ä¸­æ˜¯ä¸€ç§ç‰¹æ®Šçš„æµ®ç‚¹å‹å€¼ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š ç”±ä¸Šè¿°ä¾‹å­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒDataFrame ä¸­æ¯åˆ—æ•°æ®å¯ä»¥æ˜¯ä¸åŒç±»å‹ï¼ˆName æ˜¯å­—ç¬¦ä¸²ï¼ŒAge æ˜¯æ•°å­—ï¼ŒGender æ˜¯å­—ç¬¦ä¸²ï¼‰ã€‚å½“æŸåˆ—å‡ºç° NaN æ—¶ï¼Œè¯¥åˆ—ä¼šè¢«Upcastä¸ºæµ®ç‚¹å‹ï¼Œå› ä¸º NaN è¢«è§†ä½œæµ®ç‚¹ç±»å‹ç‰¹æ®Šå€¼ã€‚ä¾‹å¦‚ Age åˆ—æœ¬æ¥æ˜¯æ•´æ•°ï¼Œä¸€æ—¦å‡ºç° NaNï¼Œå°±å˜æˆäº† floatã€‚</p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬ä¸æƒ³è®©æŸäº›å€¼ç¼ºå¤±ï¼Œå¯ä»¥åœ¨åˆ›å»º DataFrame æ—¶æä¾›å®Œæ•´çš„æ•°æ®ï¼Œå¯¹é½ç´¢å¼•ã€‚æˆ–è€…åˆ›å»ºåå†æ‰‹åŠ¨å¡«å……ç¼ºå¤±å€¼ã€‚ä½†è¿™äº›å±äºåç»­å¤„ç†èŒƒç•´ã€‚</p>
<h3>DataFrame çš„å±æ€§å’ŒåŸºæœ¬æ“ä½œ</h3>
<p>ç±»ä¼¼äº Seriesï¼ŒDataFrame æä¾›äº†è®¸å¤šå±æ€§å’Œæ–¹æ³•æ–¹ä¾¿æˆ‘ä»¬äº†è§£æ•°æ®é›†çš„æ€»ä½“æƒ…å†µï¼š</p>
<ul>
<li><code>df.index</code>ï¼šè·å–è¡Œç´¢å¼•(Indexå¯¹è±¡)ã€‚</li>
<li><code>df.columns</code>ï¼šè·å–åˆ—å(Indexå¯¹è±¡)ã€‚</li>
<li><code>df.values</code>ï¼šä»¥äºŒç»´ numpy æ•°ç»„çš„å½¢å¼è·å–è¡¨æ ¼ä¸­çš„å€¼ã€‚</li>
<li><code>df.shape</code>ï¼šè¿”å› (è¡Œæ•°, åˆ—æ•°) çš„å…ƒç»„ã€‚</li>
<li><code>df.dtypes</code>ï¼šè·å–æ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹ã€‚</li>
<li><code>df.size</code>ï¼šè¿”å›å…ƒç´ æ€»æ•° (è¡Œæ•° Ã— åˆ—æ•°)ã€‚</li>
<li><code>df.empty</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤º DataFrame æ˜¯å¦ä¸ºç©ºï¼ˆæ²¡æœ‰ä»»ä½•æ•°æ®ï¼‰ã€‚</li>
<li><code>df.head(n)</code>ï¼šæŸ¥çœ‹å‰ n è¡Œæ•°æ®ï¼ˆé»˜è®¤ n=5ï¼‰ã€‚</li>
<li><code>df.tail(n)</code>ï¼šæŸ¥çœ‹æœ€å n è¡Œæ•°æ®ã€‚</li>
<li><code>df.describe()</code>ï¼šå¯¹æ•°å€¼åˆ—è¿›è¡Œç»Ÿè®¡æ±‡æ€»ï¼ˆè®¡æ•°ã€å‡å€¼ã€æ ‡å‡†å·®ã€æœ€å°å€¼ã€å››åˆ†ä½æ•°ç­‰ï¼‰ã€‚</li>
<li><code>df.T</code>ï¼šè·å–è½¬ç½®çš„ DataFrameï¼ˆè¡Œåˆ—äº’æ¢ï¼‰ã€‚</li>
</ul>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ df2 çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š</p>
<blockquote><code>print(df2.index)    # Index([&#039;a&#039;, &#039;b&#039;, &#039;c&#039;, &#039;d&#039;], dtype=&#039;object&#039;)</code><br>
<code>print(df2.columns)  # Index([&#039;Name&#039;, &#039;Age&#039;, &#039;Gender&#039;], dtype=&#039;object&#039;)</code><br>
<code>print(df2.shape)    # (4, 3) -&gt; 4 è¡Œ 3 åˆ—</code><br>
<code>print(df2.dtypes)   </code><br>
<code># Name      object</code><br>
<code># Age      float64</code><br>
<code># Gender    object</code><br>
<code># dtype: object</code><br>
<code># ... (16 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><p>è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼šindex å’Œ columns åˆ—å‡ºäº† DataFrame çš„ç´¢å¼•å’Œåˆ—æ ‡ç­¾ï¼Œshapeè¯´æ˜æœ‰4è¡Œ3åˆ—ã€‚dtypesè¡¨æ˜ Name å’Œ Gender æ˜¯objectç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼ŒAgeæ˜¯float64ã€‚head(2)è¾“å‡ºäº†å‰ä¸¤è¡Œæ•°æ®ï¼Œdescribe()åˆ™å¯¹ Age åˆ—ç»™å‡ºäº†ç»Ÿè®¡æ‘˜è¦ï¼ˆå› ä¸º Name å’Œ Gender éæ•°å­—åˆ—è¢«è‡ªåŠ¨å¿½ç•¥ï¼‰ã€‚</p>
<p>äº†è§£äº† Series å’Œ DataFrame çš„åŸºæœ¬ç»“æ„ï¼Œä¸‹é¢æˆ‘ä»¬è¿›å…¥æ›´å…·ä½“çš„å¢åˆ æ”¹æŸ¥æ“ä½œï¼Œä»¥ DataFrame ä¸ºä¸­å¿ƒè¿›è¡Œè®²è§£ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨åˆšæ‰åˆ›å»ºçš„ df2 æ¥æ¼”ç¤ºã€‚</p>
<h2>åˆ—æ“ä½œ CRUD</h2>
<p>é€šå¸¸æˆ‘ä»¬éœ€è¦å¯¹ DataFrame çš„åˆ—è¿›è¡Œå„ç§æ“ä½œï¼Œä¾‹å¦‚è¯»å–æŸå‡ åˆ—æ•°æ®ã€æ·»åŠ æ–°åˆ—ã€ä¿®æ”¹å·²æœ‰åˆ—æˆ–è€…åˆ é™¤åˆ—ã€‚DataFrame åœ¨åˆ—æ“ä½œä¸Šéå¸¸ç±»ä¼¼äº Python çš„å­—å…¸ï¼šæŠŠ DataFrame å½“åšä¸€ä¸ªå­—å…¸çš„è¯ï¼Œé”®å°±æ˜¯åˆ—åï¼Œå€¼æ˜¯ä¸€åˆ—æ•°æ®ï¼ˆä¸€ä¸ª Seriesï¼‰ã€‚å› æ­¤è®¸å¤šåˆ—æ“ä½œå¯ä»¥ç±»æ¯”ä¸ºå­—å…¸æ“ä½œæ¥è®°å¿†ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æŒ‰ç…§æŸ¥ï¼ˆè¯»å–ï¼‰ã€å¢ï¼ˆæ·»åŠ ï¼‰ã€æ”¹ï¼ˆä¿®æ”¹ï¼‰ã€åˆ ï¼ˆåˆ é™¤ï¼‰çš„é¡ºåºï¼Œæ¼”ç¤ºåˆ—çš„å¸¸è§æ“ä½œã€‚</p>
<p>æŸ¥ï¼ˆè¯»å–åˆ—ï¼‰ï¼š DataFrame å¯ä»¥é€šè¿‡åˆ—åæ¥è·å–åˆ—æ•°æ®ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨æ–¹æ‹¬å· <code>df[&#39;åˆ—å&#39;]</code>ï¼Œè¿™ä¼šè¿”å›ä¸€ä¸ª Seriesï¼ŒåŒ…å«è¯¥åˆ—çš„æ‰€æœ‰æ•°æ®å’Œå¯¹åº”çš„è¡Œç´¢å¼•ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªåˆ—ååˆ—è¡¨ <code>df[[&#39;åˆ—å1&#39;,&#39;åˆ—å2&#39;]]</code> æ¥ä¸€æ¬¡è·å–å¤šåˆ—æ•°æ®ï¼ˆæ­¤æ—¶è¿”å›ä¸€ä¸ªæ–°çš„ DataFrameï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨åˆ‡ç‰‡ <code>df[&#39;col1&#39;:&#39;col3&#39;]</code> æ¥é€‰å–å¤šåˆ—ï¼Œæ–¹æ‹¬å·ä¸­å¦‚æœç»™çš„æ˜¯åˆ‡ç‰‡ä¼šè¢«è§£é‡Šä¸ºè¡Œåˆ‡ç‰‡ï¼ˆè¿™æ˜¯ä¸ºäº†ä¿æŒè¯­ä¹‰ç®€å•ä¸€è‡´ï¼Œæ–¹æ‹¬å·ç›´æ¥ç´¢å¼•é»˜è®¤ä¸ºåˆ—ï¼Œåˆ‡ç‰‡ç¬¦å·é»˜è®¤ä¸ºè¡Œåˆ‡ç‰‡ï¼Œè¿™ç‚¹ç»†èŠ‚ç¨å¾®æœ‰ç‚¹åç›´è§‰ï¼‰ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹å…·ä½“ä¾‹å­ï¼š</p>
<blockquote><code>df = df2  # ç»§ç»­ä½¿ç”¨å‰é¢çš„ df2: æœ‰ Name, Age, Gender ä¸‰åˆ—ï¼Œç´¢å¼• a,b,c,d</code><br>
<code></code><br>
<code># è®¿é—®å•åˆ—æ•°æ®</code><br>
<code>name_col = df[&#039;Name&#039;]</code><br>
<code>print(name_col)           # è·å– Name åˆ—ï¼ˆç±»å‹ä¸º Seriesï¼‰</code><br>
<code></code><br>
<code># è®¿é—®å¤šåˆ—æ•°æ®</code><br>
<code>subset = df[[&#039;Name&#039;, &#039;Age&#039;]]</code><br>
<code>print(subset)             # è·å– Name å’Œ Age ä¸¤åˆ—ï¼Œè¿”å› DataFrame</code><br>
<code></code><br>
<code># åˆ©ç”¨ df.columns å¾—åˆ°åˆ—ååˆ—è¡¨ï¼Œæ¯”å¦‚å»æ‰æœ€åä¸€åˆ—:</code><br>
<code>print(df[df.columns[:-1]])# è·å–é™¤æœ€åä¸€åˆ—å¤–çš„æ‰€æœ‰åˆ—</code></blockquote><p>è¾“å‡ºï¼ˆçœç•¥éƒ¨åˆ†ï¼‰å°†å±•ç¤º name_col æ˜¯ä¸€ä¸ª Seriesï¼Œå†…å®¹å°±æ˜¯æ¯ä¸ªç´¢å¼•å¯¹åº”çš„ Nameï¼›è€Œ subset æ˜¯ä¸€ä¸ª DataFrameï¼ŒåŒ…å«ä¸¤åˆ— Name å’Œ Ageã€‚æœ€åä¸€è¡Œé€šè¿‡ df.columns[:-1] åˆ‡ç‰‡æ‹¿åˆ°äº†é™¤æœ€åä¸€åˆ—ï¼ˆGenderï¼‰ä»¥å¤–çš„åˆ—ååˆ—è¡¨ï¼Œå®ç°äº†è·å–å¤šåˆ—çš„å¦ä¸€ç§æ–¹æ³•ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒPandas å…è®¸é€šè¿‡å±æ€§è®¿é—®çš„æ–¹å¼è·å–åˆ—ï¼Œä¾‹å¦‚ df.Name å¯ä»¥ç›´æ¥å¾—åˆ° Name åˆ—ï¼Œè¿™è·Ÿ df[&#39;Name&#39;] æ˜¯ç­‰ä»·çš„ï¼ˆå‰ææ˜¯åˆ—åæ˜¯åˆæ³•çš„ Python æ ‡è¯†ç¬¦ä¸”ä¸ä¸ç°æœ‰å±æ€§æ–¹æ³•åŒåï¼‰ã€‚ä½†æ˜¯å¦‚æœåˆ—ååŒ…å«ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ï¼Œæˆ–è€…ç¢°å·§å’Œ DataFrame çš„æ–¹æ³•åå†²çªï¼Œå°±ä¸èƒ½ç”¨ç‚¹å±æ€§è®¿é—®ã€‚å»ºè®®åˆå­¦è€…è¿˜æ˜¯ä½¿ç”¨ df[...] è¿™ç§æ˜ç¡®çš„æ–¹å¼ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š å¦‚æœåˆ—åä¸­åŒ…å«ç©ºæ ¼ï¼Œæ¯”å¦‚ &quot;Total Sales&quot; è¿™ç§ï¼Œä¸èƒ½ç”¨ df.Total Salesï¼ˆä¼šè¯­æ³•é”™è¯¯æˆ–è§£æé”™è¯¯ï¼‰ï¼Œæ­¤æ—¶å¿…é¡»ç”¨ df[&#39;Total Sales&#39;] æ¥è®¿é—®ã€‚åŒæ ·åœ°ï¼Œåˆ—ååŒ…å«ç‚¹å·ã€å‡å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œæˆ–åˆ—åå«maxã€countç­‰ä¸DataFrameæ–¹æ³•é‡åï¼Œä¹Ÿåªèƒ½ä½¿ç”¨ df[&#39;åˆ—å&#39;] çš„æ–¹å¼ã€‚å¦‚æœæƒ³æ–¹ä¾¿åœ°ç”¨ç‚¹è®¿é—®ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ç»Ÿä¸€ä¿®æ”¹åˆ—åï¼Œä¾‹å¦‚ç”¨ <code>df.columns = df.columns.str.replace(&#39; &#39;, &#39;_&#39;)</code> å°†ç©ºæ ¼æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œæˆ–è€…ä½¿ç”¨ df.rename é‡å‘½ååˆ—ã€‚</p>
</blockquote>
<p>å¢ï¼ˆæ·»åŠ åˆ—ï¼‰ï¼š å‘ DataFrame å¢åŠ æ–°åˆ—ä¹Ÿå¾ˆç›´è§‚ï¼šç›´æ¥åƒå­—å…¸èµ‹å€¼ä¸€æ · <code>df[&#39;æ–°åˆ—å&#39;] = ...</code> å³å¯ã€‚èµ‹å€¼çš„â€œâ€¦â€å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>ä¸€ä¸ªå›ºå®šå€¼ï¼šåˆ™æ•´åˆ—éƒ½ä¼šè¢«è¿™ä¸ªå€¼å¡«å……ã€‚</li>
<li>ä¸€ä¸ªåˆ—è¡¨æˆ– ndarrayï¼šé•¿åº¦éœ€è¦è·Ÿ DataFrame çš„è¡Œæ•°ç›¸ç­‰ï¼Œæ•°æ®ä¼šæŒ‰é¡ºåºå¡«å……è¿™ä¸€åˆ—ã€‚</li>
<li>ä¸€ä¸ª Pandas çš„ Seriesï¼šå¦‚æœ Series çš„ç´¢å¼•èƒ½å¯¹é½ DataFrame çš„ç´¢å¼•ï¼Œé‚£ä¹ˆä¼šæ ¹æ®ç´¢å¼•åŒ¹é…å¡«å……ï¼Œç´¢å¼•æ²¡æœ‰å¯¹åº”ä¸Šçš„ä½ç½®å°†å‡ºç° NaNã€‚</li>
</ul>
<p>ä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§æ·»åŠ å¤šåˆ—ã€‚Pandas æä¾›äº† pd.concat æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥æŠŠä¸¤ä¸ªDataFrameæŒ‰åˆ—æ–¹å‘æ‹¼æ¥ï¼ˆaxis=1ï¼‰ä»è€Œå¢åŠ æ–°åˆ—ã€‚æ­¤å¤–ï¼Œdf.assign() æ–¹æ³•ä¹Ÿå¯ä»¥åŒæ—¶æ·»åŠ å¤šåˆ—ï¼Œä¸è¿‡è¿™é‡Œä¸å±•å¼€ã€‚ä¸‹é¢é€šè¿‡ä»£ç æ¼”ç¤ºå„ç§æ·»åŠ åˆ—çš„æ–¹å¼ï¼š</p>
<blockquote><code># åŸå§‹ DataFrame å›é¡¾:</code><br>
<code>print(df)</code><br>
<code>#   Name   Age Gender</code><br>
<code># a   Tom  18.0      M</code><br>
<code># b Jerry  18.0    NaN</code><br>
<code># c  Jack  20.0      F</code><br>
<code># d  Rose   NaN      M</code><br>
<code></code><br>
<code># ... (33 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><p>ä¸Šé¢çš„æ“ä½œä¾æ¬¡ç»™ DataFrame æ·»åŠ äº† Math åˆ—ï¼ˆæ‰€æœ‰å€¼ç›¸åŒï¼‰ï¼ŒEnglish åˆ—ï¼ˆåªæœ‰ç´¢å¼• a,b,d æœ‰å€¼ï¼Œc è‡ªåŠ¨è¡¥NaNï¼‰ï¼Œä»¥åŠé€šè¿‡ pd.concat ä¸€æ¬¡æ‹¼æ¥ä¸¤ä¸ªæ–°åˆ— Chinese å’Œ P.E.ã€‚éœ€è¦ç•™æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† &#39;P.E.&#39; ä½œä¸ºåˆ—åï¼Œè¿™é‡ŒåŒ…å«äº†ä¸€ä¸ªç‚¹å·ï¼Œä»Šåè®¿é—® P.E. åˆ—å°±ä¸èƒ½ç”¨ df.P.E.ï¼ˆä¼šè¢«è§£é‡Šæˆè¿ç»­çš„å±æ€§è®¿é—®è€Œå‡ºé”™ï¼‰ï¼Œåªèƒ½ç”¨ df[&#39;P.E.&#39;]ã€‚è¿™å†æ¬¡è¯´æ˜äº†åˆ—åå‘½åçš„è§„èŒƒæ€§é‡è¦æ€§ã€‚</p>
<p>æ”¹ï¼ˆä¿®æ”¹åˆ—ï¼‰ï¼š ä¿®æ”¹åˆ—çš„å€¼å®é™…ä¸Šå’Œæ·»åŠ åˆ—æ˜¯ä¸€æ ·çš„æ“ä½œâ€”â€”ç”¨æ–°çš„å€¼èµ‹å€¼ç»™å·²æœ‰çš„åˆ—åã€‚å¦‚æœè¯¥åˆ—å­˜åœ¨ï¼Œå°±ä¼šè¢«æ–°å€¼è¦†ç›–ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºåˆ—ã€‚å› æ­¤åœ¨è¯­æ³•ä¸Šæ²¡æœ‰ä¸“é—¨çš„â€œæ”¹åˆ—â€æ–¹æ³•ï¼Œç›´æ¥èµ‹å€¼å³å¯ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆšåˆšæ·»åŠ çš„ Chinese åˆ—çš„åˆ†æ•°å…¨éƒ¨æ”¹æˆ 100ï¼š</p>
<blockquote><code>df[&#039;Chinese&#039;] = [100, 100, 100, 100]</code><br>
<code>print(df)</code><br>
<code># Chinese åˆ—çš„å€¼å·²æ›´æ–°ä¸º100:</code><br>
<code>#   Name   Age Gender  Math  English  Chinese  P.E.</code><br>
<code># a   Tom  18.0      M   100     95.0      100    60</code><br>
<code># b Jerry  18.0    NaN   100     96.0      100    60</code><br>
<code># c  Jack  20.0      F   100      NaN      100    60</code><br>
<code># d  Rose   NaN      M   100     97.0      100    60</code></blockquote><p>è¿™é‡Œå°† df[&#39;Chinese&#39;] ç›´æ¥èµ‹å€¼ä¸ºæ–°çš„åˆ—è¡¨ï¼Œ[100,100,100,100]ï¼Œè¾¾åˆ°äº†ä¿®æ”¹æ•´åˆ—çš„ç›®çš„ã€‚åŒæ ·åœ°ï¼Œä½ ä¹Ÿå¯ä»¥åªä¿®æ”¹æŸå‡ ä¸ªå€¼ï¼Œæ¯”å¦‚ä½¿ç”¨æŒ‰è¡Œç´¢å¼•çš„ .loc æ¥å®šä½å†èµ‹å€¼ï¼Œè¿™å±äºâ€œè¡Œæ“ä½œâ€èŒƒç•´ï¼Œæˆ‘ä»¬ç¨åä»‹ç»ã€‚</p>
<p>åˆ ï¼ˆåˆ é™¤åˆ—ï¼‰ï¼š åˆ é™¤ DataFrame çš„åˆ—æœ‰å¤šç§æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>del df[&#39;åˆ—å&#39;]</code>ï¼Œå°±åƒåˆ é™¤å­—å…¸é”®ä¸€æ ·ã€‚</li>
<li>ä½¿ç”¨ <code>df.pop(&#39;åˆ—å&#39;)</code>ï¼Œä¼šè¿”å›è¢«åˆ é™¤çš„åˆ—çš„ Seriesã€‚</li>
<li>ä½¿ç”¨ <code>df.drop(columns=[...])</code> æˆ– <code>df.drop([...], axis=1)</code>ï¼Œå¯ä»¥ä¸€æ¬¡åˆ é™¤ä¸€åˆ—æˆ–å¤šåˆ—ã€‚drop é»˜è®¤è¿”å›ä¸€ä¸ªæ–°çš„ DataFrameï¼Œé™¤éæŒ‡å®š inplace=True åŸåœ°åˆ é™¤ã€‚</li>
</ul>
<p>ä¸‹é¢ä¾æ¬¡æ¼”ç¤ºç”¨ä¸Šè¿°æ–¹æ³•åˆ é™¤æˆ‘ä»¬ä¸éœ€è¦çš„åˆ—ï¼š</p>
<blockquote><code># 1. del å…³é”®å­—åˆ é™¤åˆ—</code><br>
<code>del df[&#039;P.E.&#039;]</code><br>
<code>print(df.columns)  # Index([&#039;Name&#039;, &#039;Age&#039;, &#039;Gender&#039;, &#039;Math&#039;, &#039;English&#039;, &#039;Chinese&#039;], dtype=&#039;object&#039;)</code><br>
<code></code><br>
<code># 2. pop æ–¹æ³•åˆ é™¤åˆ—</code><br>
<code>df.pop(&#039;Chinese&#039;)</code><br>
<code>print(df.columns)  # Index([&#039;Name&#039;, &#039;Age&#039;, &#039;Gender&#039;, &#039;Math&#039;, &#039;English&#039;], dtype=&#039;object&#039;)</code><br>
<code></code><br>
<code># ... (9 more lines)</code></blockquote>
<p><em>Full code available in the <a href="https://github.com/geyuxu">GitHub repository</a>.</em></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå…ˆç”¨ del åˆ æ‰äº† P.E. åˆ—ï¼Œç„¶åç”¨ pop åˆ æ‰ Chinese åˆ—ï¼Œæœ€åç”¨ drop ä¸€æ¬¡æ€§åˆ æ‰ Math å’Œ English åˆ—ã€‚åˆ é™¤åæˆ‘ä»¬çš„ DataFrame åˆåªå‰©ä¸‹æœ€åˆçš„ä¸‰åˆ—ï¼ˆName, Age, Genderï¼‰ä»¥åŠåŸæ¥çš„è¡Œç´¢å¼•ã€‚ä½¿ç”¨ drop æ—¶è®°å¾—åŠ  axis=1 è¡¨ç¤ºæŒ‰åˆ—åˆ é™¤ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ˜¯å¦ inplaceã€‚å¦‚æœä¸ä½¿ç”¨ inplaceï¼Œé‚£ä¹ˆåº”å½“ç”¨ df = df.drop([...], axis=1) èµ‹å€¼å›å»ï¼Œå› ä¸º drop é»˜è®¤è¿”å›åˆ é™¤æŒ‡å®šåˆ—åçš„æ–° DataFrameã€‚</p>
<h2>è¡Œæ“ä½œ CRUD</h2>
<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹è¡¨æ ¼çš„è¡Œè¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚æŒ‰è¡ŒæŸ¥çœ‹æ•°æ®ã€æ·»åŠ æˆ–åˆ é™¤æŸäº›è¡Œç­‰ã€‚è¡Œçš„æ“ä½œåœ¨ Pandas ä¸­ä¸»è¦é€šè¿‡ç´¢å¼•ï¼ˆindexï¼‰æ¥å®šä½ï¼Œåˆ†ä¸ºæŒ‰æ ‡ç­¾ç´¢å¼•ï¼ˆindex labelï¼‰å’ŒæŒ‰æ•´æ•°ä½ç½®ç´¢å¼•ä¸¤å¤§æ–¹å¼ã€‚</p>
<p>å¯¹è¡Œçš„â€œæŸ¥ã€å¢ã€æ”¹ã€åˆ â€ï¼Œæˆ‘ä»¬åˆ†åˆ«ä»‹ç»ã€‚ç»§ç»­ä½¿ç”¨å‰é¢çš„ DataFrameï¼ˆç›®å‰æœ‰ Name, Age, Gender åˆ—ï¼Œç´¢å¼• a, b, c, dï¼‰ï¼Œæ¥æ¼”ç¤ºè¡Œæ“ä½œã€‚</p>
<p>æŸ¥ï¼ˆè¯»å–è¡Œï¼‰ï¼š å’Œåˆ—ä¸åŒï¼Œç›´æ¥ä½¿ç”¨ df[...] çš„æ–¹æ‹¬å·ä¸èƒ½ç›´æ¥æŒ‰è¡Œæ ‡ç­¾å–è¡Œã€‚æ¯”å¦‚ df[&#39;a&#39;] å¹¶ä¸ä¼šè¿”å›ç´¢å¼•ä¸º a çš„é‚£ä¸€è¡Œï¼Œè€Œæ˜¯è¯•å›¾å–åä¸º â€˜aâ€™ çš„åˆ—ï¼ˆé€šå¸¸ä¸å­˜åœ¨ï¼Œä¼šæŠ¥é”™ï¼‰ã€‚å› æ­¤ï¼ŒPandas æä¾›äº†ä¸“é—¨çš„ç´¢å¼•å™¨å±æ€§ï¼š</p>
<ul>
<li><code>df.loc[è¡Œæ ‡ç­¾]</code> ç”¨è¡Œæ ‡ç­¾é€‰å–æ•°æ®ã€‚</li>
<li><code>df.iloc[è¡Œå·]</code> ç”¨è¡Œä½ç½®ï¼ˆæ•´æ•°ä¸‹æ ‡ï¼‰é€‰å–æ•°æ®ã€‚</li>
</ul>
<p>è¿™ä¸¤ä¸ªç´¢å¼•å™¨éå¸¸é‡è¦ï¼šloc åŸºäºæ ‡ç­¾ï¼Œiloc åŸºäºæ•´æ•°ä½ç½®ã€‚ä½¿ç”¨å®ƒä»¬æˆ‘ä»¬å¯ä»¥éå¸¸çµæ´»åœ°æŒ‰è¡Œæˆ–æŒ‰è¡Œåˆ—ç»„åˆé€‰å–æ•°æ®ã€‚</p>
<p>loc ç”¨æ³•ç¤ºä¾‹ï¼š</p>
<blockquote><code># ä½¿ç”¨ loc æŒ‰æ ‡ç­¾ç´¢å¼•è¡Œ</code><br>
<code>print(df.loc[&#039;a&#039;])         # ç´¢å¼•ä¸º &#039;a&#039; çš„æ•´è¡Œæ•°æ®ï¼Œè¿”å›ä¸€ä¸ª Series</code><br>
<code>print(df.loc[&#039;b&#039;:&#039;c&#039;])     # ä»ç´¢å¼• &#039;b&#039; åˆ° &#039;c&#039; çš„è¡Œï¼ˆåŒ…æ‹¬ &#039;c&#039; è¡Œï¼‰</code><br>
<code>print(df.loc[[&#039;a&#039;, &#039;c&#039;], [&#039;Name&#039;, &#039;Gender&#039;]])</code><br>
<code># ä¸Šé¢ä¸€è¡Œé€‰å–ç´¢å¼• a å’Œ c çš„ä¸¤è¡Œï¼Œä¸”åªå–å…¶ä¸­çš„ Name å’Œ Gender ä¸¤åˆ—</code></blockquote><p>iloc ç”¨æ³•ç¤ºä¾‹ï¼š</p>
<blockquote><code># ä½¿ç”¨ iloc æŒ‰ä½ç½®ç´¢å¼•è¡Œ</code><br>
<code>print(df.iloc[0])          # ç¬¬ 0 å·ä½ç½®çš„è¡Œï¼ˆå³ç´¢å¼• &#039;a&#039; è¿™ä¸€è¡Œï¼‰</code><br>
<code>print(df.iloc[1:3])        # ä½ç½® 1 åˆ° 2 çš„è¡Œï¼ˆä¸åŒ…æ‹¬ä½ç½®3ï¼‰ï¼Œå¯¹åº”ç´¢å¼• b, c ä¸¤è¡Œ</code><br>
<code>print(df.iloc[[0, 2], [0, 2]])</code><br>
<code># ä¸Šé¢ä¸€è¡Œé€‰å–ä½ç½® 0 å’Œ 2 çš„ä¸¤è¡Œï¼Œä»¥åŠä½ç½® 0 å’Œ 2 çš„ä¸¤åˆ—ï¼Œå®ç°è¡Œåˆ—äº¤å‰é€‰å–</code></blockquote><p>loc å’Œ iloc éƒ½å¯ä»¥æ¥å—å•ä¸ªç´¢å¼•ã€åˆ‡ç‰‡ã€åˆ—è¡¨ç­‰å½¢å¼æ¥é€‰å–å¤šè¡Œ/å¤šåˆ—ï¼Œéå¸¸çµæ´»ã€‚éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š</p>
<ul>
<li>ç”¨ loc åšæ ‡ç­¾åˆ‡ç‰‡æ—¶ï¼ŒåŒºé—´ä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´ï¼Œä¹Ÿå°±æ˜¯åŒ…å«ç»“æŸæ ‡ç­¾ã€‚ä¾‹å¦‚ä¸Šä¾‹ä¸­ <code>df.loc[&#39;b&#39;:&#39;c&#39;]</code> åŒ…å« â€˜câ€™ è¡Œã€‚</li>
<li>ç”¨ iloc åšä½ç½®åˆ‡ç‰‡åˆ™å’Œ Python åˆ—è¡¨åˆ‡ç‰‡è§„åˆ™ä¸€è‡´ï¼Œå·¦é—­å³å¼€ï¼Œä¸åŒ…å«ç»“æŸçš„ç´¢å¼•ä½ç½®ã€‚</li>
<li>iloc å…è®¸ç´¢å¼•åˆ—è¡¨ä¸­æœ‰é‡å¤å€¼æˆ–é¡ºåºæ‰“ä¹±ï¼Œè¿™ç§æƒ…å†µä¸‹ä¼šç›¸åº”è¿”å›é‡å¤æˆ–ä¹±åºçš„è¡Œã€‚è¿™åœ¨éœ€è¦æ ¹æ®ä½ç½®é‡å¤æ•°æ®æ—¶å¯èƒ½æœ‰ç”¨ã€‚</li>
<li>å¦‚æœ DataFrame çš„ç´¢å¼•æ˜¯æ•°å­—ä¸”ä½ ç”¨ df[some_number] ç›´æ¥ç´¢å¼•ï¼ŒPandasä¼šä¼˜å…ˆå°è¯•æŒ‰æ ‡ç­¾è§£æï¼ˆå› ä¸ºç´¢å¼•å¯èƒ½æ­£å¥½æ˜¯é‚£ä¸ªæ•°å­—ï¼‰ã€‚å› æ­¤å½“ç´¢å¼•æ˜¯æ•°å­—æ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„åŒºåˆ† locï¼ˆæŒ‰æ ‡ç­¾ï¼‰å’Œé»˜è®¤çš„[]è¡Œä¸ºã€‚æœ€å®‰å…¨çš„åšæ³•æ˜¯å§‹ç»ˆä½¿ç”¨ loc æˆ– iloc æ¥å–è¡Œï¼Œé¿å…æ­§ä¹‰ã€‚</li>
</ul>
<p>å¢ï¼ˆæ·»åŠ è¡Œï¼‰ï¼š DataFrame æ·»åŠ è¡Œç›¸å¯¹æ²¡æœ‰æ·»åŠ åˆ—é‚£ä¹ˆç›´æ¥ã€‚ä»¥å¾€ Pandas æœ‰ df.append() æ–¹æ³•å¯ä»¥ç›´æ¥æ·»åŠ ä¸€è¡Œæ–°çš„æ•°æ®ï¼Œä½†è‡ª Pandas 1.4 èµ·è¯¥æ–¹æ³•å·²è¢«åºŸå¼ƒï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨ pd.concat æ¥å®Œæˆè¿™ä¸€åŠŸèƒ½ã€‚</p>
<p>æ·»åŠ æ–°è¡Œçš„æ€è·¯æ˜¯ï¼šå…ˆæ„é€ ä¸€ä¸ªä¸åŸ DataFrame åˆ—ç»“æ„ç›¸åŒçš„ DataFrame æˆ– Seriesï¼Œç„¶åé€šè¿‡ <code>pd.concat([...], axis=0)</code> å°†å…¶ä¸åŸ DataFrame æŒ‰è¡Œæ‹¼æ¥ã€‚æ³¨æ„ä¿æŒæ–°è¡Œçš„æ•°æ®åœ¨åˆ—ä¸Šçš„å¯¹é½ã€‚ä¸‹é¢æ¼”ç¤ºæ·»åŠ ä¸€è¡Œæ•°æ®ï¼š</p>
<blockquote><code># æ„é€ ä¸€è¡Œæ–°æ•°æ®ï¼Œæ³¨æ„åˆ—åéœ€ä¸åŸ DataFrame ä¸€è‡´</code><br>
<code>new_row = pd.DataFrame([[&#039;ZhangSan&#039;, 21, &#039;M&#039;]], </code><br>
<code>                       columns=[&#039;Name&#039;, &#039;Age&#039;, &#039;Gender&#039;], </code><br>
<code>                       index=[&#039;e&#039;])</code><br>
<code># ç”¨ concat è¿æ¥æ–°è¡Œ</code><br>
<code>df = pd.concat([df, new_row], axis=0)</code><br>
<code>print(df)</code><br>
<code># è¾“å‡º:</code><br>
<code>#    Name   Age Gender</code><br>
<code># a    Tom  18.0      M</code><br>
<code># b  Jerry  18.0    NaN</code><br>
<code># c   Jack  20.0      F</code><br>
<code># d   Rose   NaN      M</code><br>
<code># e ZhangSan 21.0      M</code></blockquote><p>ä¸Šé¢æˆ‘ä»¬æ·»åŠ äº†ä¸€è¡Œç´¢å¼•ä¸º â€˜eâ€™ çš„æ•°æ®ï¼ŒName ä¸º ZhangSanï¼ŒAge ä¸º21ï¼ŒGender ä¸º Mã€‚æ‹¼æ¥åå¯ä»¥çœ‹åˆ° df å¤šäº†ä¸€è¡Œ â€˜eâ€™ã€‚å¦‚æœä¸æŒ‡å®š index=[&#39;e&#39;]ï¼Œnew_row ä¼šé»˜è®¤ç”¨0ä½œä¸ºç´¢å¼•ï¼Œä¸åŸ DataFrame çš„ç´¢å¼•ç±»å‹ä¸ä¸€è‡´ç”šè‡³å†²çªã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ concat ä»ä¼šæˆåŠŸï¼ˆå®ƒä¸ä¼šå› ä¸ºç´¢å¼•é‡å¤è€ŒæŠ¥é”™ï¼‰ï¼Œä½†æ–°è¡Œç´¢å¼•ä¼šæ˜¯0ï¼Œæœ‰å¯èƒ½ä¸åŸæœ‰ç´¢å¼•å†²çªå¯¼è‡´ä¸¤ä¸ªç´¢å¼•ç›¸åŒã€‚è¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€ä»¥æŒ‡å®šä¸€ä¸ªä¸ä¼šé‡å¤çš„æ–°ç´¢å¼•æ¯”è¾ƒå®‰å…¨ã€‚</p>
<p>æ”¹ï¼ˆä¿®æ”¹è¡Œï¼‰ï¼š ä¿®æ”¹è¡Œé€šå¸¸å¯ä»¥é€šè¿‡ loc æˆ– iloc æ¥å®šä½æ•´è¡Œç„¶åèµ‹å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æŠŠåˆšæ‰æ·»åŠ çš„ â€˜eâ€™ è¡Œæ•°æ®çš„ Name å’Œ Age ä¿®æ”¹ä¸€ä¸‹ï¼š</p>
<blockquote><code>df.loc[&#039;e&#039;] = [&#039;Peter&#039;, 22.0, &#039;M&#039;]  # å°†ç´¢å¼• &#039;e&#039; çš„æ•´è¡Œé‡ç½®ä¸ºæ–°çš„å€¼</code><br>
<code>print(df.loc[&#039;e&#039;])</code><br>
<code># è¾“å‡º:</code><br>
<code># Name      Peter</code><br>
<code># Age        22.0</code><br>
<code># Gender        M</code><br>
<code># Name: e, dtype: object</code></blockquote><p>æˆ‘ä»¬æˆåŠŸåœ°æŠŠç´¢å¼• e é‚£è¡Œçš„æ•°æ®æ›´æ–°ä¸º Name = Peter, Age = 22.0, Gender = â€˜Mâ€™ã€‚è¿™é‡Œç›´æ¥å¯¹ df.loc[&#39;e&#39;] èµ‹äºˆä¸€ä¸ªåˆ—è¡¨ï¼Œæ–°å€¼ä¼šæŒ‰ç…§åˆ—çš„é¡ºåºå¡«å…¥å¯¹åº”çš„ä¸‰ä¸ªåˆ—ã€‚å¦‚æœåªæƒ³ä¿®æ”¹æŸä¸ªå•å…ƒæ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>df.at[row_index, col_name] = value</code> æˆ– <code>df.iat[row_position, col_position] = value</code> æ¥å®šä½èµ‹å€¼ã€‚</p>
<p>åˆ ï¼ˆåˆ é™¤è¡Œï¼‰ï¼š åˆ é™¤è¡Œä½¿ç”¨ drop æ–¹æ³•ï¼ŒæŒ‡å®š axis=0ï¼ˆæˆ–è€…ä¸æŒ‡å®šï¼Œé»˜è®¤å°±æ˜¯0ä¹Ÿè¡¨ç¤ºæŒ‰è¡Œåˆ ï¼‰ã€‚å¯ä»¥ä¼ å…¥è¦åˆ é™¤çš„ç´¢å¼•æ ‡ç­¾åˆ—è¡¨ã€‚ä¸åˆ é™¤åˆ—ç±»ä¼¼ï¼Œdrop é»˜è®¤è¿”å›æ–°å¯¹è±¡ï¼Œé™¤éè®¾ç½® inplace=Trueã€‚ç¤ºä¾‹ï¼š</p>
<blockquote><code># åˆ é™¤ç´¢å¼•ä¸º &#039;b&#039; å’Œ &#039;d&#039; çš„ä¸¤è¡Œ</code><br>
<code>df = df.drop([&#039;b&#039;, &#039;d&#039;], axis=0)</code><br>
<code>print(df)</code><br>
<code># è¾“å‡º:</code><br>
<code>#    Name   Age Gender</code><br>
<code># a   Tom  18.0      M</code><br>
<code># c  Jack  20.0      F</code><br>
<code># e Peter  22.0      M</code></blockquote><p>ç´¢å¼• b å’Œ d çš„è¡Œè¢«åˆ é™¤äº†ã€‚å¯ä»¥çœ‹åˆ°ç°åœ¨ DataFrame åªå‰©ä¸‹ a, c, e ä¸‰è¡Œæ•°æ®ã€‚å¦‚æœç´¢å¼•æ˜¯é»˜è®¤çš„æ•´æ•°ä¸”å¸Œæœ›æŒ‰ä½ç½®åˆ é™¤ç¬¬å‡ è¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¼ ç´¢å¼•å€¼ï¼ˆå› ä¸ºé»˜è®¤ç´¢å¼•æ ‡ç­¾å°±æ˜¯æ•°å­—ï¼‰ã€‚ä¾‹å¦‚ df.drop([0], axis=0) ä¼šåˆ é™¤ç´¢å¼•ä¸º0çš„è¡Œã€‚ä½†æ˜¯ä¸€æ—¦ç´¢å¼•ä¸æ˜¯é»˜è®¤æ•´åºï¼Œè¿˜æ˜¯åº”è¯¥ç”¨æ ‡ç­¾ã€‚å¦å¤–ï¼Œå¦‚æœæƒ³æŒ‰æ¡ä»¶åˆ é™¤ï¼ˆæ¯”å¦‚åˆ é™¤ Age å¤§äº20çš„è¡Œï¼‰ï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªå¸ƒå°”å‹ç´¢å¼•æ©ç ç„¶åç”¨ <code>df.drop(df[condition].index, axis=0)</code> å®ç°ï¼Œè¿™é‡Œä¸å±•å¼€ã€‚</p>
<h2>CSV æ–‡ä»¶è¯»å†™å®è·µ</h2>
<p>æ•°æ®é€šå¸¸ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼ŒPandas æ”¯æŒè¯»å–å’Œä¿å­˜å¤šç§æ ¼å¼çš„æ•°æ®æ–‡ä»¶ï¼Œå…¶ä¸­CSVï¼ˆComma-Separated Valuesï¼‰æ˜¯æœ€å¸¸è§çš„æ–‡æœ¬æ ¼å¼ã€‚ä¸‹é¢æˆ‘ä»¬ä»‹ç» Pandas å¦‚ä½•é«˜æ•ˆåœ°è¯»å–CSVï¼Œä»¥åŠä¸€äº›å¸¸ç”¨å‚æ•°å’ŒæŠ€å·§ã€‚åŒæ ·ï¼Œå†™å›CSVä¹Ÿéå¸¸ç®€å•ã€‚</p>
<p>è¯»å– CSVï¼š ä½¿ç”¨ pd.read_csv å‡½æ•°å³å¯è¯»å–CSVæ–‡ä»¶ï¼ŒåŸºæœ¬ç”¨æ³•æ˜¯ä¼ å…¥æ–‡ä»¶è·¯å¾„ï¼ŒPandas ä¼šè‡ªåŠ¨å°†å…¶è§£æä¸º DataFrameã€‚ç¤ºä¾‹ï¼š</p>
<blockquote><code>import pandas as pd</code><br>
<code></code><br>
<code># åŸºæœ¬è¯»å–ï¼ˆå‡è®¾ CSV ç¬¬ä¸€è¡Œä¸ºè¡¨å¤´ï¼‰</code><br>
<code>df = pd.read_csv(&#039;data.csv&#039;)</code><br>
<code>print(df.head(5))  # æŸ¥çœ‹å‰5è¡Œ</code></blockquote><p>å¦‚æœCSVæ–‡ä»¶åŒ…å«è¡¨å¤´ï¼ˆç¬¬ä¸€è¡Œæ˜¯åˆ—åï¼‰ï¼Œpd.read_csv ä¼šè‡ªåŠ¨å°†å…¶ä½œä¸ºåˆ—åã€‚å¦‚æœCSVæ²¡æœ‰è¡¨å¤´è¡Œï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰å‡½æ•°ä¸è¦å°†ç¬¬ä¸€è¡Œå½“ä½œåˆ—åï¼Œå¯ä»¥ä½¿ç”¨ header=Noneï¼ŒåŒæ—¶é€šè¿‡ names= æŒ‡å®šåˆ—ååˆ—è¡¨ã€‚ä¾‹å¦‚ï¼š</p>
<blockquote><code># å¦‚æœ CSV æ²¡æœ‰è¡¨å¤´è¡Œï¼ŒæŒ‡å®š header=None å¹¶æä¾›åˆ—å</code><br>
<code>df = pd.read_csv(&#039;data_no_header.csv&#039;, header=None, names=[&#039;col1&#039;, &#039;col2&#039;, &#039;col3&#039;])</code></blockquote><p>read_csv è¿˜æœ‰è®¸å¤šæœ‰ç”¨çš„å‚æ•°ï¼Œå¸¸ç”¨çš„åŒ…æ‹¬ï¼š</p>
<ul>
<li>sepï¼šæŒ‡å®šåˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯é€—å·,ã€‚å¦‚æœæ˜¯åˆ¶è¡¨ç¬¦åˆ†éš”çš„æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ sep=&#39;\t&#39;ã€‚</li>
<li>headerï¼šç”¨æ¥æŒ‡å®šå“ªä¸€è¡Œä½œä¸ºåˆ—åã€‚å¦‚æœç¬¬ä¸€è¡Œæ˜¯æ•°æ®è€Œéåˆ—åï¼Œç”¨ header=Noneã€‚</li>
<li>namesï¼šå½“æ²¡æœ‰è¡¨å¤´æˆ–è€…æƒ³è‡ªè¡ŒæŒ‡å®šåˆ—åæ—¶ï¼Œç”¨è¿™ä¸ªå‚æ•°ä¼ å…¥åˆ—è¡¨ä½œä¸ºåˆ—åã€‚</li>
<li>index_colï¼šæŒ‡å®šå°†æŸä¸€åˆ—è¯»å…¥æ—¶è®¾ç½®ä¸ºè¡Œç´¢å¼•ã€‚ä¾‹å¦‚ index_col=&#39;Date&#39; ä¼šå°†â€Dateâ€é‚£åˆ—ä½œä¸ºç´¢å¼•è€Œä¸æ˜¯æ™®é€šæ•°æ®åˆ—ã€‚</li>
<li>usecolsï¼šå¯ä»¥ä¼ å…¥ä¸€ä¸ªåˆ—ååˆ—è¡¨ï¼Œè¡¨ç¤ºåªè¯»å–è¿™äº›åˆ—ï¼Œå¿½ç•¥å…¶ä»–åˆ—ã€‚å¯¹äºå¾ˆå¤§çš„æ–‡ä»¶ï¼Œè¯»å–å¿…è¦çš„åˆ—å¯ä»¥æ˜æ˜¾åŠ å¿«é€Ÿåº¦ã€èŠ‚çœå†…å­˜ã€‚</li>
<li>dtypeï¼šå¯ä»¥æŒ‡å®šåˆ—çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å°†æŸåˆ—å¼ºåˆ¶è¯»æˆå­—ç¬¦ä¸² dtype={&#39;col&#39;: str}ã€‚æ­£ç¡®æŒ‡å®šç±»å‹ä¹Ÿæœ‰åŠ©äºåŠ å¿«è¯»å–å’Œå‡å°‘å†…å­˜å ç”¨ã€‚</li>
<li>nrowsï¼šåªè¯»å–å‰ n è¡Œï¼Œç”¨äºé¢„è§ˆå¤§å‹æ–‡ä»¶æˆ–æµ‹è¯•ã€‚</li>
<li>encodingï¼šæŒ‡å®šæ–‡ä»¶ç¼–ç ï¼Œæ¯”å¦‚ä¸­æ–‡å¸¸ç”¨ encoding=&#39;utf-8&#39;ï¼ˆé»˜è®¤ï¼‰ã€&#39;gbk&#39; ç­‰ã€‚</li>
<li>engineï¼šè§£æå¼•æ“ï¼Œä¸€èˆ¬ä¸ç”¨ç‰¹åˆ«æŒ‡å®šã€‚åªæœ‰åœ¨åˆ†éš”ç¬¦æ¯”è¾ƒç‰¹æ®Šï¼ˆä¾‹å¦‚å¤šå­—ç¬¦ï¼‰æ—¶ï¼Œä¼šç”¨åˆ° engine=&#39;python&#39;ã€‚</li>
</ul>
<p>æˆ‘ä»¬å°†ä¸Šè¿°ä¸€äº›å‚æ•°ç»¼åˆåœ¨ä¸€ä¸ªä¾‹å­é‡Œï¼šå‡è®¾æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«è‚¡ç¥¨æ•°æ®ï¼Œæ²¡æœ‰åˆ—åï¼Œæˆ‘ä»¬æƒ³è¯»å–å…¶ä¸­çš„æ—¥æœŸ(date)ä½œä¸ºç´¢å¼•ï¼Œä»¥åŠå¼€ç›˜ä»·(open)ã€æœ€é«˜ä»·(high)ã€æœ€ä½ä»·(low)ã€æ”¶ç›˜ä»·(close)è¿™å‡ åˆ—ã€‚æ–‡ä»¶ç”¨é€—å·åˆ†éš”ã€‚è¯»å–ä»£ç å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<blockquote><code>df = pd.read_csv(&#039;aapl.csv&#039;,</code><br>
<code>                 sep=&#039;,&#039;,         # åˆ†éš”ç¬¦ä¸ºé€—å·</code><br>
<code>                 header=None,     # æ–‡ä»¶ä¸­æ— è¡¨å¤´è¡Œ</code><br>
<code>                 names=[&#039;name&#039;, &#039;date&#039;, &#039;_&#039;, &#039;open&#039;, &#039;high&#039;, &#039;low&#039;, &#039;close&#039;, &#039;volume&#039;],  # åˆ—ååˆ—è¡¨</code><br>
<code>                 index_col=&#039;date&#039;,# å°†&quot;date&quot;åˆ—ä½œä¸ºè¡Œç´¢å¼•</code><br>
<code>                 usecols=[&#039;date&#039;, &#039;open&#039;, &#039;high&#039;, &#039;low&#039;, &#039;close&#039;]  # åªè¯»å–éœ€è¦çš„äº”åˆ—</code><br>
<code>)</code><br>
<code>print(df.head(3))</code><br>
<code># è¾“å‡ºç¤ºä¾‹:</code><br>
<code>#             open    high     low   close</code><br>
<code># date</code><br>
<code># 2011-01-28  344.17  344.40  333.53  336.10</code><br>
<code># 2011-01-31  335.80  340.04  334.30  339.32</code><br>
<code># 2011-02-01  341.30  345.65  340.98  345.03</code></blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ names æä¾›äº†8ä¸ªåˆ—åï¼ˆæ–‡ä»¶æ¯è¡Œæœ‰8ä¸ªå­—æ®µï¼Œå…¶ä¸­ç¬¬ä¸‰ä¸ªå­—æ®µæˆ‘ä»¬å‘½åä¸º_è¡¨ç¤ºæˆ‘ä»¬ä¸å…³å¿ƒï¼‰ï¼Œç„¶åç”¨ usecols é€‰æ‹©äº†æˆ‘ä»¬æƒ³è¦çš„5åˆ—æ•°æ®ï¼ˆdate å’Œ OHLC å››åˆ—ï¼‰ï¼Œå¹¶å°† date åˆ—è®¾ä¸ºç´¢å¼•ã€‚head(3) æ‰“å°è¾“å‡ºéªŒè¯äº†è¯»å–æ•ˆæœã€‚ä½¿ç”¨ usecols æœ‰æ•ˆé¿å…äº†è¯»å–ä¸éœ€è¦çš„æ•°æ®ï¼Œæé«˜äº†é€Ÿåº¦ã€‚</p>
<blockquote>
<p><strong>å¸¸è§é—®é¢˜</strong>ï¼š <em>â€œå¦‚æœ CSV æœ‰äº”ä¸‡è¡Œï¼Œé‚£ä¹ˆç”¨ Pandas è¯»ä¼šä¸ä¼šå¾ˆæ…¢ã€å¾ˆå¡ï¼Ÿâ€</em></p>
<p><strong>ç­”æ¡ˆæ˜¯ï¼šä¸ä¼š</strong>ã€‚ äº”ä¸‡è¡Œå¯¹ Pandas è€Œè¨€ä¸ç®—å¾ˆå¤šï¼Œä¸€èˆ¬å‡ ç™¾æ¯«ç§’å°±èƒ½è¯»å®Œã€‚ä¸è¿‡å¦‚æœæ•°æ®è¾¾åˆ°ä¸Šç™¾ä¸‡è¡Œä¹ƒè‡³æ›´å¤§ï¼Œå†…å­˜å’Œè€—æ—¶å°±éœ€è¦è€ƒè™‘ã€‚è¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨åˆ†å—è¯»å–ï¼špd.read_csv(..., chunksize=10000) ä¼šè¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„ TextFileReaderï¼Œæ¯æ¬¡è¯»å–10000è¡Œï¼Œæˆ‘ä»¬å¯ä»¥éå†æ¯ä¸ªchunké€æ­¥å¤„ç†ã€‚è¿™æ ·å¯ä»¥é¿å…ä¸€æ¬¡æ€§å ç”¨å¤ªå¤šå†…å­˜ã€‚å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨ dtype ç²¾ç¡®æŒ‡å®šç±»å‹ï¼Œé¿å…PandasçŒœæµ‹ç±»å‹çš„å¼€é”€å’Œæ½œåœ¨çš„ä¸å¿…è¦çš„é«˜ç²¾åº¦ç±»å‹ã€‚æ€»çš„æ¥è¯´ï¼Œå¯¹äºè¶…å¤§æ–‡ä»¶ï¼Œåˆ†å—è¯»å–å¹¶é€æ­¥å¤„ç†æ˜¯å¸¸ç”¨ç­–ç•¥ã€‚</p>
</blockquote>
<p>å†™å‡º CSVï¼š å°† DataFrame ä¿å­˜ä¸º CSV ä½¿ç”¨ DataFrame.to_csv æ–¹æ³•å³å¯ã€‚ä¾‹å¦‚ï¼š</p>
<p><code>df.to_csv(&#039;output.csv&#039;, index=False)</code></p><p>ä¸Šé¢ä»£ç å°† DataFrame å†™å…¥å½“å‰ç›®å½•ä¸‹çš„ output.csv æ–‡ä»¶ï¼Œå¹¶è®¾ç½® index=False è¡¨ç¤ºä¸ä¿å­˜è¡Œç´¢å¼•ï¼ˆå› ä¸ºæœ‰äº›æƒ…å†µä¸‹è¡Œç´¢å¼•æ²¡æ„ä¹‰æˆ–è€…ä¸è¦å¯¼å‡ºï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ to_csv ä¼šä¿å­˜è¡Œç´¢å¼•å’Œåˆ—æ ‡ç­¾ï¼Œå¦‚æœä¸æƒ³è¦å¯ä»¥åˆ†åˆ«ç”¨ index=False å’Œ header=False å…³é—­ã€‚to_csv ä¹Ÿæ”¯æŒ sep, encoding ç­‰å‚æ•°ï¼Œè‡ªè¡Œæ ¹æ®éœ€è¦è®¾ç½®å³å¯ã€‚</p>
<p>é™¤äº† CSV ä¹‹å¤–ï¼ŒPandas ä¹Ÿæ”¯æŒè¯»å–/å†™å…¥å¤šç§å¸¸è§æ ¼å¼ï¼š</p>
<ul>
<li>Excelï¼šä½¿ç”¨ pd.read_excel(&#39;file.xlsx&#39;) è¯»å–ï¼ŒDataFrame.to_excel(&#39;out.xlsx&#39;) å†™å…¥ã€‚æ³¨æ„è¯»å– Excel éœ€è¦å®‰è£…ç›¸åº”çš„å¼•æ“åº“ï¼Œå¦‚ openpyxlã€‚ä¸€èˆ¬ .xlsx æ–‡ä»¶éƒ½ä¼šç”¨ openpyxl å¼•æ“ã€‚</li>
<li>JSONï¼šä½¿ç”¨ pd.read_json(&#39;file.json&#39;) è¯»å–ï¼ŒDataFrame.to_json(&#39;out.json&#39;) å†™å‡ºã€‚read_json å¯ä»¥é€šè¿‡å‚æ•° orient æ¥æŒ‡å®š JSON çš„ç»„ç»‡æ ¼å¼ï¼ˆæ¯”å¦‚è®°å½•ä¸ºè¡Œè¿˜æ˜¯åˆ—ï¼‰ã€‚</li>
<li>SQLï¼šä½¿ç”¨ pd.read_sql(query, connection) å¯ä»¥ä»æ•°æ®åº“è¯»å–æŸ¥è¯¢ç»“æœä¸º DataFrameï¼Œto_sql å¯ä»¥å†™å…¥æ•°æ®åº“è¡¨ã€‚ï¼ˆè¿™éœ€è¦SQLAlchemyç­‰æ”¯æŒï¼Œè¿™é‡Œç•¥è¿‡ï¼‰</li>
<li>ä»¥åŠå…¶å®ƒæ ¼å¼ä¾‹å¦‚ Parquet (read_parquet)ã€HTMLè¡¨(read_html)ã€Stata (read_stata) ç­‰ç­‰ã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼ŒPandas æä¾›äº†ä¸€å¥—ç»Ÿä¸€çš„é«˜å±‚æ¥å£æ¥è¯»å–å’Œå­˜å‚¨æ•°æ®ï¼Œè®©æ•°æ®åœ¨ä¸åŒåª’ä»‹ä¹‹é—´è½¬ç§»å˜å¾—éå¸¸æ–¹ä¾¿ã€‚ä½ å¯ä»¥å°†å…¶è§†ä¸ºæ•°æ®è½¬æ¢çš„ç‘å£«å†›åˆ€ï¼šCSVã€Excelã€JSON è½¬DataFrameï¼ŒDataFrameå†è½¬å›å„ç§æ ¼å¼ï¼Œéƒ½ä¸æ˜¯é—®é¢˜ã€‚</p>
<h2>æ€»ç»“</h2>
<p>Pandas çš„ä¸¤ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„ï¼šSeriesï¼ˆä¸€ç»´å¸¦ç´¢å¼•æ•°ç»„ï¼‰å’Œ DataFrameï¼ˆäºŒç»´è¡¨æ ¼ï¼‰ã€‚åœ¨å®é™…å·¥ç¨‹ä¸­ï¼ŒPandas å¯ä»¥å¤§å¹…æé«˜æˆ‘ä»¬å¤„ç†è¡¨æ ¼æ•°æ®çš„æ•ˆç‡ã€‚é‡åˆ°â€œè¡¨æ ¼é‡Œçš„åˆ—åæœ‰ç©ºæ ¼â€è¿™æ ·çš„ç»†èŠ‚é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥é€šè¿‡æ›´æ¢è®¿é—®æ–¹å¼æˆ–é‡å‘½åæ¥è§£å†³ï¼›é¢å¯¹â€œæ€æ ·è¯»å¤§æ–‡ä»¶ä¸å¡â€è¿™æ ·çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿäº†è§£äº†åˆ†å—è¯»å–ç­‰æ–¹æ¡ˆã€‚ç†Ÿæ‚‰è¿™äº›æŠ€å·§èƒ½è®©æˆ‘ä»¬æ›´åŠ æ¸¸åˆƒæœ‰ä½™åœ°ä½¿ç”¨ Pandas å¤„ç†æ•°æ®ã€‚</p>

    </article>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js"></script>
<script>
Prism.highlightAll();
document.querySelectorAll('article pre').forEach(pre => {
    const code = pre.querySelector('code');
    if (!code) return;
    const toolbar = document.createElement('div');
    toolbar.className = 'code-toolbar';
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.onclick = () => {
        navigator.clipboard.writeText(code.textContent).then(() => {
            btn.textContent = 'Copied!';
            btn.classList.add('copied');
            setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
        });
    };
    toolbar.appendChild(btn);
    pre.parentNode.insertBefore(toolbar, pre);
});
</script>
</body>
</html>